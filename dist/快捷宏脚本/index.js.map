{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/external var \"Vue\"","src://tavern_helper_template/src/快捷宏脚本/ui/context.ts","src://tavern_helper_template/src/快捷宏脚本/ui/App.vue","webpack://tavern_helper_template/src/快捷宏脚本/ui/App.vue?5e15","src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/快捷宏脚本/entry/portal.ts","src://tavern_helper_template/util/script.ts","src://tavern_helper_template/src/快捷宏脚本/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","import type { ComputedRef, Ref } from 'vue';\n\nexport type Macro = {\n  id: string;\n  name: string;\n  content: string;\n  send: boolean;\n  append: boolean;\n  newline: boolean;\n  scope: 'global' | 'character';\n  characterId: string;\n};\n\nexport type Theme = {\n  bg: string;\n  surface: string;\n  surfaceAlt: string;\n  text: string;\n  textMuted: string;\n  accent: string;\n  border: string;\n};\n\nexport type MacroUiContext = {\n  visible: Ref<boolean>;\n  macros: Ref<Macro[]>;\n  theme: Ref<Theme>;\n  selectedId: Ref<string | null>;\n  selectedMacro: ComputedRef<Macro | null>;\n  selectMacro: (id: string) => void;\n  currentCharacterLabel: ComputedRef<string>;\n  bindCurrentCharacter: () => void;\n  close: () => void;\n  addMacro: () => void;\n  duplicateMacro: () => void;\n  removeMacro: () => void;\n  moveMacro: (delta: number) => void;\n  resetTheme: () => void;\n  save: () => void;\n};\n\nexport const MacroUiKey = Symbol('MacroUi');\n","import { defineComponent as _defineComponent } from 'vue';\nimport { unref as _unref, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, withModifiers as _withModifiers, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, vModelText as _vModelText, withDirectives as _withDirectives, vModelSelect as _vModelSelect, vModelCheckbox as _vModelCheckbox, createTextVNode as _createTextVNode, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = {\n    class: \"macro-panel\",\n    role: \"dialog\",\n    \"aria-label\": \"快捷语句管理\"\n};\nconst _hoisted_2 = { class: \"macro-header\" };\nconst _hoisted_3 = { class: \"macro-header-actions\" };\nconst _hoisted_4 = { class: \"macro-body\" };\nconst _hoisted_5 = { class: \"macro-sidebar\" };\nconst _hoisted_6 = { class: \"macro-list\" };\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = { class: \"macro-item__row\" };\nconst _hoisted_9 = { class: \"macro-item__name\" };\nconst _hoisted_10 = { class: \"macro-item__actions\" };\nconst _hoisted_11 = [\"onClick\"];\nconst _hoisted_12 = [\"onClick\"];\nconst _hoisted_13 = { class: \"macro-item__meta\" };\nconst _hoisted_14 = { key: 0 };\nconst _hoisted_15 = { key: 1 };\nconst _hoisted_16 = { key: 2 };\nconst _hoisted_17 = { key: 3 };\nconst _hoisted_18 = { class: \"macro-actions\" };\nconst _hoisted_19 = { class: \"macro-content\" };\nconst _hoisted_20 = { class: \"macro-field\" };\nconst _hoisted_21 = {\n    key: 1,\n    class: \"macro-empty\"\n};\nconst _hoisted_22 = {\n    key: 0,\n    class: \"macro-field\"\n};\nconst _hoisted_23 = {\n    key: 1,\n    class: \"macro-field\"\n};\nconst _hoisted_24 = { class: \"macro-scope-row\" };\nconst _hoisted_25 = {\n    key: 1,\n    class: \"macro-scope-hint\"\n};\nconst _hoisted_26 = {\n    key: 2,\n    class: \"macro-toggle-row\"\n};\nconst _hoisted_27 = { class: \"macro-toggle\" };\nconst _hoisted_28 = { class: \"macro-toggle\" };\nconst _hoisted_29 = { class: \"macro-toggle\" };\nconst _hoisted_30 = [\"disabled\"];\nconst _hoisted_31 = [\"disabled\"];\nconst _hoisted_32 = { class: \"macro-footer\" };\nconst _hoisted_33 = {\n    class: \"macro-theme-panel\",\n    role: \"dialog\",\n    \"aria-label\": \"主题配色设置\"\n};\nconst _hoisted_34 = { class: \"macro-theme-header\" };\nconst _hoisted_35 = { class: \"macro-theme-body\" };\nconst _hoisted_36 = { class: \"macro-theme-presets\" };\nconst _hoisted_37 = [\"onClick\"];\nconst _hoisted_38 = { class: \"macro-theme-grid\" };\nconst _hoisted_39 = { class: \"macro-theme-item\" };\nconst _hoisted_40 = { class: \"macro-theme-item\" };\nconst _hoisted_41 = { class: \"macro-theme-item\" };\nconst _hoisted_42 = { class: \"macro-theme-item\" };\nconst _hoisted_43 = { class: \"macro-theme-item\" };\nconst _hoisted_44 = { class: \"macro-theme-item\" };\nconst _hoisted_45 = { class: \"macro-theme-item\" };\nconst _hoisted_46 = { class: \"macro-theme-footer\" };\nimport { inject, ref } from 'vue';\nimport { MacroUiKey } from './context';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'App',\n    setup(__props) {\n        const ctx = inject(MacroUiKey);\n        if (!ctx) {\n            throw new Error('Macro UI context missing.');\n        }\n        const { visible, macros, theme, selectedId, selectedMacro, selectMacro, currentCharacterLabel, bindCurrentCharacter, close, addMacro, duplicateMacro, removeMacro, moveMacro, resetTheme, save, } = ctx;\n        const themeOpen = ref(false);\n        const themePresets = [\n            {\n                name: '白天',\n                colors: {\n                    bg: '#f6f1ea',\n                    surface: '#ffffff',\n                    surfaceAlt: '#f1ebe4',\n                    text: '#1c1c1c',\n                    textMuted: '#6a5f54',\n                    accent: '#d9934f',\n                    border: '#e3d6c9',\n                },\n            },\n            {\n                name: '夜晚',\n                colors: {\n                    bg: '#0f1115',\n                    surface: '#1b1f27',\n                    surfaceAlt: '#232836',\n                    text: '#f5f5f7',\n                    textMuted: '#a7b0c0',\n                    accent: '#4cc3ff',\n                    border: '#2f3647',\n                },\n            },\n            {\n                name: '雾蓝',\n                colors: {\n                    bg: '#e8eef6',\n                    surface: '#f7f9fc',\n                    surfaceAlt: '#e3ecf7',\n                    text: '#1b2533',\n                    textMuted: '#5b6b7f',\n                    accent: '#5e8cff',\n                    border: '#c8d6ea',\n                },\n            },\n            {\n                name: '琥珀',\n                colors: {\n                    bg: '#f7efe4',\n                    surface: '#fff7ee',\n                    surfaceAlt: '#f4e3d0',\n                    text: '#2a1f17',\n                    textMuted: '#6f5a4a',\n                    accent: '#c9783b',\n                    border: '#e3c9b2',\n                },\n            },\n        ];\n        const applyPreset = (colors) => {\n            theme.value = { ...colors };\n        };\n        const duplicateItem = (id) => {\n            selectMacro(id);\n            duplicateMacro();\n        };\n        const removeItem = (id) => {\n            selectMacro(id);\n            removeMacro();\n        };\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(\"div\", {\n                class: _normalizeClass([\"macro-root\", { open: _unref(visible) }])\n            }, [\n                _createElementVNode(\"div\", {\n                    class: \"macro-backdrop\",\n                    onClick: _cache[0] || (_cache[0] =\n                        //@ts-ignore\n                        (...args) => (_unref(close) && _unref(close)(...args)))\n                }),\n                _createElementVNode(\"section\", _hoisted_1, [\n                    _createElementVNode(\"header\", _hoisted_2, [\n                        _cache[27] || (_cache[27] = _createElementVNode(\"div\", { class: \"macro-title\" }, [\n                            _createElementVNode(\"div\", { class: \"macro-title__main\" }, \"快捷语句管理\"),\n                            _createElementVNode(\"div\", { class: \"macro-title__sub\" }, \"更新后会同步脚本按钮，支持发送/追加/换行控制。\")\n                        ], -1 /* CACHED */)),\n                        _createElementVNode(\"div\", _hoisted_3, [\n                            _createElementVNode(\"button\", {\n                                class: \"macro-icon-btn\",\n                                type: \"button\",\n                                \"aria-label\": \"配色\",\n                                onClick: _cache[1] || (_cache[1] = ($event) => (themeOpen.value = true))\n                            }, [...(_cache[26] || (_cache[26] = [\n                                    _createElementVNode(\"i\", {\n                                        class: \"fa-solid fa-palette\",\n                                        \"aria-hidden\": \"true\"\n                                    }, null, -1 /* CACHED */)\n                                ]))]),\n                            _createElementVNode(\"button\", {\n                                class: \"macro-close\",\n                                type: \"button\",\n                                onClick: _cache[2] || (_cache[2] =\n                                    //@ts-ignore\n                                    (...args) => (_unref(close) && _unref(close)(...args)))\n                            }, \"关闭\")\n                        ])\n                    ]),\n                    _createElementVNode(\"div\", _hoisted_4, [\n                        _createElementVNode(\"aside\", _hoisted_5, [\n                            _cache[30] || (_cache[30] = _createElementVNode(\"div\", { class: \"macro-section-title\" }, \"快捷语句列表\", -1 /* CACHED */)),\n                            _createElementVNode(\"div\", _hoisted_6, [\n                                (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(macros), (macro) => {\n                                    return (_openBlock(), _createElementBlock(\"button\", {\n                                        key: macro.id,\n                                        class: _normalizeClass([\"macro-item\", { active: macro.id === _unref(selectedId) }]),\n                                        type: \"button\",\n                                        onClick: ($event) => (_unref(selectMacro)(macro.id))\n                                    }, [\n                                        _createElementVNode(\"div\", _hoisted_8, [\n                                            _createElementVNode(\"div\", _hoisted_9, _toDisplayString(macro.name || '未命名'), 1 /* TEXT */),\n                                            _createElementVNode(\"div\", _hoisted_10, [\n                                                _createElementVNode(\"button\", {\n                                                    class: \"macro-icon-btn\",\n                                                    type: \"button\",\n                                                    \"aria-label\": \"复制\",\n                                                    onClick: _withModifiers(($event) => (duplicateItem(macro.id)), [\"stop\"])\n                                                }, [...(_cache[28] || (_cache[28] = [\n                                                        _createElementVNode(\"i\", {\n                                                            class: \"fa-solid fa-copy\",\n                                                            \"aria-hidden\": \"true\"\n                                                        }, null, -1 /* CACHED */)\n                                                    ]))], 8 /* PROPS */, _hoisted_11),\n                                                _createElementVNode(\"button\", {\n                                                    class: \"macro-icon-btn\",\n                                                    type: \"button\",\n                                                    \"aria-label\": \"删除\",\n                                                    onClick: _withModifiers(($event) => (removeItem(macro.id)), [\"stop\"])\n                                                }, [...(_cache[29] || (_cache[29] = [\n                                                        _createElementVNode(\"i\", {\n                                                            class: \"fa-solid fa-trash\",\n                                                            \"aria-hidden\": \"true\"\n                                                        }, null, -1 /* CACHED */)\n                                                    ]))], 8 /* PROPS */, _hoisted_12)\n                                            ])\n                                        ]),\n                                        _createElementVNode(\"div\", _hoisted_13, [\n                                            _createElementVNode(\"span\", null, _toDisplayString(macro.scope === 'global' ? '全局' : '角色'), 1 /* TEXT */),\n                                            (macro.send)\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_14, \"发送\"))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (macro.append)\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_15, \" · 追加\"))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (!macro.newline)\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_16, \" · 无换行\"))\n                                                : _createCommentVNode(\"v-if\", true),\n                                            (!macro.send && !macro.append && macro.newline)\n                                                ? (_openBlock(), _createElementBlock(\"span\", _hoisted_17, \"默认\"))\n                                                : _createCommentVNode(\"v-if\", true)\n                                        ])\n                                    ], 10 /* CLASS, PROPS */, _hoisted_7));\n                                }), 128 /* KEYED_FRAGMENT */))\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_18, [\n                                _createElementVNode(\"button\", {\n                                    class: \"macro-btn\",\n                                    type: \"button\",\n                                    onClick: _cache[3] || (_cache[3] =\n                                        //@ts-ignore\n                                        (...args) => (_unref(addMacro) && _unref(addMacro)(...args)))\n                                }, \"新增\")\n                            ])\n                        ]),\n                        _createElementVNode(\"main\", _hoisted_19, [\n                            _createElementVNode(\"div\", _hoisted_20, [\n                                _cache[31] || (_cache[31] = _createElementVNode(\"div\", { class: \"macro-section-title\" }, \"编辑快捷语句\", -1 /* CACHED */)),\n                                _cache[32] || (_cache[32] = _createElementVNode(\"label\", null, \"名称\", -1 /* CACHED */)),\n                                (_unref(selectedMacro))\n                                    ? _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n                                        key: 0,\n                                        class: \"macro-input\",\n                                        \"data-focus\": \"name\",\n                                        \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event) => ((_unref(selectedMacro).name) = $event)),\n                                        placeholder: \"例如：继续\"\n                                    }, null, 512 /* NEED_PATCH */)), [\n                                        [_vModelText, _unref(selectedMacro).name]\n                                    ])\n                                    : (_openBlock(), _createElementBlock(\"div\", _hoisted_21, \"请选择左侧语句\"))\n                            ]),\n                            (_unref(selectedMacro))\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_22, [\n                                    _cache[33] || (_cache[33] = _createElementVNode(\"label\", null, \"内容\", -1 /* CACHED */)),\n                                    _withDirectives(_createElementVNode(\"textarea\", {\n                                        class: \"macro-textarea\",\n                                        \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event) => ((_unref(selectedMacro).content) = $event)),\n                                        placeholder: \"输入要插入的文本\"\n                                    }, null, 512 /* NEED_PATCH */), [\n                                        [_vModelText, _unref(selectedMacro).content]\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (_unref(selectedMacro))\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_23, [\n                                    _cache[35] || (_cache[35] = _createElementVNode(\"label\", null, \"作用范围\", -1 /* CACHED */)),\n                                    _createElementVNode(\"div\", _hoisted_24, [\n                                        _withDirectives(_createElementVNode(\"select\", {\n                                            \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event) => ((_unref(selectedMacro).scope) = $event)),\n                                            class: \"macro-select\"\n                                        }, [...(_cache[34] || (_cache[34] = [\n                                                _createElementVNode(\"option\", { value: \"global\" }, \"全局快捷回复\", -1 /* CACHED */),\n                                                _createElementVNode(\"option\", { value: \"character\" }, \"角色快捷回复\", -1 /* CACHED */)\n                                            ]))], 512 /* NEED_PATCH */), [\n                                            [_vModelSelect, _unref(selectedMacro).scope]\n                                        ]),\n                                        (_unref(selectedMacro).scope === 'character')\n                                            ? (_openBlock(), _createElementBlock(\"button\", {\n                                                key: 0,\n                                                class: \"macro-btn is-ghost\",\n                                                type: \"button\",\n                                                onClick: _cache[7] || (_cache[7] =\n                                                    //@ts-ignore\n                                                    (...args) => (_unref(bindCurrentCharacter) && _unref(bindCurrentCharacter)(...args)))\n                                            }, \" 绑定当前角色 \"))\n                                            : _createCommentVNode(\"v-if\", true),\n                                        (_unref(selectedMacro).scope === 'character')\n                                            ? (_openBlock(), _createElementBlock(\"span\", _hoisted_25, _toDisplayString(_unref(currentCharacterLabel)), 1 /* TEXT */))\n                                            : _createCommentVNode(\"v-if\", true)\n                                    ])\n                                ]))\n                                : _createCommentVNode(\"v-if\", true),\n                            (_unref(selectedMacro))\n                                ? (_openBlock(), _createElementBlock(\"div\", _hoisted_26, [\n                                    _createElementVNode(\"label\", _hoisted_27, [\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"checkbox\",\n                                            \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event) => ((_unref(selectedMacro).send) = $event))\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelCheckbox, _unref(selectedMacro).send]\n                                        ]),\n                                        _cache[36] || (_cache[36] = _createTextVNode(\" 自动发送\", -1 /* CACHED */))\n                                    ]),\n                                    _createElementVNode(\"label\", _hoisted_28, [\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"checkbox\",\n                                            \"onUpdate:modelValue\": _cache[9] || (_cache[9] = ($event) => ((_unref(selectedMacro).append) = $event))\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelCheckbox, _unref(selectedMacro).append]\n                                        ]),\n                                        _cache[37] || (_cache[37] = _createTextVNode(\" 追加到输入框\", -1 /* CACHED */))\n                                    ]),\n                                    _createElementVNode(\"label\", _hoisted_29, [\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"checkbox\",\n                                            \"onUpdate:modelValue\": _cache[10] || (_cache[10] = ($event) => ((_unref(selectedMacro).newline) = $event))\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelCheckbox, _unref(selectedMacro).newline]\n                                        ]),\n                                        _cache[38] || (_cache[38] = _createTextVNode(\" 自动换行\", -1 /* CACHED */))\n                                    ]),\n                                    _createElementVNode(\"button\", {\n                                        class: \"macro-btn is-ghost\",\n                                        type: \"button\",\n                                        disabled: !_unref(selectedMacro),\n                                        onClick: _cache[11] || (_cache[11] = ($event) => (_unref(moveMacro)(-1)))\n                                    }, \" 上移 \", 8 /* PROPS */, _hoisted_30),\n                                    _createElementVNode(\"button\", {\n                                        class: \"macro-btn is-ghost\",\n                                        type: \"button\",\n                                        disabled: !_unref(selectedMacro),\n                                        onClick: _cache[12] || (_cache[12] = ($event) => (_unref(moveMacro)(1)))\n                                    }, \" 下移 \", 8 /* PROPS */, _hoisted_31)\n                                ]))\n                                : _createCommentVNode(\"v-if\", true)\n                        ])\n                    ]),\n                    _createElementVNode(\"footer\", _hoisted_32, [\n                        _createElementVNode(\"button\", {\n                            class: \"macro-btn is-ghost\",\n                            type: \"button\",\n                            onClick: _cache[13] || (_cache[13] =\n                                //@ts-ignore\n                                (...args) => (_unref(close) && _unref(close)(...args)))\n                        }, \"取消\"),\n                        _createElementVNode(\"button\", {\n                            class: \"macro-btn is-primary\",\n                            type: \"button\",\n                            onClick: _cache[14] || (_cache[14] =\n                                //@ts-ignore\n                                (...args) => (_unref(save) && _unref(save)(...args)))\n                        }, \"保存\")\n                    ])\n                ]),\n                (themeOpen.value)\n                    ? (_openBlock(), _createElementBlock(\"div\", {\n                        key: 0,\n                        class: \"macro-theme-modal\",\n                        onClick: _cache[25] || (_cache[25] = _withModifiers(($event) => (themeOpen.value = false), [\"self\"]))\n                    }, [\n                        _createElementVNode(\"section\", _hoisted_33, [\n                            _createElementVNode(\"header\", _hoisted_34, [\n                                _cache[39] || (_cache[39] = _createElementVNode(\"div\", null, [\n                                    _createElementVNode(\"div\", { class: \"macro-theme-title\" }, \"主题配色\"),\n                                    _createElementVNode(\"div\", { class: \"macro-theme-sub\" }, \"选择预设或手动微调颜色\")\n                                ], -1 /* CACHED */)),\n                                _createElementVNode(\"button\", {\n                                    class: \"macro-close\",\n                                    type: \"button\",\n                                    onClick: _cache[15] || (_cache[15] = ($event) => (themeOpen.value = false))\n                                }, \"关闭\")\n                            ]),\n                            _createElementVNode(\"div\", _hoisted_35, [\n                                _createElementVNode(\"div\", _hoisted_36, [\n                                    (_openBlock(), _createElementBlock(_Fragment, null, _renderList(themePresets, (preset) => {\n                                        return _createElementVNode(\"button\", {\n                                            key: preset.name,\n                                            class: \"macro-theme-preset\",\n                                            type: \"button\",\n                                            onClick: ($event) => (applyPreset(preset.colors))\n                                        }, [\n                                            _createElementVNode(\"span\", {\n                                                class: \"macro-theme-dot\",\n                                                style: _normalizeStyle({ background: preset.colors.accent })\n                                            }, null, 4 /* STYLE */),\n                                            _createTextVNode(\" \" + _toDisplayString(preset.name), 1 /* TEXT */)\n                                        ], 8 /* PROPS */, _hoisted_37);\n                                    }), 64 /* STABLE_FRAGMENT */))\n                                ]),\n                                _createElementVNode(\"div\", _hoisted_38, [\n                                    _createElementVNode(\"div\", _hoisted_39, [\n                                        _cache[40] || (_cache[40] = _createElementVNode(\"span\", null, \"背景\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"color\",\n                                            \"onUpdate:modelValue\": _cache[16] || (_cache[16] = ($event) => ((_unref(theme).bg) = $event))\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, _unref(theme).bg]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_40, [\n                                        _cache[41] || (_cache[41] = _createElementVNode(\"span\", null, \"面板\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"color\",\n                                            \"onUpdate:modelValue\": _cache[17] || (_cache[17] = ($event) => ((_unref(theme).surface) = $event))\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, _unref(theme).surface]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_41, [\n                                        _cache[42] || (_cache[42] = _createElementVNode(\"span\", null, \"面板辅助\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"color\",\n                                            \"onUpdate:modelValue\": _cache[18] || (_cache[18] = ($event) => ((_unref(theme).surfaceAlt) = $event))\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, _unref(theme).surfaceAlt]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_42, [\n                                        _cache[43] || (_cache[43] = _createElementVNode(\"span\", null, \"文字\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"color\",\n                                            \"onUpdate:modelValue\": _cache[19] || (_cache[19] = ($event) => ((_unref(theme).text) = $event))\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, _unref(theme).text]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_43, [\n                                        _cache[44] || (_cache[44] = _createElementVNode(\"span\", null, \"次级文字\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"color\",\n                                            \"onUpdate:modelValue\": _cache[20] || (_cache[20] = ($event) => ((_unref(theme).textMuted) = $event))\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, _unref(theme).textMuted]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_44, [\n                                        _cache[45] || (_cache[45] = _createElementVNode(\"span\", null, \"强调色\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"color\",\n                                            \"onUpdate:modelValue\": _cache[21] || (_cache[21] = ($event) => ((_unref(theme).accent) = $event))\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, _unref(theme).accent]\n                                        ])\n                                    ]),\n                                    _createElementVNode(\"div\", _hoisted_45, [\n                                        _cache[46] || (_cache[46] = _createElementVNode(\"span\", null, \"边框\", -1 /* CACHED */)),\n                                        _withDirectives(_createElementVNode(\"input\", {\n                                            type: \"color\",\n                                            \"onUpdate:modelValue\": _cache[22] || (_cache[22] = ($event) => ((_unref(theme).border) = $event))\n                                        }, null, 512 /* NEED_PATCH */), [\n                                            [_vModelText, _unref(theme).border]\n                                        ])\n                                    ])\n                                ])\n                            ]),\n                            _createElementVNode(\"footer\", _hoisted_46, [\n                                _createElementVNode(\"button\", {\n                                    class: \"macro-btn is-ghost\",\n                                    type: \"button\",\n                                    onClick: _cache[23] || (_cache[23] =\n                                        //@ts-ignore\n                                        (...args) => (_unref(resetTheme) && _unref(resetTheme)(...args)))\n                                }, \"恢复默认主题\"),\n                                _createElementVNode(\"button\", {\n                                    class: \"macro-btn is-primary\",\n                                    type: \"button\",\n                                    onClick: _cache[24] || (_cache[24] = ($event) => (themeOpen.value = false))\n                                }, \"完成\")\n                            ])\n                        ])\n                    ]))\n                    : _createCommentVNode(\"v-if\", true)\n            ], 2 /* CLASS */));\n        };\n    }\n});\n","/* unplugin-vue-components disabled */import script from \"./App.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./App.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","const __WEBPACK_NAMESPACE_OBJECT__ = z;","import { computed, createApp, ref, watch } from 'vue';\nimport { createScriptIdDiv } from '../../../util/script';\nimport App from '../ui/App.vue';\nimport { MacroUiKey } from '../ui/context';\nconst ThemeSchema = z\n    .object({\n    bg: z.string().default('#f6f1ea'),\n    surface: z.string().default('#ffffff'),\n    surfaceAlt: z.string().default('#f1ebe4'),\n    text: z.string().default('#1c1c1c'),\n    textMuted: z.string().default('#6a5f54'),\n    accent: z.string().default('#d9934f'),\n    border: z.string().default('#e3d6c9'),\n})\n    .prefault({});\nconst MacroSchema = z\n    .object({\n    id: z.string().default(''),\n    name: z.string().default(''),\n    content: z.string().default(''),\n    send: z.boolean().default(false),\n    append: z.boolean().default(false),\n    newline: z.boolean().default(true),\n    scope: z.enum(['global', 'character']).default('global'),\n    characterId: z.string().default(''),\n})\n    .prefault({});\nconst SettingsSchema = z\n    .object({\n    macros: z.array(MacroSchema).default([]),\n    theme: ThemeSchema.default({}),\n})\n    .prefault({ macros: [], theme: ThemeSchema.parse({}) });\nconst SCRIPT_OPTION = { type: 'script', script_id: getScriptId() };\nconst MANAGE_BUTTON_NAME = '管理快捷语句';\nconst DEFAULT_MACROS = [\n    {\n        id: '',\n        name: '问候',\n        content: '你好！',\n        send: false,\n        append: false,\n        newline: true,\n        scope: 'global',\n        characterId: '',\n    },\n    {\n        id: '',\n        name: '继续',\n        content: '继续。',\n        send: true,\n        append: false,\n        newline: true,\n        scope: 'global',\n        characterId: '',\n    },\n];\nconst DEFAULT_THEME = ThemeSchema.parse({});\nfunction ensureMacroIds(macros) {\n    return macros.map(macro => ({\n        ...macro,\n        id: macro.id || SillyTavern.uuidv4(),\n    }));\n}\nfunction getCurrentCharacterId() {\n    const raw = SillyTavern?.characterId ?? SillyTavern?.getContext?.().characterId ?? '';\n    if (raw === undefined || raw === null) {\n        return '';\n    }\n    return String(raw);\n}\nfunction getCurrentCharacterLabel() {\n    const id = getCurrentCharacterId();\n    const idx = Number(id);\n    const list = SillyTavern?.characters;\n    if (!Number.isNaN(idx) && list?.[idx]?.name) {\n        return `当前角色：${list[idx].name}`;\n    }\n    return id ? `当前角色ID：${id}` : '未选择角色';\n}\nfunction ensureScopeDefaults(macros) {\n    const currentId = getCurrentCharacterId();\n    return macros.map(macro => {\n        if (macro.scope === 'character' && !macro.characterId) {\n            return { ...macro, characterId: currentId };\n        }\n        return macro;\n    });\n}\nfunction normalizeMacros(macros) {\n    const warnings = [];\n    const seen = new Set();\n    const normalized = [];\n    for (const macro of macros) {\n        const name = macro.name.trim();\n        if (!name) {\n            warnings.push('忽略空名称的快捷语句。');\n            continue;\n        }\n        if (name === MANAGE_BUTTON_NAME) {\n            warnings.push(`快捷语句名称 \"${MANAGE_BUTTON_NAME}\" 保留，已忽略。`);\n            continue;\n        }\n        if (seen.has(name)) {\n            warnings.push(`快捷语句名称 \"${name}\" 重复，已忽略后续条目。`);\n            continue;\n        }\n        seen.add(name);\n        normalized.push({ ...macro, name });\n    }\n    return { macros: ensureMacroIds(normalized), warnings };\n}\nfunction loadSettings() {\n    const raw = getVariables(SCRIPT_OPTION);\n    let settings = SettingsSchema.parse(raw ?? {});\n    if (!Array.isArray(raw?.macros)) {\n        settings = { macros: ensureMacroIds(DEFAULT_MACROS), theme: DEFAULT_THEME };\n        replaceVariables(settings, SCRIPT_OPTION);\n    }\n    else {\n        settings.macros = ensureMacroIds(settings.macros);\n    }\n    settings.macros = ensureScopeDefaults(settings.macros);\n    if (!raw?.theme) {\n        settings.theme = DEFAULT_THEME;\n        replaceVariables(settings, SCRIPT_OPTION);\n    }\n    return settings;\n}\nfunction saveSettings(settings) {\n    replaceVariables(settings, SCRIPT_OPTION);\n}\nfunction getUniqueName(baseName, macros) {\n    const existing = new Set(macros.map(macro => macro.name));\n    if (!existing.has(baseName)) {\n        return baseName;\n    }\n    let index = 2;\n    while (existing.has(`${baseName} ${index}`)) {\n        index += 1;\n    }\n    return `${baseName} ${index}`;\n}\nfunction findInput() {\n    const selectors = [\n        '#send_textarea',\n        '#sendTextArea',\n        '#send-textarea',\n        'textarea#send_textarea',\n        'textarea#sendTextArea',\n        'textarea#send-textarea',\n        'textarea[name=\"send_textarea\"]',\n    ];\n    for (const selector of selectors) {\n        const $input = $(selector).first();\n        if ($input.length) {\n            return $input;\n        }\n    }\n    return null;\n}\nfunction clickSendButton() {\n    const $button = $('#send_but, #send_button, #send').first();\n    if ($button.length) {\n        $button.trigger('click');\n        return;\n    }\n    toastr.warning('未找到发送按钮，请手动发送。');\n}\nasync function sendMacroContent(content) {\n    const trimmed = content.trimEnd();\n    if (!trimmed.trim()) {\n        toastr.warning('快捷语句为空，未发送。');\n        return true;\n    }\n    try {\n        await createChatMessages([{ role: 'user', message: trimmed }]);\n        await triggerSlash('/trigger');\n        return true;\n    }\n    catch (error) {\n        console.error('快捷语句发送失败，尝试点击发送按钮。', error);\n        return false;\n    }\n}\nasync function applyMacro(macro) {\n    const $input = findInput();\n    if (!$input) {\n        toastr.error('未找到输入框，无法插入快捷语句。');\n        return;\n    }\n    const current = String($input.val() ?? '');\n    const prefix = macro.append && current ? (macro.newline ? '\\n' : '') : '';\n    const replacement = macro.append\n        ? `${current}${prefix}${macro.content}`\n        : `${macro.content}${macro.newline ? '\\n' : ''}`;\n    $input.val(replacement);\n    $input.trigger('input');\n    $input.trigger('change');\n    $input.trigger('focus');\n    if (macro.send) {\n        const sent = await sendMacroContent(replacement);\n        if (sent) {\n            $input.val('');\n            $input.trigger('input');\n            $input.trigger('change');\n            return;\n        }\n        SillyTavern.activateSendButtons?.();\n        setTimeout(clickSendButton, 0);\n    }\n}\nfunction renderButtons(settings) {\n    const currentId = getCurrentCharacterId();\n    const visibleMacros = settings.macros.filter(macro => {\n        if (macro.scope === 'global') {\n            return true;\n        }\n        return macro.characterId && macro.characterId === currentId;\n    });\n    const buttons = [\n        { name: MANAGE_BUTTON_NAME, visible: true },\n        ...visibleMacros.map(macro => ({ name: macro.name, visible: true })),\n    ];\n    replaceScriptButtons(buttons);\n}\nconst macroButtonStops = [];\nlet manageButtonStop = null;\nfunction clearMacroButtonEvents() {\n    while (macroButtonStops.length) {\n        macroButtonStops.pop().stop();\n    }\n}\nfunction bindMacroEvents(settings) {\n    clearMacroButtonEvents();\n    const currentId = getCurrentCharacterId();\n    settings.macros\n        .filter(macro => macro.scope === 'global' || (macro.scope === 'character' && macro.characterId === currentId))\n        .forEach(macro => {\n        macroButtonStops.push(eventOn(getButtonEvent(macro.name), () => {\n            void applyMacro(macro);\n        }));\n    });\n}\nfunction ensureManageButton(manager) {\n    if (manageButtonStop) {\n        return;\n    }\n    manageButtonStop = eventOn(getButtonEvent(MANAGE_BUTTON_NAME), () => {\n        manager.open();\n    });\n}\nfunction buildStyleText() {\n    return `\n    .macro-root {\n      position: fixed;\n      inset: 0;\n      width: 100vw;\n      height: 100vh;\n      display: none;\n      align-items: center;\n      justify-content: center;\n      font-family: \"Segoe UI\", \"PingFang SC\", \"Microsoft YaHei\", sans-serif;\n      color: var(--macro-text, #f5f5f7);\n      --macro-bg: #f6f1ea;\n      --macro-surface: #ffffff;\n      --macro-surface-alt: #f1ebe4;\n      --macro-text: #1c1c1c;\n      --macro-text-muted: #6a5f54;\n      --macro-accent: #d9934f;\n      --macro-border: #e3d6c9;\n      z-index: 9999;\n    }\n\n    .macro-root.open {\n      display: flex;\n    }\n\n    .macro-backdrop {\n      position: absolute;\n      inset: 0;\n      background: rgba(10, 12, 16, 0.55);\n      backdrop-filter: blur(4px);\n    }\n\n    .macro-panel {\n      position: relative;\n      width: min(980px, 96vw);\n      height: min(680px, 92vh);\n      background: var(--macro-surface) !important;\n      border: 1px solid var(--macro-border) !important;\n      border-radius: 16px;\n      display: flex;\n      flex-direction: column;\n      overflow: hidden;\n      box-shadow: 0 24px 60px rgba(0, 0, 0, 0.35);\n      z-index: 1;\n      color: var(--macro-text) !important;\n    }\n\n    .macro-header {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: 16px 20px;\n      border-bottom: 1px solid var(--macro-border);\n      background: linear-gradient(135deg, rgba(217, 147, 79, 0.14), rgba(255, 250, 243, 0.92));\n    }\n\n    .macro-header-actions {\n      display: flex;\n      align-items: center;\n      gap: 10px;\n    }\n\n    .macro-title__main {\n      font-size: 18px;\n      font-weight: 600;\n      letter-spacing: 0.5px;\n    }\n\n    .macro-title__sub {\n      font-size: 12px;\n      color: var(--macro-text-muted);\n      margin-top: 4px;\n    }\n\n    .macro-close {\n      border: 1px solid var(--macro-border);\n      background: transparent;\n      color: var(--macro-text);\n      border-radius: 10px;\n      padding: 6px 12px;\n      cursor: pointer;\n    }\n\n    .macro-icon-btn {\n      border: 1px solid var(--macro-border);\n      background: color-mix(in srgb, var(--macro-surface) 82%, var(--macro-text) 18%);\n      color: var(--macro-text);\n      border-radius: 10px;\n      padding: 6px 10px;\n      cursor: pointer;\n      font-size: 12px;\n      line-height: 1;\n    }\n\n    .macro-body {\n      flex: 1;\n      display: grid;\n      grid-template-columns: 260px 1fr;\n      min-height: 0;\n    }\n\n    .macro-sidebar {\n      border-right: 1px solid var(--macro-border) !important;\n      background: var(--macro-surface-alt) !important;\n      display: flex;\n      flex-direction: column;\n      min-height: 0;\n      color: var(--macro-text) !important;\n    }\n\n    .macro-section-title {\n      padding: 14px 16px;\n      font-size: 12px;\n      color: var(--macro-text-muted);\n      text-transform: uppercase;\n      letter-spacing: 1.2px;\n    }\n\n    .macro-list {\n      flex: 1;\n      overflow: auto;\n      padding: 0 12px 12px;\n    }\n\n    .macro-item {\n      border: 1px solid transparent;\n      background: transparent;\n      border-radius: 10px;\n      padding: 10px 12px;\n      margin-bottom: 8px;\n      cursor: pointer;\n      display: flex;\n      flex-direction: column;\n      gap: 4px;\n      text-align: left;\n      color: inherit;\n    }\n\n    .macro-item__row {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      gap: 10px;\n    }\n\n    .macro-item__actions {\n      display: flex;\n      gap: 6px;\n    }\n\n    .macro-item.active {\n      border-color: rgba(76, 195, 255, 0.6);\n      background: rgba(76, 195, 255, 0.12);\n    }\n\n    .macro-item__name {\n      font-size: 14px;\n      font-weight: 600;\n    }\n\n    .macro-item__meta {\n      font-size: 12px;\n      color: var(--macro-text-muted);\n    }\n\n    .macro-actions {\n      display: flex;\n      gap: 8px;\n      padding: 12px 16px 16px;\n      border-top: 1px solid var(--macro-border);\n    }\n\n    .macro-content {\n      display: flex;\n      flex-direction: column;\n      gap: 18px;\n      padding: 18px 20px;\n      overflow: auto;\n      background: var(--macro-surface) !important;\n      color: var(--macro-text) !important;\n    }\n\n    .macro-field {\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n    }\n\n    .macro-field label {\n      font-size: 13px;\n      color: var(--macro-text-muted);\n    }\n\n    .macro-input,\n    .macro-textarea {\n      width: 100%;\n      background: var(--macro-surface-alt) !important;\n      color: var(--macro-text) !important;\n      border: 1px solid var(--macro-border) !important;\n      border-radius: 10px;\n      padding: 10px 12px;\n      font-size: 14px;\n      box-shadow: none !important;\n    }\n\n    .macro-textarea {\n      min-height: 140px;\n      resize: vertical;\n    }\n\n    .macro-input:focus,\n    .macro-textarea:focus {\n      outline: none;\n      border-color: var(--macro-accent) !important;\n      box-shadow: 0 0 0 2px color-mix(in srgb, var(--macro-accent) 30%, transparent) !important;\n    }\n\n    .macro-root input,\n    .macro-root textarea {\n      background: var(--macro-surface-alt) !important;\n      color: var(--macro-text) !important;\n      border-color: var(--macro-border) !important;\n      box-shadow: none !important;\n      filter: none !important;\n    }\n\n    .macro-empty {\n      font-size: 13px;\n      color: var(--macro-text-muted);\n      padding: 8px 0;\n    }\n\n    .macro-toggle-row {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 12px;\n      align-items: center;\n    }\n\n    .macro-toggle {\n      display: inline-flex;\n      align-items: center;\n      gap: 6px;\n      font-size: 13px;\n    }\n\n    .macro-theme-grid {\n      display: grid;\n      grid-template-columns: repeat(2, minmax(0, 1fr));\n      gap: 12px;\n    }\n\n    .macro-theme-modal {\n      position: absolute;\n      inset: 0;\n      background: rgba(12, 14, 18, 0.65);\n      backdrop-filter: blur(6px);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      padding: 24px;\n      z-index: 2;\n    }\n\n    .macro-theme-panel {\n      width: min(720px, 92vw);\n      background: var(--macro-surface);\n      border: 1px solid var(--macro-border);\n      border-radius: 16px;\n      display: flex;\n      flex-direction: column;\n      gap: 16px;\n      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.25);\n    }\n\n    .macro-theme-header {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      padding: 16px 20px 0;\n    }\n\n    .macro-theme-title {\n      font-size: 18px;\n      font-weight: 600;\n    }\n\n    .macro-theme-sub {\n      font-size: 12px;\n      color: var(--macro-text-muted);\n      margin-top: 4px;\n    }\n\n    .macro-theme-body {\n      display: flex;\n      flex-direction: column;\n      gap: 16px;\n      padding: 0 20px;\n    }\n\n    .macro-theme-presets {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 10px;\n    }\n\n    .macro-theme-preset {\n      border: 1px solid var(--macro-border);\n      background: rgba(12, 14, 20, 0.12);\n      color: var(--macro-text);\n      border-radius: 999px;\n      padding: 6px 14px;\n      font-size: 13px;\n      cursor: pointer;\n      display: inline-flex;\n      align-items: center;\n      gap: 8px;\n    }\n\n    .macro-theme-dot {\n      width: 10px;\n      height: 10px;\n      border-radius: 50%;\n      display: inline-block;\n    }\n\n    .macro-theme-footer {\n      display: flex;\n      justify-content: flex-end;\n      gap: 10px;\n      padding: 0 20px 18px;\n    }\n\n    .macro-select {\n      background: var(--macro-surface-alt) !important;\n      color: var(--macro-text) !important;\n      border: 1px solid var(--macro-border) !important;\n      border-radius: 10px;\n      padding: 8px 12px;\n      font-size: 13px;\n    }\n\n    .macro-scope-row {\n      display: flex;\n      align-items: center;\n      gap: 10px;\n      flex-wrap: wrap;\n    }\n\n    .macro-scope-hint {\n      font-size: 12px;\n      color: var(--macro-text-muted);\n    }\n\n    .macro-theme-item {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      gap: 10px;\n      background: color-mix(in srgb, var(--macro-surface) 86%, var(--macro-text) 14%);\n      border: 1px solid var(--macro-border);\n      border-radius: 10px;\n      padding: 8px 10px;\n      font-size: 12px;\n      color: var(--macro-text-muted);\n    }\n\n    .macro-theme-item input[type=\"color\"] {\n      border: none;\n      background: transparent;\n      width: 36px;\n      height: 24px;\n      padding: 0;\n    }\n\n    .macro-btn {\n      border: 1px solid var(--macro-border);\n      background: color-mix(in srgb, var(--macro-surface) 82%, var(--macro-text) 18%);\n      color: var(--macro-text);\n      border-radius: 10px;\n      padding: 8px 12px;\n      font-size: 13px;\n      cursor: pointer;\n    }\n\n    .macro-btn.is-primary {\n      border-color: var(--macro-accent);\n      background: var(--macro-accent);\n      color: #05131b;\n      font-weight: 600;\n    }\n\n    .macro-btn.is-ghost {\n      background: transparent;\n    }\n\n    .macro-footer {\n      display: flex;\n      justify-content: flex-end;\n      gap: 10px;\n      padding: 14px 20px;\n      border-top: 1px solid var(--macro-border);\n      background: rgba(10, 12, 16, 0.6);\n    }\n\n    @media (max-width: 900px) {\n      .macro-body {\n        grid-template-columns: 1fr;\n      }\n\n      .macro-sidebar {\n        border-right: none;\n        border-bottom: 1px solid var(--macro-border);\n      }\n    }\n  `;\n}\nfunction createMacroManager(getSettings, onSave) {\n    const visible = ref(false);\n    const macros = ref([]);\n    const theme = ref({ ...DEFAULT_THEME });\n    const selectedId = ref(null);\n    const selectedMacro = computed(() => macros.value.find(macro => macro.id === selectedId.value) ?? null);\n    let app = null;\n    let $mount = null;\n    let $style = null;\n    function applyThemeColors(nextTheme) {\n        if (!$mount) {\n            return;\n        }\n        const $root = $mount.find('.macro-root');\n        $root.css({\n            '--macro-bg': nextTheme.bg,\n            '--macro-surface': nextTheme.surface,\n            '--macro-surface-alt': nextTheme.surfaceAlt,\n            '--macro-text': nextTheme.text,\n            '--macro-text-muted': nextTheme.textMuted,\n            '--macro-accent': nextTheme.accent,\n            '--macro-border': nextTheme.border,\n        });\n    }\n    function syncFromSettings() {\n        const settings = getSettings();\n        macros.value = _.cloneDeep(settings.macros);\n        theme.value = _.cloneDeep(settings.theme);\n        if (macros.value.length && !selectedId.value) {\n            selectedId.value = macros.value[0].id;\n        }\n        if (selectedId.value && !macros.value.some(macro => macro.id === selectedId.value)) {\n            selectedId.value = macros.value[0]?.id ?? null;\n        }\n        applyThemeColors(theme.value);\n    }\n    function ensureMounted() {\n        if ($mount) {\n            return;\n        }\n        $style = $('<style>').attr('data-macro-style', getScriptId()).text(buildStyleText()).appendTo('head');\n        $mount = createScriptIdDiv().addClass('macro-mount').appendTo('body');\n        app = createApp(App);\n        const currentCharacterLabel = computed(() => getCurrentCharacterLabel());\n        const uiContext = {\n            visible,\n            macros,\n            theme,\n            selectedId,\n            selectedMacro,\n            selectMacro: id => {\n                selectedId.value = id;\n            },\n            currentCharacterLabel,\n            bindCurrentCharacter: () => {\n                const current = selectedMacro.value;\n                if (!current) {\n                    return;\n                }\n                current.scope = 'character';\n                current.characterId = getCurrentCharacterId();\n            },\n            close: () => {\n                visible.value = false;\n            },\n            addMacro: () => {\n                const name = getUniqueName('新快捷语句', macros.value);\n                const macro = {\n                    id: SillyTavern.uuidv4(),\n                    name,\n                    content: '',\n                    send: false,\n                    append: false,\n                    newline: true,\n                    scope: 'global',\n                    characterId: '',\n                };\n                macros.value.push(macro);\n                selectedId.value = macro.id;\n            },\n            duplicateMacro: () => {\n                const current = selectedMacro.value;\n                if (!current) {\n                    return;\n                }\n                const name = getUniqueName(`${current.name} 副本`, macros.value);\n                const macro = {\n                    ..._.cloneDeep(current),\n                    id: SillyTavern.uuidv4(),\n                    name,\n                };\n                macros.value.push(macro);\n                selectedId.value = macro.id;\n            },\n            removeMacro: () => {\n                const current = selectedMacro.value;\n                if (!current) {\n                    return;\n                }\n                const next = macros.value.filter(macro => macro.id !== current.id);\n                macros.value = next;\n                selectedId.value = next[0]?.id ?? null;\n            },\n            moveMacro: delta => {\n                const current = selectedMacro.value;\n                if (!current) {\n                    return;\n                }\n                const index = macros.value.findIndex(macro => macro.id === current.id);\n                const nextIndex = index + delta;\n                if (nextIndex < 0 || nextIndex >= macros.value.length) {\n                    return;\n                }\n                const reordered = [...macros.value];\n                const [item] = reordered.splice(index, 1);\n                reordered.splice(nextIndex, 0, item);\n                macros.value = reordered;\n            },\n            resetTheme: () => {\n                theme.value = { ...DEFAULT_THEME };\n            },\n            save: () => {\n                const normalized = normalizeMacros(ensureScopeDefaults(macros.value));\n                normalized.warnings.forEach(warning => toastr.warning(warning));\n                const nextSettings = {\n                    macros: normalized.macros,\n                    theme: ThemeSchema.parse(theme.value),\n                };\n                onSave(nextSettings);\n                visible.value = false;\n            },\n        };\n        app.provide(MacroUiKey, uiContext);\n        app.mount($mount[0]);\n    }\n    watch(() => theme.value, nextTheme => applyThemeColors(ThemeSchema.parse(nextTheme)), { deep: true });\n    function open() {\n        ensureMounted();\n        syncFromSettings();\n        visible.value = true;\n        setTimeout(() => {\n            const input = window.parent.document.querySelector('[data-focus=\"name\"]');\n            input?.focus();\n        }, 0);\n    }\n    function close() {\n        visible.value = false;\n    }\n    const onKeydown = (event) => {\n        if (event.key === 'Escape' && visible.value) {\n            close();\n        }\n    };\n    window.parent.addEventListener('keydown', onKeydown);\n    return {\n        open,\n        syncFromSettings,\n        destroy: () => {\n            window.parent.removeEventListener('keydown', onKeydown);\n            app?.unmount();\n            $mount?.remove();\n            $style?.remove();\n            $mount = null;\n            $style = null;\n            app = null;\n        },\n    };\n}\nexport function initMacroManager() {\n    let settings = loadSettings();\n    const normalized = normalizeMacros(settings.macros);\n    if (normalized.warnings.length) {\n        normalized.warnings.forEach(warning => toastr.warning(warning));\n    }\n    settings = {\n        macros: normalized.macros,\n        theme: ThemeSchema.parse(settings.theme),\n    };\n    saveSettings(settings);\n    renderButtons(settings);\n    bindMacroEvents(settings);\n    const manager = createMacroManager(() => settings, nextSettings => {\n        settings = nextSettings;\n        saveSettings(settings);\n        renderButtons(settings);\n        bindMacroEvents(settings);\n    });\n    ensureManageButton(manager);\n    const refreshOnChat = eventOn(tavern_events.CHAT_CHANGED, () => {\n        renderButtons(settings);\n        bindMacroEvents(settings);\n    });\n    $(window).on('pagehide', () => {\n        clearMacroButtonEvents();\n        refreshOnChat.stop();\n        manageButtonStop?.stop();\n        manageButtonStop = null;\n        manager.destroy();\n    });\n}\n","import iframe_srcdoc from './iframe_srcdoc.html';\n\nexport async function loadReadme(url: string): Promise<boolean> {\n  const readme = await fetch(url);\n  if (!readme.ok) {\n    return false;\n  }\n  const readme_text = await readme.text();\n  replaceScriptInfo(readme_text);\n  return true;\n}\n\nexport function teleportStyle(\n  append_to: JQuery.Selector | JQuery.htmlString | JQuery.TypeOrArray<Element | DocumentFragment> | JQuery = 'head',\n): { destroy: () => void } {\n  const $div = $(`<div>`)\n    .attr('script_id', getScriptId())\n    .append($(`head > style`, document).clone())\n    .appendTo(append_to);\n\n  return {\n    destroy: () => $div.remove(),\n  };\n}\n\nexport function createScriptIdIframe(): JQuery<HTMLIFrameElement> {\n  return $(`<iframe>`).attr({\n    script_id: getScriptId(),\n    frameborder: 0,\n    srcdoc: iframe_srcdoc,\n  }) as JQuery<HTMLIFrameElement>;\n}\n\nexport function createScriptIdDiv(): JQuery<HTMLDivElement> {\n  return $('<div>').attr('script_id', getScriptId()) as JQuery<HTMLDivElement>;\n}\n\nexport function reloadOnChatChange(): EventOnReturn {\n  let chat_id = SillyTavern.getCurrentChatId();\n  return eventOn(tavern_events.CHAT_CHANGED, new_chat_id => {\n    if (chat_id !== new_chat_id) {\n      chat_id = new_chat_id;\n      window.location.reload();\n    }\n  });\n}\n","import { initMacroManager } from './entry/portal';\n\n$(() => {\n  errorCatched(initMacroManager)();\n});\n"],"names":["Vue","MacroUiKey","Symbol","_hoisted_1","class","role","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","key","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","_hoisted_46","__name","setup","__props","ctx","inject","Error","visible","macros","theme","selectedId","selectedMacro","selectMacro","currentCharacterLabel","bindCurrentCharacter","close","addMacro","duplicateMacro","removeMacro","moveMacro","resetTheme","save","themeOpen","ref","themePresets","name","colors","bg","surface","surfaceAlt","text","textMuted","accent","border","_ctx","_cache","open","onClick","args","type","$event","value","macro","id","active","scope","newline","send","append","placeholder","content","disabled","preset","style","background","z","ThemeSchema","object","string","default","prefault","MacroSchema","boolean","enum","characterId","SettingsSchema","array","parse","SCRIPT_OPTION","script_id","getScriptId","MANAGE_BUTTON_NAME","DEFAULT_MACROS","DEFAULT_THEME","ensureMacroIds","map","SillyTavern","uuidv4","getCurrentCharacterId","raw","getContext","String","ensureScopeDefaults","currentId","normalizeMacros","warnings","seen","Set","normalized","trim","has","push","add","saveSettings","settings","replaceVariables","getUniqueName","baseName","existing","index","clickSendButton","$button","$","first","length","trigger","toastr","warning","async","applyMacro","$input","selectors","selector","findInput","error","current","val","prefix","replacement","trimmed","trimEnd","createChatMessages","message","triggerSlash","console","sendMacroContent","activateSendButtons","setTimeout","renderButtons","visibleMacros","filter","buttons","replaceScriptButtons","macroButtonStops","manageButtonStop","clearMacroButtonEvents","pop","stop","bindMacroEvents","forEach","eventOn","getButtonEvent","createMacroManager","getSettings","onSave","computed","find","app","$mount","$style","applyThemeColors","nextTheme","css","syncFromSettings","_","cloneDeep","some","ensureMounted","attr","appendTo","addClass","createApp","App","idx","Number","list","characters","isNaN","getCurrentCharacterLabel","uiContext","next","delta","findIndex","nextIndex","reordered","item","splice","nextSettings","provide","mount","watch","deep","onKeydown","event","window","parent","addEventListener","input","document","querySelector","focus","destroy","removeEventListener","unmount","remove","initMacroManager","getVariables","Array","isArray","loadSettings","manager","ensureManageButton","refreshOnChat","tavern_events","CHAT_CHANGED","on","errorCatched"],"ignoreList":[],"sourceRoot":""}