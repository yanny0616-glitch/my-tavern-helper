<head><script type="module">import{waitUntil as n}from'https://testingcf.jsdelivr.net/npm/async-wait-until/+esm';import{createPinia as e,defineStore as t}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';import'https://testingcf.jsdelivr.net/npm/compare-versions/+esm';import'https://testingcf.jsdelivr.net/npm/zod/v4/core/+esm';var a={61(n){n.exports=Vue},502(n,e){e.A=(n,e)=>{const t=n.__vccOpts||n;for(const[n,a]of e)t[n]=a;return t}}},r={};function o(n){var e=r[n];if(void 0!==e)return e.exports;var t=r[n]={exports:{}};return a[n](t,t.exports,o),t.exports}o.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return o.d(e,{a:e}),e},o.d=(n,e)=>{for(var t in e)o.o(e,t)&&!o.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),(()=>{var a=o(61);const r=_;var i=o.n(r);function c(n){return!!(0,a.getCurrentScope)()&&((0,a.onScopeDispose)(n),!0)}const l='undefined'!=typeof window&&'undefined'!=typeof document,s=('undefined'!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString),d=n=>'[object Object]'===s.call(n),u=()=>{};function p(...n){if(1!==n.length)return(0,a.toRef)(...n);const e=n[0];return'function'==typeof e?(0,a.readonly)((0,a.customRef)(()=>({get:e,set:u}))):(0,a.ref)(e)}function m(n,e){return function(...t){return new Promise((a,r)=>{Promise.resolve(n(()=>e.apply(this,t),{fn:e,thisArg:this,args:t})).then(a).catch(r)})}}const f=n=>n();function b(n){return Array.isArray(n)?n:[n]}function g(n){const e=Object.create(null);return t=>e[t]||(e[t]=n(t))}const h=/\B([A-Z])/g,v=(g(n=>n.replace(h,'-$1').toLowerCase()),/-(\w)/g);g(n=>n.replace(v,(_,n)=>n?n.toUpperCase():''));function x(n){return n||(0,a.getCurrentInstance)()}function y(n,e,t={}){const{eventFilter:r=f,...o}=t;return(0,a.watch)(n,m(r,e),o)}function w(n,e,t={}){const{eventFilter:r,initialState:o='active',...i}=t,{eventFilter:c,pause:l,resume:s,isActive:d}=function(n=f,e={}){const{initialState:t='active'}=e,r=p('active'===t);return{isActive:(0,a.readonly)(r),pause:function(){r.value=!1},resume:function(){r.value=!0},eventFilter:(...e)=>{r.value&&n(...e)}}}(r,{initialState:o});return{stop:y(n,e,{...i,eventFilter:c}),pause:l,resume:s,isActive:d}}function k(n,e=1e3,t={}){const{immediate:r=!0,immediateCallback:o=!1}=t;let i=null;const s=(0,a.shallowRef)(!1);function d(){i&&(clearInterval(i),i=null)}function u(){s.value=!1,d()}function p(){const t=(0,a.toValue)(e);t<=0||(s.value=!0,o&&n(),d(),s.value&&(i=setInterval(n,t)))}if(r&&l&&p(),(0,a.isRef)(e)||'function'==typeof e){c((0,a.watch)(e,()=>{s.value&&l&&p()}))}return c(u),{isActive:(0,a.shallowReadonly)(s),pause:u,resume:p}}function E(n,e,t={}){const{eventFilter:r=f,...o}=t,i=m(r,e);let c,l,s;if('sync'===o.flush){let e=!1;l=()=>{},c=n=>{e=!0,n(),e=!1},s=(0,a.watch)(n,(...n)=>{e||i(...n)},o)}else{const e=[];let t=0,r=0;l=()=>{t=r},e.push((0,a.watch)(n,()=>{r++},{...o,flush:'sync'})),c=n=>{const e=r;n(),t+=r-e},e.push((0,a.watch)(n,(...n)=>{const e=t>0&&t===r;t=0,r=0,e||i(...n)},o)),s=()=>{e.forEach(n=>n())}}return{stop:s,ignoreUpdates:c,ignorePrevAsyncUpdates:l}}const N=z,C=N.z.object({世界:N.z.object({当前时间:N.z.string(),当前地点:N.z.string(),近期事务:N.z.record(N.z.string().describe('事务名'),N.z.string().describe('事务描述'))}),白娅:N.z.object({依存度:N.z.coerce.number().transform(n=>_.clamp(n,0,100)),着装:N.z.record(N.z.enum(['上装','下装','内衣','袜子','鞋子','饰品']),N.z.string().describe('服装描述')),称号:N.z.record(N.z.string().describe('称号名'),N.z.object({效果:N.z.string(),自我评价:N.z.string()}))}).transform(n=>{const e=n.依存度<20?'消极自毁':n.依存度<40?'渴求注视':n.依存度<60?'暗中靠近':n.依存度<80?'忐忑相依':'柔软依存';return n.称号=_(n.称号).entries().takeRight(Math.ceil(n.依存度/10)).fromPairs().value(),{...n,$依存度阶段:e}}),主角:N.z.object({物品栏:N.z.record(N.z.string().describe('物品名'),N.z.object({描述:N.z.string(),数量:N.z.coerce.number()})).transform(n=>_.pickBy(n,({数量:n})=>n>0))})}),V=(B=C,'message'!==(S={type:'message',message_id:getCurrentMessageId()}).type||void 0!==S.message_id&&'latest'!==S.message_id||(S.message_id=-1),t(`mvu_data.${_(S).entries().sortBy(n=>n[0]).map(n=>n[1]).join('.')}`,errorCatched(()=>{const n=(0,a.ref)(B.parse(_.get(getVariables(S),'stat_data',{})));D&&D(n),k(()=>{const t=_.get(getVariables(S),'stat_data',{}),a=B.safeParse(t);a.error||(_.isEqual(n.value,a.data)||e(()=>{n.value=a.data}),_.isEqual(t,a.data)||updateVariablesWith(n=>_.set(n,'stat_data',a.data),S))},2e3);const{ignoreUpdates:e}=E(n,t=>{const a=B.safeParse(t);a.error||(_.isEqual(t,a.data)||e(()=>{n.value=a.data}),updateVariablesWith(n=>_.set(n,'stat_data',a.data),S))},{deep:!0});return{data:n}})));var B,S,D;const A={class:'char-layout'},T={class:'section-head'},M={class:'title-grid'},j={class:'title-name'},L={class:'title-effect'},I={class:'title-quote'},O={key:0,class:'title-box'},H={class:'attire-list'},P={class:'attire-slot'},F=(0,a.defineComponent)({__name:'CharacterPanel',setup(n){const e=V();return(n,t)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',A,[(0,a.createElementVNode)('div',T,(0,a.toDisplayString)((0,a.unref)(e).data.白娅.$依存度阶段),1),(0,a.createElementVNode)('div',M,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(e).data.白娅.称号,(n,e)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e,class:'title-box'},[(0,a.createElementVNode)('span',j,(0,a.toDisplayString)(e),1),(0,a.createElementVNode)('div',L,(0,a.toDisplayString)(n.效果),1),(0,a.createElementVNode)('div',I,'"'+(0,a.toDisplayString)(n.自我评价)+'"',1)]))),128)),(0,a.unref)(i()).isEmpty((0,a.unref)(e).data.白娅.称号)?((0,a.openBlock)(),(0,a.createElementBlock)('div',O,[...t[0]||(t[0]=[(0,a.createElementVNode)('span',{class:'title-name'},'无称号',-1),(0,a.createElementVNode)('div',{class:'title-effect'},'当前没有生效的称号',-1),(0,a.createElementVNode)('div',{class:'title-quote'},'"..."',-1)])])):(0,a.createCommentVNode)('v-if',!0)]),t[1]||(t[1]=(0,a.createElementVNode)('div',{class:'section-head'},'着装记录',-1)),(0,a.createElementVNode)('div',H,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(e).data.白娅.着装,(n,e)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e,class:'attire-item'},[(0,a.createElementVNode)('span',P,'【'+(0,a.toDisplayString)(e)+'】',1),(0,a.createTextVNode)(' '+(0,a.toDisplayString)(n),1)]))),128))])]))}});var R=o(502);const U=(0,R.A)(F,[['__scopeId','data-v-0da01a64']]),Y={class:'dependency-strip'},J={class:'dependency-track'},q={class:'dependency-value'},K={class:'dependency-controls'},W=['disabled'],X=['disabled'],G=(0,a.defineComponent)({__name:'DependencyBar',setup(n){const e=V();function t(n){e.data.白娅.依存度=e.data.白娅.依存度+n}return(n,r)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',Y,[r[2]||(r[2]=(0,a.createElementVNode)('span',{class:'dependency-label'},'依存度',-1)),(0,a.createElementVNode)('div',J,[(0,a.createElementVNode)('div',{class:'dependency-fill',style:(0,a.normalizeStyle)({width:(0,a.unref)(e).data.白娅.依存度+'%'})},null,4)]),(0,a.createElementVNode)('span',q,(0,a.toDisplayString)((0,a.unref)(e).data.白娅.依存度)+'%',1),(0,a.createElementVNode)('div',K,[(0,a.createElementVNode)('button',{class:'dependency-button',disabled:(0,a.unref)(e).data.白娅.依存度<=0,type:'button',onClick:r[0]||(r[0]=n=>t(-1))},' - ',8,W),(0,a.createElementVNode)('button',{class:'dependency-button',disabled:(0,a.unref)(e).data.白娅.依存度>=100,type:'button',onClick:r[1]||(r[1]=n=>t(1))},' + ',8,X)])]))}}),Z=(0,R.A)(G,[['__scopeId','data-v-d656b568']]),Q={key:0,class:'inventory-grid'},nn={class:'item-icon'},en={class:'item-detail'},tn={class:'item-name'},an={class:'item-desc'},rn={class:'item-count'},on={key:1,class:'empty-state'},cn=(0,a.defineComponent)({__name:'InventoryPanel',setup(n){const e=V();function t(n){return n.includes('手机')||n.includes('电话')?'PH':n.includes('钥匙')?'KY':n.includes('钱')||n.includes('币')?'$$':n.includes('证')||n.includes('卡')?'ID':n.includes('糖')||n.includes('药')?'RX':n.includes('创可贴')||n.includes('绷带')?'+':n.substring(0,2).toUpperCase()}return(n,r)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',null,[r[0]||(r[0]=(0,a.createElementVNode)('div',{class:'section-head'},'物品清单',-1)),(0,a.unref)(i()).isEmpty((0,a.unref)(e).data.主角.物品栏)?((0,a.openBlock)(),(0,a.createElementBlock)('div',on,'背包空空如也...')):((0,a.openBlock)(),(0,a.createElementBlock)('div',Q,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(e).data.主角.物品栏,(n,e)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e,class:'item-row'},[(0,a.createElementVNode)('div',nn,(0,a.toDisplayString)(t(e)),1),(0,a.createElementVNode)('div',en,[(0,a.createElementVNode)('span',tn,(0,a.toDisplayString)(e),1),(0,a.createElementVNode)('span',an,(0,a.toDisplayString)(n.描述),1)]),(0,a.createElementVNode)('span',rn,'x'+(0,a.toDisplayString)(n.数量),1)]))),128))]))]))}}),ln=(0,R.A)(cn,[['__scopeId','data-v-4b907352']]),sn={class:'tabs'},dn=['aria-expanded','onClick'],un=(0,a.defineComponent)({__name:'TabNav',props:(0,a.mergeModels)({tabs:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:['update:modelValue'],setup(n){const e=n,t=(0,a.useModel)(n,'modelValue');return(n,r)=>((0,a.openBlock)(),(0,a.createElementBlock)('nav',sn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.tabs,n=>((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:n.id,class:(0,a.normalizeClass)(['tab-button',{active:t.value===n.id}]),'aria-expanded':t.value===n.id,onClick:e=>{return a=n.id,void(t.value=t.value===a?null:a);var a}},(0,a.toDisplayString)(n.label),11,dn))),128))]))}}),pn=(0,R.A)(un,[['__scopeId','data-v-9a65186e']]),mn={class:'world-section'},fn={class:'meta-row'},bn={class:'event-list'},gn={class:'event-title'},hn={class:'event-desc'},vn={key:0,class:'event-badge'},xn=(0,a.defineComponent)({__name:'WorldSection',setup(n){const e=V(),t=(0,a.computed)(()=>{const n=e.data.世界.当前时间.match(/(\d{4}-\d{2}-\d{2})/);return n?n[1]:e.data.世界.当前时间.split(' ')[0]||'未知'}),r=(0,a.computed)(()=>{const n=e.data.世界.当前时间.match(/(\d{2}:\d{2})/);return n?n[1]:e.data.世界.当前时间.split(' ')[1]||'未知'});return(n,o)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',mn,[(0,a.createElementVNode)('div',fn,[(0,a.createElementVNode)('span',null,'DATE: '+(0,a.toDisplayString)((0,a.unref)(t)),1),(0,a.createElementVNode)('span',null,'TIME: '+(0,a.toDisplayString)((0,a.unref)(r)),1),(0,a.createElementVNode)('span',null,'LOC: '+(0,a.toDisplayString)((0,a.unref)(e).data.世界.当前地点),1)]),(0,a.createElementVNode)('div',bn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)((0,a.unref)(e).data.世界.近期事务,(n,e)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e,class:'event-badge'},[(0,a.createElementVNode)('span',gn,(0,a.toDisplayString)(e),1),(0,a.createElementVNode)('span',hn,(0,a.toDisplayString)(n),1)]))),128)),(0,a.unref)(i()).isEmpty((0,a.unref)(e).data.世界.近期事务)?((0,a.openBlock)(),(0,a.createElementBlock)('div',vn,[...o[0]||(o[0]=[(0,a.createElementVNode)('span',{class:'event-title'},'暂无事务',-1),(0,a.createElementVNode)('span',{class:'event-desc'},'当前没有进行中的事务',-1)])])):(0,a.createCommentVNode)('v-if',!0)])]))}}),yn=(0,R.A)(xn,[['__scopeId','data-v-682d2527']]);const _n=l?window:void 0;l&&window.document,l&&window.navigator,l&&window.location;function wn(n){var e;const t=(0,a.toValue)(n);return null!=(e=null==t?void 0:t.$el)?e:t}function kn(...n){const e=[],t=()=>{e.forEach(n=>n()),e.length=0},r=(0,a.computed)(()=>{const e=b((0,a.toValue)(n[0])).filter(n=>null!=n);return e.every(n=>'string'!=typeof n)?e:void 0}),o=(i=()=>{var e,t;return[null!=(t=null==(e=r.value)?void 0:e.map(n=>wn(n)))?t:[_n].filter(n=>null!=n),b((0,a.toValue)(r.value?n[1]:n[0])),b((0,a.unref)(r.value?n[2]:n[1])),(0,a.toValue)(r.value?n[3]:n[2])]},l=([n,a,r,o])=>{if(t(),!(null==n?void 0:n.length)||!(null==a?void 0:a.length)||!(null==r?void 0:r.length))return;const i=d(o)?{...o}:o;e.push(...n.flatMap(n=>a.flatMap(e=>r.map(t=>((n,e,t,a)=>(n.addEventListener(e,t,a),()=>n.removeEventListener(e,t,a)))(n,e,t,i)))))},s={flush:'post'},(0,a.watch)(i,l,{...s,immediate:!0}));var i,l,s;return c(t),()=>{o(),t()}}Symbol('vueuse-ssr-width');const En='undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:'undefined'!=typeof globalThis?globalThis:'undefined'!=typeof self?self:{},Nn='__vueuse_ssr_handlers__',Cn=Vn();function Vn(){return Nn in En||(En[Nn]=En[Nn]||{}),En[Nn]}function Bn(n,e){return Cn[n]||e}function Sn(n){return null==n?'any':n instanceof Set?'set':n instanceof Map?'map':n instanceof Date?'date':'boolean'==typeof n?'boolean':'string'==typeof n?'string':'object'==typeof n?'object':Number.isNaN(n)?'any':'number'}const zn={boolean:{read:n=>'true'===n,write:n=>String(n)},object:{read:n=>JSON.parse(n),write:n=>JSON.stringify(n)},number:{read:n=>Number.parseFloat(n),write:n=>String(n)},any:{read:n=>n,write:n=>String(n)},string:{read:n=>n,write:n=>String(n)},map:{read:n=>new Map(JSON.parse(n)),write:n=>JSON.stringify(Array.from(n.entries()))},set:{read:n=>new Set(JSON.parse(n)),write:n=>JSON.stringify(Array.from(n))},date:{read:n=>new Date(n),write:n=>n.toISOString()}},Dn='vueuse-storage';function An(n,e,t,r={}){var o;const{flush:i='pre',deep:c=!0,listenToStorageChanges:l=!0,writeDefaults:s=!0,mergeDefaults:d=!1,shallow:u,window:p=_n,eventFilter:m,onError:f=n=>{console.error(n)},initOnMounted:b}=r,g=(u?a.shallowRef:a.ref)('function'==typeof e?e():e),h=(0,a.computed)(()=>(0,a.toValue)(n));if(!t)try{t=Bn('getDefaultStorage',()=>{var n;return null==(n=_n)?void 0:n.localStorage})()}catch(n){f(n)}if(!t)return g;const v=(0,a.toValue)(e),y=Sn(v),k=null!=(o=r.serializer)?o:zn[y],{pause:E,resume:N}=w(g,n=>function(n){try{const e=t.getItem(h.value);if(null==n)B(e,null),t.removeItem(h.value);else{const a=k.write(n);e!==a&&(t.setItem(h.value,a),B(e,a))}}catch(n){f(n)}}(n),{flush:i,deep:c,eventFilter:m});(0,a.watch)(h,()=>S(),{flush:i});let C=!1;const V=n=>{b&&!C||S(n.detail)};function B(n,e){if(p){const a={key:h.value,oldValue:n,newValue:e,storageArea:t};p.dispatchEvent(t instanceof Storage?new StorageEvent('storage',a):new CustomEvent(Dn,{detail:a}))}}function S(n){if(!n||n.storageArea===t)if(n&&null==n.key)g.value=v;else if(!n||n.key===h.value){E();try{const e=k.write(g.value);void 0!==n&&(null==n?void 0:n.newValue)===e||(g.value=function(n){const e=n?n.newValue:t.getItem(h.value);if(null==e)return s&&null!=v&&t.setItem(h.value,k.write(v)),v;if(!n&&d){const n=k.read(e);return'function'==typeof d?d(n,v):'object'!==y||Array.isArray(n)?n:{...v,...n}}return'string'!=typeof e?e:k.read(e)}(n))}catch(n){f(n)}finally{n?(0,a.nextTick)(N):N()}}}return p&&l&&(t instanceof Storage?kn(p,'storage',n=>{b&&!C||S(n)},{passive:!0}):kn(p,Dn,V)),b?function(n,e=!0,t){x(t)?(0,a.onMounted)(n,t):e?n():(0,a.nextTick)(n)}(()=>{C=!0,S()}):S(),g}Number.POSITIVE_INFINITY;const Tn={class:'card'},$n={key:0,class:'content-area'},Mn={key:0,class:'tab-pane active'},jn={key:1,class:'tab-pane active'},Ln=(0,a.defineComponent)({__name:'App',setup(n){const e=[{id:'白娅',label:'角色情报'},{id:'主角',label:'持有物品'}],t=function(n,e,t={}){const{window:a=_n}=t;return An(n,e,null==a?void 0:a.localStorage,t)}('status_bar:active_tab',null);return(n,r)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',Tn,[(0,a.createVNode)(yn),(0,a.createVNode)(Z),(0,a.createVNode)(pn,{modelValue:(0,a.unref)(t),'onUpdate:modelValue':r[0]||(r[0]=n=>(0,a.isRef)(t)?t.value=n:null),tabs:e},null,8,['modelValue']),(0,a.unref)(t)?((0,a.openBlock)(),(0,a.createElementBlock)('div',$n,['白娅'===(0,a.unref)(t)?((0,a.openBlock)(),(0,a.createElementBlock)('div',Mn,[(0,a.createVNode)(U)])):'主角'===(0,a.unref)(t)?((0,a.openBlock)(),(0,a.createElementBlock)('div',jn,[(0,a.createVNode)(ln)])):(0,a.createCommentVNode)('v-if',!0)])):(0,a.createCommentVNode)('v-if',!0)]))}}),In=(0,R.A)(Ln,[['__scopeId','data-v-433deeca']]);$(async()=>{await waitGlobalInitialized('Mvu'),await n(()=>_.has(getVariables({type:'message'}),'stat_data')),(0,a.createApp)(In).use(e()).mount('#app')})})(),(()=>{function n(n){const a=[],r=function(n){const a=`cardhub-entry-${getScriptId()}`,r=$(`#${a}`);if(r.length)return r.addClass('menu_button fa-solid fa-rectangle-list cardhub-entry-button').attr('title','打开 CardHub 角色卡管理器').attr('aria-label','打开 CardHub 角色卡管理器').empty(),null;const o=function(){const n=['#rm_button_bar','#character_panel','#rightNavBar','#right-nav-panel','#character-search','#top-settings-holder'];for(const e of n){const n=$(e).first();if(n.length)return n}const e=$('button, .menu_button, .nav_button').filter((_,n)=>{const e=$(n).text(),t=n.getAttribute('title')??n.getAttribute('aria-label')??'';return/角色管理/.test(e)||/角色管理/.test(t)}).first();if(e.length){const n=e.closest('nav, header, section, div');return n.length?n:e.parent()}return null}();if(!o)return console.warn('[CardHub] 未找到角色管理入口挂载点'),null;const i=t(()=>n.open('role')),c=$('<button>').attr('id',a).attr('type','button').addClass('menu_button fa-solid fa-rectangle-list cardhub-entry-button').attr('title','打开 CardHub 角色卡管理器').attr('aria-label','打开 CardHub 角色卡管理器').on('click pointerup touchend',n=>{n.preventDefault(),n.stopImmediatePropagation(),i()});o.append(c);const l=e(c[0],i);return()=>{c.off('click'),c.remove(),l()}}(n);r&&a.push(r);const o=function(n){const a=`cardhub-magic-${getScriptId()}`,r=$('#extensionsMenuButton');if(!r.length)return console.warn('[CardHub] 未找到左侧魔法棒入口'),null;const o=()=>{const r=$('#extensionsMenu');if(!r||r.find(`#${a}`).length)return;const o=t(()=>n.open('magic')),i=$('<div>').attr('id',a).addClass('list-group-item flex-container flexGap5 interactable cardhub-menu-entry').attr('role','button').attr('tabindex','0').html('<i class="fa-solid fa-id-badge" aria-hidden="true"></i><span>角色卡管理器</span>').on('click pointerup touchend',n=>{n.preventDefault(),n.stopImmediatePropagation(),o()});r.append(i);const c=e(i[0],o);i.data('cardhub-dispose',c)};r.on('click.cardhub',()=>{setTimeout(o,0)});const i=new MutationObserver(()=>o()),c=window.parent?.document??document;return i.observe(c.body,{childList:!0,subtree:!0}),()=>{i.disconnect(),r.off('click.cardhub'),$(`#${a}`).remove()}}(n);return o&&a.push(o),()=>{a.forEach(n=>n())}}function e(n,e){const t=n=>{n.preventDefault(),n.stopImmediatePropagation(),e()};return n.addEventListener('pointerdown',t,{capture:!0}),n.addEventListener('mousedown',t,{capture:!0}),n.addEventListener('touchstart',t,{capture:!0}),()=>{n.removeEventListener('pointerdown',t,{capture:!0}),n.removeEventListener('mousedown',t,{capture:!0}),n.removeEventListener('touchstart',t,{capture:!0})}}function t(n){let e=0;return()=>{const t=Date.now();t-e<250||(e=t,n())}}var a=o(61);async function r(){let n;try{n=window.parent?.SillyTavern}catch{n=void 0}n??=SillyTavern;const e='function'==typeof n?.getContext?n.getContext():null;if('function'==typeof e?.getCharacters)try{await e.getCharacters()}catch(n){console.warn('[CardHub] 读取角色列表失败，将使用缓存数据',n)}const t=e?.characters??SillyTavern?.characters??[],a=new Map,r=new Map,o=new Map;return Array.isArray(e?.tags)&&e.tags.forEach(n=>{n?.id&&n?.name&&o.set(n.id,n.name)}),t.map((n,t)=>{const i=n.tags??n.data?.tags??[],c=n.avatar,l=n.name??'未命名角色',s=n.create_date??n.date_added??n.chat??String(t),d=c??`name:${l}::${s}`;let u=d;if(!c){const n=r.get(d)??0;r.set(d,n+1),n&&(u=`${d}::${n}`)}const p=(e?.tagMap?.[u]??[]).map(n=>o.get(n)).filter(Boolean),m=Array.from(new Set([...i,...p])),f=c?`avatar:${c}`:`name:${l}::${s}`,b=a.get(f)??0;a.set(f,b+1);return{id:b?`${f}::${b}`:f,name:l,avatar:n.avatar??null,tags:m,tagKey:u,origin:'tavern'}})}function i(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(n){const e=16*Math.random()|0;return('x'===n?e:3&e|8).toString(16)})}const c='cardhub_library';function l(){return{type:'script',script_id:getScriptId()}}function s(n){const e=TavernHelper.getVariables(l());TavernHelper.replaceVariables(l(),{...e,[c]:{entries:n}})}function d(n){return new Promise((e,t)=>{const a=new FileReader;a.onload=()=>e(String(a.result||'')),a.onerror=()=>t(a.error),a.readAsDataURL(n)})}function u(n){return new Promise((e,t)=>{const a=new FileReader;a.onload=()=>e(String(a.result||'')),a.onerror=()=>t(a.error),a.readAsText(n)})}function p(n){return n.replace(/\.(png|json)$/i,'')}function m(n){if(null===n||'object'!=typeof n)return JSON.stringify(n);if(Array.isArray(n))return`[${n.map(n=>m(n)).join(',')}]`;return`{${Object.entries(n).sort(([n],[e])=>n.localeCompare(e)).map(([n,e])=>`${JSON.stringify(n)}:${m(e)}`).join(',')}}`}function f(n,e){let t=e;if('json'===n){const n=e.trim();try{t=m(JSON.parse(n))}catch{t=n}}return`${n}:${function(n){let e=5381;for(let t=0;t<n.length;t+=1)e=33*e^n.charCodeAt(t);return(e>>>0).toString(16)}(t)}`}function b(){return function(){const n=TavernHelper.getVariables(l()),e=n?.[c];return e&&'object'==typeof e?{entries:Array.isArray(e.entries)?e.entries:[]}:{entries:[]}}().entries}async function g(n,e){const t=Array.from(n);if(!t.length)return b();const a=Array.isArray(e)&&e.length?e:b(),r=new Set;a.forEach(n=>{const e=function(n){if(n.fingerprint)return n.fingerprint;if(!n.rawType||!n.raw)return null;const e=f(n.rawType,n.raw);return n.fingerprint=e,e}(n);e&&r.add(e)});const o=[];for(const n of t){const e=p(n.name);if(n.name.toLowerCase().endsWith('.png')){const t=await d(n),a=f('png',t);if(r.has(a))continue;r.add(a),o.push({id:i(),name:e,avatar:t,tags:[],origin:'library',rawType:'png',raw:t,fingerprint:a})}else if(n.name.toLowerCase().endsWith('.json')){const t=await u(n);let a=e;try{const n=JSON.parse(t);a=n.name??n.data?.name??a}catch{}const c=f('json',t);if(r.has(c))continue;r.add(c),o.push({id:i(),name:a,avatar:null,tags:[],origin:'library',rawType:'json',raw:t,fingerprint:c})}}const c=[...a,...o];return s(c),c}function h(n){const e=b().filter(e=>e.id!==n);return s(e),e}const v=(0,a.reactive)({open:!1,loading:!1,search:'',lastOpenSource:'manual',characters:[],library:[]});function x(n,e){v.open=n,e&&(v.lastOpenSource=e)}function y(n){v.loading=n}function w(n){v.characters=n}function k(n){v.library=n}function E(){let n;try{n=window.parent?.SillyTavern}catch{n=void 0}return n??=SillyTavern,'function'!=typeof n?.getContext?null:n.getContext()}function N(n){Array.isArray(n.tags)||(n.tags=[]),n.tagMap||(n.tagMap={})}function C(n){if('library'===n.origin)return n.tags??[];const e=n.tags??[],t=function(n){if(!n)return[];const e=E();if(!e||!e.tagMap||!Array.isArray(e.tags))return[];const t=new Map;return e.tags.forEach(n=>{n?.id&&n?.name&&t.set(n.id,n.name)}),(e.tagMap[n]??[]).map(n=>t.get(n)).filter(Boolean)}(n.tagKey??n.avatar);return Array.from(new Set([...e,...t]))}function V(n,e){const t=E();if(!t)return e;const a=function(n,e){if(!Array.isArray(n.characters))return null;const t=e.avatar?n.characters.find(n=>n.avatar===e.avatar):null;return t||(n.characters.find(n=>n.name===e.name)??null)}(t,n);if(!a)return e;const r=Array.from(new Set(e.map(n=>n.trim().replace(/\s+/g,' ')).filter(Boolean)));a.tags=r,a.data&&(a.data.tags=r),N(t);const o=r.map(n=>function(n,e){N(n);const t=n.tags.find(n=>n.name===e);if(t)return t;const a={id:'function'==typeof crypto?.randomUUID?crypto.randomUUID():`tag-${Date.now()}`,name:e};return n.tags.push({id:a.id,name:a.name}),a}(t,n).id),i=n.tagKey??a.avatar??null;return i&&(t.tagMap[i]=o),t.saveSettingsDebounced?.(),r}const B={class:'cardhub-panel',role:'dialog','aria-label':'CardHub 角色卡管理器'},S={class:'cardhub-toolbar'},D={class:'cardhub-body'},A={class:'cardhub-sidebar'},T={class:'cardhub-chip-row'},M={class:'cardhub-tag-filter'},j=['onClick'],L={class:'cardhub-content'},I={key:0,class:'cardhub-loading'},O={key:1,class:'cardhub-empty'},H={key:2,class:'cardhub-grid-wrap'},P={class:'cardhub-pagination'},F={key:0,class:'cardhub-pagination__actions'},R=['disabled'],U=['disabled'],Y={class:'cardhub-pagination__status'},J={class:'cardhub-grid'},q=['onClick'],K={class:'cardhub-card__info'},W={class:'cardhub-card__name'},X={class:'cardhub-card__meta'},G={class:'cardhub-card__tags'},Z=['onClick'],Q=['onClick'],nn=['onKeydown','onBlur'],en={class:'cardhub-card__actions'},tn=['onClick'],an=['onClick'],rn={class:'cardhub-manage__panel',role:'dialog','aria-label':'角色管理'},on={class:'cardhub-manage__top'},cn={class:'cardhub-manage__summary'},ln={class:'cardhub-preview__name'},sn={class:'cardhub-preview__meta'},dn={class:'cardhub-preview__tags'},un={class:'cardhub-manage__overview'},pn={class:'cardhub-manage__overview-label'},mn={class:'cardhub-manage__overview-value'},fn={key:0,class:'cardhub-manage__overview-hint'},bn={class:'cardhub-manage__media'},gn=['src'],hn={class:'cardhub-manage__section'},vn={key:0,class:'cardhub-manage__details'},xn={class:'cardhub-manage__detail-label'},yn={class:'cardhub-manage__detail-content'},_n={key:1,class:'cardhub-manage__empty'},wn={class:'cardhub-manage__section'},kn={class:'cardhub-manage__content'},En={class:'cardhub-manage__section'},Nn={class:'cardhub-manage__label'},Cn={class:'cardhub-manage__jump-row'},Vn={key:0,class:'cardhub-manage__chat'},Bn=['onClick','onKeydown'],Sn={class:'cardhub-manage__chat-main'},zn={class:'cardhub-manage__chat-name'},Dn={key:0,class:'cardhub-manage__chat-label'},An={key:1,class:'cardhub-manage__chat-tags'},Tn={class:'cardhub-manage__chat-text'},$n={key:1,class:'cardhub-manage__empty'},Mn={class:'cardhub-manage__actions'},jn={class:'cardhub-confirm__panel',role:'dialog','aria-modal':'true'},Ln={class:'cardhub-confirm__title'},In={class:'cardhub-confirm__message'},On={class:'cardhub-confirm__actions'},Hn=(0,a.defineComponent)({__name:'App',setup(n){const e=(0,a.ref)([]),t=(0,a.ref)(null),o=(0,a.ref)(''),i=(0,a.ref)('all'),c=(0,a.ref)(24),l=(0,a.ref)(1),d=(0,a.ref)(null),u=(0,a.ref)(null),p=(0,a.ref)([]),m=(0,a.ref)([]),f=(0,a.computed)(()=>{return n=p.value,e=3,n.map(n=>function(n,e){const t=n.replace(/\r/g,'').trim();if(!t)return[];const a=Le(t);if(a.length>=e)return a.slice(0,e);const r=De(t);if(!r)return a.slice(0,e);const o=Ie(r,60);if(!a.length)return o.slice(0,e);const i=[...a];for(const n of o){if(i.length>=e)break;i[0]!==n&&i.push(n)}return i.slice(0,e)}(n,2).join('\n')).filter(n=>n.trim().length>0).slice(0,e);var n,e});let E=0;const N=(0,a.reactive)({open:!1,title:'',message:'',confirmLabel:'确定',cancelLabel:'取消',altLabel:'',resolve:null}),Hn=(0,a.computed)(()=>[...v.characters,...v.library]),Pn=(0,a.ref)(null),Fn=(0,a.ref)(null),Rn=(0,a.ref)(null),Un=(0,a.computed)(()=>{const n=Pn.value;if(!n)return[];const e=[],t=(n,t,a=240)=>{const r=function(n,e,t){const a=n.replace(/\r/g,'').trim();if(!a)return'';const r=Le(a),o=r.length?r:Ie(De(a),60);let i=o.slice(0,e).join('\n').trim();if(!i)return'';const c=i.length>t;c&&(i=i.slice(0,t).trim());const l=c||o.length>e||a.length>i.length;l&&!i.endsWith('…')&&(i=`${i}…`);return i}(t,3,a);r&&e.push({label:n,value:r})};return t('角色描述',n.description??''),t('性格',n.personality??''),t('场景',n.scenario??''),t('创作者备注',n.creatorNotes??''),t('系统提示',n.systemPrompt??'',200),t('历史指令',n.postHistory??'',200),t('作者',n.creator??'',80),e}),Yn=(0,a.computed)(()=>!u.value||Un.value.length?'':'library'===u.value.origin?'未导入卡片暂无可预览内容，可先导入后查看详情。':'暂无角色卡详情。'),Jn=(0,a.computed)(()=>'library'===u.value?.origin?'未导入卡片暂无聊天记录。':'暂无聊天记录。'),qn=(0,a.computed)(()=>{const n=[],e=Pn.value,t=e?.worldBookName?.trim()||'',a=e?.worldBookCount;let r='未绑定',o='';(t||'number'==typeof a)&&(r=t||'角色世界书',o='number'==typeof a?`${a} 条`:''),n.push({label:'世界书',value:r,hint:o});const i=Rn.value;let c='暂无聊天',l='';i&&i.total>0&&(c=`${i.total} 个聊天`,i.latest&&(l=`最近：${i.latest}`)),n.push({label:'聊天概况',value:c,hint:l});const s=Fn.value;let d='暂无开场白',u='';return s&&s.total>0&&(d=`${s.total} 条`,u=s.alternate>0?`替代：${s.alternate} 条`:'无替代'),n.push({label:'开场白',value:d,hint:u}),n}),Kn=(0,a.computed)(()=>{const n=function(n){if('imported'===i.value)return n.filter(n=>'tavern'===n.origin);if('unimported'===i.value)return n.filter(n=>'library'===n.origin);return n}(Hn.value),e=v.search.trim();if(!e)return te(n);const t=function(n){if(!n)return null;try{const e=n.match(/\/(.+)\/([a-z]*)/i);if(!e)return new RegExp(_.escapeRegExp(n),'i');if(e[2]&&!/^(?!.*?(.).*?\1)[gmixXsuUAJ]+$/.test(e[3]))return new RegExp(n,'i');let t=e[2]??'';return _.pull(t,'g'),-1===t.indexOf('i')&&(t+='i'),new RegExp(e[1],t)}catch{return null}}(e)??new RegExp(_.escapeRegExp(e),'i');return te(n).filter(n=>t.test(n.name)||n.tags.some(n=>t.test(n)))}),Wn=(0,a.computed)(()=>{const n=Math.ceil(Kn.value.length/c.value);return n>0?n:1}),Xn=(0,a.computed)(()=>{const n=(l.value-1)*c.value;return Kn.value.slice(n,n+c.value)}),Gn=(0,a.computed)(()=>{const n=new Set;return Hn.value.forEach(e=>{C(e).forEach(e=>n.add(e))}),e.value.forEach(e=>n.add(e)),Array.from(n).sort((n,e)=>n.localeCompare(e,'zh-CN'))});function Zn(n,e=!1){const t=n.avatar;return t?/^(data:|https?:|\/)/.test(t)?t:e&&'tavern'===n.origin?TavernHelper.getCharAvatarPath(t,!0)??`/thumbnail?type=avatar&file=${encodeURIComponent(t)}`:`/thumbnail?type=avatar&file=${encodeURIComponent(t)}`:null}function Qn(n){const e=Zn(n);return e?{backgroundImage:`url(${e})`}:{}}function ne(n){return C(n)}const ee=(0,a.computed)(()=>u.value?Zn(u.value,!0):null);function te(n){return e.value.length?n.filter(n=>e.value.some(e=>C(n).includes(e))):n}function ae(){e.value=[]}function re(){l.value>1&&(l.value-=1)}function oe(){l.value<Wn.value&&(l.value+=1)}function ie(n){return n.trim().toLocaleLowerCase()}function ce(n){return N.open&&N.resolve&&N.resolve('cancel'),N.title=n.title??'确认操作',N.message=n.message,N.confirmLabel=n.confirmLabel??'确定',N.cancelLabel=n.cancelLabel??'取消',N.altLabel=n.altLabel??'',N.open=!0,new Promise(n=>{N.resolve=n})}function le(n){if(!N.open)return;N.open=!1;const e=N.resolve;N.resolve=null,e&&e(n)}function se(n){return n.id}function de(n){if(t.value!==se(n))return;const e=o.value.trim();if(e){pe(n,[...C(n),e])}ue()}function ue(){t.value=null,o.value=''}function pe(n,e){if('library'===n.origin){k(function(n,e){const t=b().map(t=>t.id!==n?t:{...t,tags:e});return s(t),t}(n.id,e))}else{const t=V(n,e);n.tags=t,w([...v.characters])}}function me(){d.value?.click()}async function fe(n){const e=n.target,t=e?.files;if(!t||!t.length)return;k(await g(t,v.library)),e.value=''}async function be(){const n=Kn.value;if(!n.length)return void toastr.warning('当前没有可导出的角色卡');const t=e.value.length?e.value.join('、'):'无',a='all'===i.value?'全部':'imported'===i.value?'已导入':'未导入',r=v.search.trim()||'无',o=`将导出 ${n.length} 张角色卡。\n筛选状态：${a}\n筛选标签：${t}\n搜索关键字：${r}\n是否继续？`;'confirm'===await ce({title:'批量导出',message:o,confirmLabel:'继续导出',cancelLabel:'取消'})&&n.forEach(n=>he(n))}async function ge(n){'library'===n.origin?await async function(n){if(!n.raw||!n.rawType)return void toastr.error('缺少导入数据');const e=function(n){const e=ie(n);return e?v.characters.find(n=>ie(n.name)===e)??null:null}(n.name);if(e)return void toastr.warning(`已存在同名角色「${e.name}」，已跳过导入`);const t=SillyTavern?.getRequestHeaders?SillyTavern.getRequestHeaders():{};if(delete t['Content-Type'],'png'===n.rawType){const e=await Xe(n.raw);await TavernHelper.importRawCharacter(n.name,e)}else{const e=new File([n.raw],`${n.name}.json`,{type:'application/json'}),a=new FormData;a.append('avatar',e),a.append('file_type','json'),a.append('preserved_name',e.name),await fetch('/api/characters/import',{method:'POST',headers:t,body:a,cache:'no-cache'})}k(h(n.id));w(await r()),toastr.success(`已导入 ${n.name}`)}(n):he(n)}async function he(n){if('library'===n.origin)return void await async function(n){if(!n.raw||!n.rawType)return void toastr.error('无法导出：缺少原始数据');if('png'===n.rawType){return void We(await Xe(n.raw),`${n.name}.png`)}const e=new Blob([n.raw],{type:'application/json'});We(e,`${n.name}.json`)}(n);if(!n.avatar)return void toastr.error('无法导出：缺少头像信息');const e=TavernHelper.getCharAvatarPath(n.avatar);if(!e)return void toastr.error('无法导出：缺少头像信息');const t=await fetch(e,{cache:'no-cache'});We(await t.blob(),`${n.name}.png`)}async function ve(n){const e=++E;u.value=n,p.value=[],m.value=[],Pn.value=null,Fn.value=null,Rn.value=null;const[t,a]=await Promise.allSettled([ye(n),Oe(n)]);if(e!==E||u.value?.id!==n.id)return;const r='fulfilled'===t.status?t.value:{openings:[],profile:null,openingSummary:null};p.value=r.openings,Pn.value=r.profile,Fn.value=r.openingSummary;const o='fulfilled'===a.status?a.value:{list:[],summary:null};m.value=o.list,Rn.value=o.summary}function xe(){u.value=null,p.value=[],m.value=[],Pn.value=null,Fn.value=null,Rn.value=null}async function ye(n){if('tavern'!==n.origin){const e=function(n){if(!n.raw||!n.rawType)return null;if('json'===n.rawType)return _e(n.raw);if('png'===n.rawType)return function(n){const e=function(n){const e=n.indexOf(',');if(e<0)return null;const t=n.slice(e+1);try{const n=atob(t),e=new Uint8Array(n.length);for(let t=0;t<n.length;t+=1)e[t]=n.charCodeAt(t);return e}catch{return null}}(n);if(!e)return null;const t=function(n){if(n.length<8)return[];const e=[137,80,78,71,13,10,26,10];for(let t=0;t<e.length;t+=1)if(n[t]!==e[t])return[];const t=[];let a=8;for(;a+8<=n.length;){const e=Ne(n,a),r=Ce(n.subarray(a+4,a+8)),o=a+8,i=o+e;if(i+4>n.length)break;const c=n.subarray(o,i);if('tEXt'===r){const n=we(c);n&&t.push(n)}else if('iTXt'===r){const n=ke(c);n&&t.push(n)}a=i+4}return t}(e),a=new Set(['chara','character','tavern','tavern_character','card']);for(const n of t){if(n.key&&!a.has(n.key.toLowerCase()))continue;const e=Ee(n.value);if(e)return e}return null}(n.raw);return null}(n);return{openings:ze(e),profile:Ve(e),openingSummary:Se(e)}}const e=await async function(n){let e;try{e=window.parent?.SillyTavern}catch{e=void 0}e??=SillyTavern;const t='function'==typeof e?.getContext?e.getContext():null;if(t?.getCharacters)try{await t.getCharacters()}catch(n){console.warn('[CardHub] 刷新角色卡列表失败',n)}const a=t?.characters??e?.characters??[];if(!a.length)return null;const r=n.avatar?a.findIndex(e=>e.avatar===n.avatar||e.name===n.avatar):-1,o=a.findIndex(e=>e.name===n.name),i=r>=0?r:o;if(i<0)return null;if(t?.unshallowCharacter)try{await t.unshallowCharacter(i)}catch(n){console.warn('[CardHub] 读取角色卡详情失败',n)}const c=(t?.characters??a)[i]??null;if(c?.first_mes||c?.data?.first_mes)return c;if(t?.getCharacterCardFields)try{const n=await t.getCharacterCardFields({chid:i});if(n?.first_mes||n?.data?.first_mes)return n}catch(n){console.warn('[CardHub] 读取角色卡字段失败',n)}const l=TavernHelper.getCharData(n.avatar??n.name,!0);return l??c}(n),t=e??TavernHelper.RawCharacter?.find({name:n.avatar??n.name,allowAvatar:!0})??TavernHelper.RawCharacter?.find({name:n.name,allowAvatar:!0}),a=e??t;let r=ze(a);!r.length&&t&&t!==a&&(r=ze(t));const o=Se(a??t);return{openings:r,profile:Ve(a??t),openingSummary:o}}function _e(n){try{return JSON.parse(n)}catch{return null}}function we(n){const e=n.indexOf(0);if(e<0)return null;const t=Ce(n.subarray(0,e)).trim(),a=Ce(n.subarray(e+1)).trim();return t&&a?{key:t,value:a}:null}function ke(n){const e=n.indexOf(0);if(e<0||e+2>=n.length)return null;const t=Ce(n.subarray(0,e)).trim(),a=1===n[e+1];let r=e+2;const o=n.indexOf(0,r);if(o<0)return null;r=o+1;const i=n.indexOf(0,r);if(i<0)return null;if(r=i+1,a)return null;const c=Ce(n.subarray(r)).trim();return t&&c?{key:t,value:c}:null}function Ee(n){const e=n.trim();if(!e)return null;const t=_e(e);if(t)return t;if(!function(n){if(n.length<16||n.length%4!=0)return!1;return/^[A-Za-z0-9+/=]+$/.test(n)}(e))return null;const a=function(n){try{const e=atob(n),t=new Uint8Array(e.length);for(let n=0;n<e.length;n+=1)t[n]=e.charCodeAt(n);return(new TextDecoder).decode(t)}catch{return null}}(e);return a?_e(a):null}function Ne(n,e){return(n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3])>>>0}function Ce(n){return(new TextDecoder).decode(n)}function Ve(n){if(!n)return null;const e={description:Be(n?.description,n?.data?.description),personality:Be(n?.personality,n?.data?.personality),scenario:Be(n?.scenario,n?.data?.scenario),creatorNotes:Be(n?.creatorcomment,n?.data?.creatorcomment,n?.creator_notes,n?.data?.creator_notes),systemPrompt:Be(n?.system_prompt,n?.data?.system_prompt),postHistory:Be(n?.post_history_instructions,n?.data?.post_history_instructions),creator:Be(n?.creator,n?.data?.creator)},t=n?.character_book??n?.data?.character_book;t&&(e.worldBookName=Be(t?.name),e.worldBookCount=Array.isArray(t?.entries)?t.entries.length:void 0);return Boolean(e.description)||Boolean(e.personality)||Boolean(e.scenario)||Boolean(e.creatorNotes)||Boolean(e.systemPrompt)||Boolean(e.postHistory)||Boolean(e.creator)||Boolean(e.worldBookName)||'number'==typeof e.worldBookCount?e:null}function Be(...n){for(const e of n)if('string'==typeof e){const n=e.trim();if(n)return n}return''}function Se(n){if(!n)return null;const e='string'==typeof n?.first_mes?n.first_mes:n?.data?.first_mes,t='string'==typeof e&&e.trim()?1:0,a=n?.alternate_greetings??n?.data?.alternate_greetings??n?.extensions?.alternate_greetings??n?.data?.extensions?.alternate_greetings;let r=0;return Array.isArray(a)?r=a.filter(n=>'string'==typeof n&&n.trim()).length:'string'==typeof a&&a.trim()&&(r=1),{total:t+r,alternate:r}}function ze(n){if(!n)return[];const e=[],t='string'==typeof n?.first_mes?n.first_mes:n?.data?.first_mes;'string'==typeof t&&t.trim()&&e.push(t.trim());const a=n?.alternate_greetings??n?.data?.alternate_greetings??n?.extensions?.alternate_greetings??n?.data?.extensions?.alternate_greetings;return Array.isArray(a)?a.forEach(n=>{'string'==typeof n&&n.trim()&&e.push(n.trim())}):'string'==typeof a&&a.trim()&&e.push(a.trim()),e}function De(n){return n.replace(/<br\s*\/?>/gi,' ').replace(/<[^>]+>/g,' ').replace(/\s+/g,' ').trim()}function Ae(n){if('number'==typeof n&&!Number.isNaN(n)){return new Date(n<1e12?1e3*n:n).toLocaleString('zh-CN',{hour12:!1})}if('string'==typeof n){const e=n.trim();if(e)return e}return''}function Te(n){const e=[n?.last_message_time,n?.last_message_date,n?.update_time,n?.last_modified,n?.create_date,n?.timestamp,n?.time];for(const n of e){const e=Ae(n);if(e)return e}const t=Be(n?.file_name,n?.file_id);return t?t.replace(/\.jsonl$/i,''):''}function $e(n){return Te(n)||'聊天记录'}function Me(n){const e=Be(n?.file_name,n?.file_id);return e?e.replace(/\.jsonl$/i,''):''}function je(n,e=3){const t=De(n);if(!t)return[];const a=new Set,r=new Set(['the','and','you','your','are','this','that','with','have','not','for','from','what','why','when','where','then','into','out','here','there','这个','那个','我们','你们','他们','她们','因为','但是','然后','如果','可以','没有','不是','已经','现在','一个','一些','还有','所以','这种']),o=t.match(/\[[^\]]{2,16}\]/g)??[];for(const n of o){const t=n.slice(1,-1).trim();if(t&&a.add(t),a.size>=e)return Array.from(a).slice(0,e)}const i=t.match(/[\u4e00-\u9fa5]{2,}|[A-Za-z0-9]{3,}/g)??[];for(const n of i){const t=n.toLowerCase();if(!r.has(n)&&!r.has(t)&&(a.add(n),a.size>=e))break}return Array.from(a).slice(0,e)}function Le(n){const e=n.split('\n').map(n=>n.trim()).filter(n=>n.length>0),t=[];for(const n of e)n.startsWith('```')||/^<\/?(html|head|body|meta|title|script|style|!doctype)\b/i.test(n)||t.push(n);return t}function Ie(n,e){const t=[];for(let a=0;a<n.length;a+=e){const r=n.slice(a,a+e).trim();r&&t.push(r)}return t}async function Oe(n){if('tavern'!==n.origin)return{list:[],summary:null};const e=await TavernHelper.getChatHistoryBrief(n.avatar??n.name,!0);if(!Array.isArray(e)||!e.length)return{list:[],summary:{total:0,latest:''}};const t=e.slice(0,3).map(n=>({name:$e(n),label:Me(n),file:String(n?.file_name??n?.file_id??''),mes:De(String(n?.mes??'')).slice(0,120),keywords:je(String(n?.mes??''))})),a=Te(e[0]);return{list:t,summary:{total:e.length,latest:a}}}async function He(){m.value.length?await Fe(m.value[0]):toastr.warning('暂无聊天记录')}async function Pe(){if(await Re({ensureSelected:!0}))try{await triggerSlash('/newchat'),xe(),Ze()}catch(n){console.warn('[CardHub] 新聊天失败',n),toastr.error('无法创建新聊天')}}async function Fe(n){const e=n.file;if(!e)return void toastr.warning('未找到聊天文件');const t=await Re({ensureSelected:!0});if(!t)return;const{ctx:a,st:r}=t,o=Je(e),i=(a&&'function'==typeof a.openCharacterChat?a.openCharacterChat:null)??(r&&'function'==typeof r.openCharacterChat?r.openCharacterChat:null);if(!i)return void toastr.error('无法打开聊天：缺少接口');try{Promise.resolve(i(o)).catch(n=>{console.warn('[CardHub] 打开聊天失败',n)})}catch(n){console.warn('[CardHub] 打开聊天失败',n)}const c=await async function(n,e,t,a){const r=Je(n),o=Date.now();for(;Date.now()-o<a;){if((e?.chatId??t?.chatId)===r)return!0;await new Promise(n=>setTimeout(n,200))}return!1}(o,a,r,6e3);if(c)return xe(),void Ze();toastr.warning('未能打开聊天，可能需要先手动切到该角色')}async function Re(n={}){let e;try{e=window.parent?.SillyTavern}catch{e=void 0}e??=SillyTavern;const t='function'==typeof e?.getContext?e.getContext():null;if('function'==typeof t?.getCharacters)try{await t.getCharacters()}catch(n){console.warn('[CardHub] 刷新角色列表失败',n)}const a=t?.characters??e?.characters??[],r=u.value&&Array.isArray(a)?function(n,e){if(e.avatar){const t=n.findIndex(n=>n.avatar===e.avatar||n.name===e.avatar);if(t>=0)return t}return n.findIndex(n=>n.name===e.name)}(a,u.value):-1;if(r<0)return toastr.warning('未找到角色索引，请先手动切到该角色后再试'),null;const o=(t&&'function'==typeof t.selectCharacterById?t.selectCharacterById:null)??(e&&'function'==typeof e.selectCharacterById?e.selectCharacterById:null);if(!o)return toastr.warning('无法切换角色，请先手动切到该角色后再试'),null;try{await o(r,{switchMenu:!1})}catch(n){console.warn('[CardHub] 切换角色失败',n)}const i=await async function(n,e,t,a){const r=String(n),o=Date.now();for(;Date.now()-o<a;){if(Ue(e,t)===r)return!0;await Ye(80)}return!1}(r,t,e,3e3);return n.ensureSelected&&!i?(toastr.warning('角色切换未完成，请稍后再试'),null):{ctx:t,st:e,idx:r}}function Ue(n,e){const t=n?.characterId??e?.characterId??'';return null==t?'':String(t)}function Ye(n){return new Promise(e=>setTimeout(e,n))}function Je(n){return n.endsWith('.jsonl')?n:`${n}.jsonl`}async function qe(n){if('library'===n.origin){if('confirm'!==await ce({title:'删除角色',message:`确认永久删除「${n.name}」？此操作不可恢复。`,confirmLabel:'删除',cancelLabel:'取消'}))return;return k(h(n.id)),void xe()}if('confirm'!==await ce({title:'删除角色',message:`确定要删除「${n.name}」吗？`,confirmLabel:'继续',cancelLabel:'取消'}))return;const e=await ce({title:'删除方式',message:`删除「${n.name}」：\n- 移到私有库：可在私有库中找回\n- 永久删除：不可恢复`,confirmLabel:'移到私有库',altLabel:'永久删除',cancelLabel:'取消'});if('cancel'===e)return;if('confirm'===e){await async function(n){if(!n.avatar)return;const e=TavernHelper.getCharAvatarPath(n.avatar);if(!e)return void toastr.error('无法导出：缺少头像信息');const t=await fetch(e,{cache:'no-cache'}),a=await t.blob(),r=await g([new File([a],`${n.name}.png`,{type:'image/png'})]);k(r)}(n);if(!await Ke(n,!1))return;xe();return void w(await r())}if('confirm'!==await ce({title:'永久删除',message:`确认永久删除「${n.name}」？此操作不可恢复。`,confirmLabel:'永久删除',cancelLabel:'取消'}))return;if(!await Ke(n,!0))return;xe();w(await r())}async function Ke(n,e){if(!n.avatar)return toastr.error('删除失败：缺少头像信息'),!1;let t;try{t=window.parent?.SillyTavern}catch{t=void 0}t??=SillyTavern;const a='function'==typeof t?.getContext?t.getContext():null,r=a?.getRequestHeaders?a.getRequestHeaders():t?.getRequestHeaders?.();if(!r||!Object.keys(r).length)return toastr.error('删除失败：无法获取请求头'),!1;const o={avatar_url:n.avatar,delete_chats:e},i=await fetch('/api/characters/delete',{method:'POST',headers:{...r,'Content-Type':'application/json'},body:JSON.stringify(o),cache:'no-cache'});if(i.ok)return!0;const c=await i.text();return toastr.error(`删除失败：${i.status} ${c||i.statusText}`),!1}function We(n,e){const t=URL.createObjectURL(n),a=document.createElement('a');a.href=t,a.download=e,document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(t)}async function Xe(n){const e=await fetch(n);return await e.blob()}async function Ge(){y(!0);try{w(await r()),k(b())}finally{y(!1)}}function Ze(){x(!1)}return(0,a.watch)([()=>v.search,i,()=>e.value.join('|')],()=>{l.value=1}),(0,a.watch)([Kn,Wn],()=>{l.value>Wn.value&&(l.value=Wn.value),l.value<1&&(l.value=1)}),(n,r)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{class:(0,a.normalizeClass)(['cardhub-root',{open:(0,a.unref)(v).open}])},[(0,a.createElementVNode)('div',{class:'cardhub-backdrop',onClick:Ze}),(0,a.createElementVNode)('section',B,[(0,a.createElementVNode)('header',{class:'cardhub-header'},[r[33]||(r[33]=(0,a.createElementVNode)('div',{class:'cardhub-title'},[(0,a.createElementVNode)('span',{class:'cardhub-title__main'},'CardHub'),(0,a.createElementVNode)('span',{class:'cardhub-title__sub'},'角色卡管理器')],-1)),(0,a.createElementVNode)('div',{class:'cardhub-actions'},[(0,a.createElementVNode)('button',{class:'cardhub-close',type:'button','aria-label':'关闭',onClick:Ze},[...r[32]||(r[32]=[(0,a.createElementVNode)('span',{'aria-hidden':'true'},'×',-1)])])])]),(0,a.createElementVNode)('div',S,[(0,a.withDirectives)((0,a.createElementVNode)('input',{'onUpdate:modelValue':r[0]||(r[0]=n=>(0,a.unref)(v).search=n),class:'cardhub-search',type:'search',placeholder:'搜索角色名或标签'},null,512),[[a.vModelText,(0,a.unref)(v).search]]),(0,a.createElementVNode)('button',{class:'cardhub-button',type:'button',onClick:Ge},'刷新'),(0,a.createElementVNode)('button',{class:'cardhub-button is-ghost',type:'button',onClick:me},'导入'),(0,a.createElementVNode)('button',{class:'cardhub-button is-ghost',type:'button',onClick:be},'批量导出'),(0,a.createElementVNode)('input',{ref_key:'importInput',ref:d,class:'cardhub-import-input',type:'file',accept:'.png,.json',multiple:'',onChange:fe},null,544)]),(0,a.createElementVNode)('div',D,[(0,a.createElementVNode)('div',A,[r[34]||(r[34]=(0,a.createElementVNode)('div',{class:'cardhub-section-title'},'分类',-1)),(0,a.createElementVNode)('div',T,[(0,a.createElementVNode)('button',{class:(0,a.normalizeClass)(['cardhub-chip',{'is-active':'all'===i.value}]),type:'button',onClick:r[1]||(r[1]=n=>i.value='all')},' 全部 ',2),(0,a.createElementVNode)('button',{class:(0,a.normalizeClass)(['cardhub-chip',{'is-active':'imported'===i.value}]),type:'button',onClick:r[2]||(r[2]=n=>i.value='imported')},' 已导入 ',2),(0,a.createElementVNode)('button',{class:(0,a.normalizeClass)(['cardhub-chip',{'is-active':'unimported'===i.value}]),type:'button',onClick:r[3]||(r[3]=n=>i.value='unimported')},' 未导入 ',2)]),r[35]||(r[35]=(0,a.createElementVNode)('div',{class:'cardhub-divider'},null,-1)),r[36]||(r[36]=(0,a.createElementVNode)('div',{class:'cardhub-section-title'},'标签',-1)),(0,a.createElementVNode)('div',M,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Gn.value,n=>((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:n,class:(0,a.normalizeClass)(['cardhub-tag-filter__chip',{'is-active':e.value.includes(n)}]),type:'button',onClick:t=>function(n){e.value.includes(n)?e.value=e.value.filter(e=>e!==n):e.value=[...e.value,n]}(n)},(0,a.toDisplayString)(n),11,j))),128))]),e.value.length?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'cardhub-chip cardhub-chip--clear',type:'button',onClick:ae},' 清空标签 ')):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('div',L,[(0,a.unref)(v).loading?((0,a.openBlock)(),(0,a.createElementBlock)('div',I,'正在读取角色卡...')):Kn.value.length?((0,a.openBlock)(),(0,a.createElementBlock)('div',H,[(0,a.createElementVNode)('div',P,[Wn.value>1?((0,a.openBlock)(),(0,a.createElementBlock)('div',F,[(0,a.createElementVNode)('button',{class:'cardhub-pagination__button',type:'button',disabled:l.value<=1,onClick:re},' 上一页 ',8,R),(0,a.createElementVNode)('button',{class:'cardhub-pagination__button',type:'button',disabled:l.value>=Wn.value,onClick:oe},' 下一页 ',8,U)])):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('span',Y,'第 '+(0,a.toDisplayString)(l.value)+' / '+(0,a.toDisplayString)(Wn.value)+' 页',1)]),(0,a.createElementVNode)('div',J,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Xn.value,n=>((0,a.openBlock)(),(0,a.createElementBlock)('article',{key:n.id,class:'cardhub-card',onClick:e=>ve(n)},[(0,a.createElementVNode)('div',{class:(0,a.normalizeClass)(['cardhub-card__avatar',{'has-avatar':Boolean(Zn(n))}]),style:(0,a.normalizeStyle)(Qn(n))},[(0,a.createElementVNode)('span',null,(0,a.toDisplayString)(n.name.slice(0,1)||'?'),1)],6),(0,a.createElementVNode)('div',K,[(0,a.createElementVNode)('div',W,(0,a.toDisplayString)(n.name),1),(0,a.createElementVNode)('div',X,[(0,a.createElementVNode)('span',null,(0,a.toDisplayString)('tavern'===n.origin?'已导入':'未导入'),1),(0,a.createElementVNode)('span',null,(0,a.toDisplayString)(ne(n).length)+' 标签',1)]),(0,a.createElementVNode)('div',G,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(ne(n),e=>((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:e,class:'cardhub-tag',type:'button',title:'点击移除标签',onClick:(0,a.withModifiers)(t=>function(n,e){pe(n,C(n).filter(n=>n!==e))}(n,e),['stop'])},[(0,a.createTextVNode)((0,a.toDisplayString)(e)+' ',1),r[37]||(r[37]=(0,a.createElementVNode)('span',{class:'cardhub-tag__remove'},'×',-1))],8,Z))),128)),t.value!==se(n)?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'cardhub-tag is-add',type:'button',onClick:(0,a.withModifiers)(e=>function(n){t.value=se(n),o.value='',(0,a.nextTick)(()=>{const n=document.querySelector('.cardhub-tag-input');n?.focus()})}(n),['stop'])},' + 标签 ',8,Q)):(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createElementBlock)('input',{key:1,'onUpdate:modelValue':r[4]||(r[4]=n=>o.value=n),class:'cardhub-tag-input',type:'text',placeholder:'新标签',onKeydown:[(0,a.withKeys)((0,a.withModifiers)(e=>de(n),['prevent']),['enter']),(0,a.withKeys)((0,a.withModifiers)(ue,['prevent']),['esc'])],onBlur:e=>de(n),onClick:r[5]||(r[5]=(0,a.withModifiers)(()=>{},['stop'])),onMousedown:r[6]||(r[6]=(0,a.withModifiers)(()=>{},['stop'])),onTouchstart:r[7]||(r[7]=(0,a.withModifiers)(()=>{},['stop']))},null,40,nn)),[[a.vModelText,o.value]])])]),(0,a.createElementVNode)('div',en,[(0,a.createElementVNode)('button',{class:'cardhub-card__action is-secondary',type:'button',onClick:(0,a.withModifiers)(e=>ge(n),['stop']),onPointerdown:r[8]||(r[8]=(0,a.withModifiers)(()=>{},['stop'])),onMousedown:r[9]||(r[9]=(0,a.withModifiers)(()=>{},['stop'])),onTouchstart:r[10]||(r[10]=(0,a.withModifiers)(()=>{},['stop']))},(0,a.toDisplayString)('tavern'===n.origin?'导出':'导入'),41,tn),(0,a.createElementVNode)('button',{class:'cardhub-card__action',type:'button',onClick:(0,a.withModifiers)(e=>ve(n),['stop']),onPointerdown:r[11]||(r[11]=(0,a.withModifiers)(()=>{},['stop'])),onMousedown:r[12]||(r[12]=(0,a.withModifiers)(()=>{},['stop'])),onTouchstart:r[13]||(r[13]=(0,a.withModifiers)(()=>{},['stop']))},' 管理 ',40,an)])],8,q))),128))])])):((0,a.openBlock)(),(0,a.createElementBlock)('div',O,' 暂无角色卡，或没有匹配的搜索结果。 '))])])]),u.value?((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:0,class:'cardhub-manage',onClick:(0,a.withModifiers)(xe,['self'])},[(0,a.createElementVNode)('div',rn,[(0,a.createElementVNode)('button',{class:'cardhub-preview__close',type:'button',onClick:xe},'×'),(0,a.createElementVNode)('div',on,[(0,a.createElementVNode)('div',cn,[(0,a.createElementVNode)('div',ln,(0,a.toDisplayString)(u.value.name),1),(0,a.createElementVNode)('div',sn,[(0,a.createElementVNode)('span',null,(0,a.toDisplayString)('tavern'===u.value.origin?'已导入':'未导入'),1),(0,a.createElementVNode)('span',null,(0,a.toDisplayString)(ne(u.value).length)+' 标签',1)]),(0,a.createElementVNode)('div',dn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(ne(u.value),n=>((0,a.openBlock)(),(0,a.createElementBlock)('span',{key:n,class:'cardhub-preview__tag'},(0,a.toDisplayString)(n),1))),128))]),(0,a.createElementVNode)('div',un,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(qn.value,n=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n.label,class:'cardhub-manage__overview-card'},[(0,a.createElementVNode)('div',pn,(0,a.toDisplayString)(n.label),1),(0,a.createElementVNode)('div',mn,(0,a.toDisplayString)(n.value),1),n.hint?((0,a.openBlock)(),(0,a.createElementBlock)('div',fn,(0,a.toDisplayString)(n.hint),1)):(0,a.createCommentVNode)('v-if',!0)]))),128))])]),(0,a.createElementVNode)('div',bn,[ee.value?((0,a.openBlock)(),(0,a.createElementBlock)('img',{key:0,src:ee.value,alt:''},null,8,gn)):(0,a.createCommentVNode)('v-if',!0)])]),(0,a.createElementVNode)('div',hn,[r[38]||(r[38]=(0,a.createElementVNode)('div',{class:'cardhub-manage__label'},'角色卡预览',-1)),Un.value.length?((0,a.openBlock)(),(0,a.createElementBlock)('div',vn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Un.value,n=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:n.label,class:'cardhub-manage__detail'},[(0,a.createElementVNode)('div',xn,(0,a.toDisplayString)(n.label),1),(0,a.createElementVNode)('div',yn,(0,a.toDisplayString)(n.value),1)]))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)('div',_n,(0,a.toDisplayString)(Yn.value),1))]),(0,a.createElementVNode)('div',wn,[r[39]||(r[39]=(0,a.createElementVNode)('div',{class:'cardhub-manage__label'},'开场白',-1)),(0,a.createElementVNode)('div',kn,[f.value.length?((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,{key:0},(0,a.renderList)(f.value,(n,e)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e,class:'cardhub-manage__opening'},(0,a.toDisplayString)(n),1))),128)):((0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,{key:1},[(0,a.createTextVNode)('暂无开场白')],64))])]),(0,a.createElementVNode)('div',En,[(0,a.createElementVNode)('div',Nn,[r[40]||(r[40]=(0,a.createElementVNode)('span',null,'最近聊天',-1)),(0,a.createElementVNode)('div',Cn,[(0,a.createElementVNode)('button',{class:'cardhub-manage__btn is-primary',type:'button',onClick:He,onPointerdown:r[14]||(r[14]=(0,a.withModifiers)(()=>{},['stop'])),onMousedown:r[15]||(r[15]=(0,a.withModifiers)(()=>{},['stop'])),onTouchstart:r[16]||(r[16]=(0,a.withModifiers)(()=>{},['stop']))},' 进入最近聊天 ',32),(0,a.createElementVNode)('button',{class:'cardhub-manage__btn is-secondary',type:'button',onClick:Pe,onPointerdown:r[17]||(r[17]=(0,a.withModifiers)(()=>{},['stop'])),onMousedown:r[18]||(r[18]=(0,a.withModifiers)(()=>{},['stop'])),onTouchstart:r[19]||(r[19]=(0,a.withModifiers)(()=>{},['stop']))},' 新聊天 ',32)])]),m.value.length?((0,a.openBlock)(),(0,a.createElementBlock)('div',Vn,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(m.value,(n,e)=>((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:e,class:'cardhub-manage__chat-row',role:'button',tabindex:'0',onClick:e=>Fe(n),onKeydown:(0,a.withKeys)((0,a.withModifiers)(e=>Fe(n),['prevent']),['enter'])},[(0,a.createElementVNode)('div',Sn,[(0,a.createElementVNode)('div',zn,(0,a.toDisplayString)(n.name),1),n.label&&n.label!==n.name?((0,a.openBlock)(),(0,a.createElementBlock)('div',Dn,(0,a.toDisplayString)(n.label),1)):(0,a.createCommentVNode)('v-if',!0),n.keywords.length?((0,a.openBlock)(),(0,a.createElementBlock)('div',An,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(n.keywords,n=>((0,a.openBlock)(),(0,a.createElementBlock)('span',{key:n,class:'cardhub-manage__chat-tag'},(0,a.toDisplayString)(n),1))),128))])):(0,a.createCommentVNode)('v-if',!0)]),(0,a.createElementVNode)('span',Tn,(0,a.toDisplayString)(n.mes),1)],40,Bn))),128))])):((0,a.openBlock)(),(0,a.createElementBlock)('div',$n,(0,a.toDisplayString)(Jn.value),1))]),(0,a.createElementVNode)('div',Mn,[(0,a.createElementVNode)('button',{class:'cardhub-manage__btn is-secondary',type:'button',onClick:r[20]||(r[20]=(0,a.withModifiers)(n=>ge(u.value),['stop'])),onPointerdown:r[21]||(r[21]=(0,a.withModifiers)(()=>{},['stop'])),onMousedown:r[22]||(r[22]=(0,a.withModifiers)(()=>{},['stop'])),onTouchstart:r[23]||(r[23]=(0,a.withModifiers)(()=>{},['stop']))},(0,a.toDisplayString)('tavern'===u.value.origin?'导出':'导入'),33),(0,a.createElementVNode)('button',{class:'cardhub-manage__btn is-primary',type:'button',onClick:r[24]||(r[24]=(0,a.withModifiers)(n=>qe(u.value),['stop'])),onPointerdown:r[25]||(r[25]=(0,a.withModifiers)(()=>{},['stop'])),onMousedown:r[26]||(r[26]=(0,a.withModifiers)(()=>{},['stop'])),onTouchstart:r[27]||(r[27]=(0,a.withModifiers)(()=>{},['stop']))},' 删除 ',32)])])])):(0,a.createCommentVNode)('v-if',!0),N.open?((0,a.openBlock)(),(0,a.createElementBlock)('div',{key:1,class:'cardhub-confirm',onClick:r[31]||(r[31]=(0,a.withModifiers)(n=>le('cancel'),['self']))},[(0,a.createElementVNode)('div',jn,[(0,a.createElementVNode)('div',Ln,(0,a.toDisplayString)(N.title),1),(0,a.createElementVNode)('div',In,(0,a.toDisplayString)(N.message),1),(0,a.createElementVNode)('div',On,[(0,a.createElementVNode)('button',{class:'cardhub-confirm__button is-cancel',type:'button',onClick:r[28]||(r[28]=n=>le('cancel'))},(0,a.toDisplayString)(N.cancelLabel),1),N.altLabel?((0,a.openBlock)(),(0,a.createElementBlock)('button',{key:0,class:'cardhub-confirm__button is-danger',type:'button',onClick:r[29]||(r[29]=n=>le('alt'))},(0,a.toDisplayString)(N.altLabel),1)):(0,a.createCommentVNode)('v-if',!0),(0,a.createElementVNode)('button',{class:'cardhub-confirm__button is-confirm',type:'button',onClick:r[30]||(r[30]=n=>le('confirm'))},(0,a.toDisplayString)(N.confirmLabel),1)])])])):(0,a.createCommentVNode)('v-if',!0)],2))}});const Pn=(0,o(502).A)(Hn,[['__scopeId','data-v-fe13b558']]);let Fn=null,Rn=null,Un=null;function Yn(){Rn||(Un=$('<style>').attr('data-cardhub-style',getScriptId()).text('\n      .cardhub-root {\n        position: fixed;\n        inset: 0;\n        z-index: 9999;\n        font-family: "ZCOOL XiaoWei", "STSong", "Songti SC", "SimSun", serif;\n        color: #1b1b1b;\n        display: none;\n        align-items: center;\n        justify-content: center;\n      }\n\n      .cardhub-root.open {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n\n      .cardhub-backdrop {\n        position: absolute;\n        inset: 0;\n        background: rgba(0, 0, 0, 0.4);\n        backdrop-filter: blur(6px);\n        opacity: 0;\n        transition: opacity 180ms ease;\n      }\n\n      .cardhub-root.open .cardhub-backdrop {\n        opacity: 1;\n      }\n\n      .cardhub-panel {\n        position: relative;\n        width: min(980px, 94%);\n        max-height: 92%;\n        background: linear-gradient(160deg, #fff9f0, #f3e4d4);\n        border-radius: 28px;\n        box-shadow: 0 30px 90px rgba(0, 0, 0, 0.28);\n        display: flex;\n        flex-direction: column;\n        overflow: hidden;\n        z-index: 1;\n        opacity: 0;\n        transform: translateY(8px) scale(0.985);\n        transition: opacity 180ms ease, transform 180ms ease;\n      }\n\n      .cardhub-root.open .cardhub-panel {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n      }\n\n      .cardhub-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 20px 24px;\n        border-bottom: 1px solid rgba(86, 59, 44, 0.15);\n      }\n\n      .cardhub-title__main {\n        font-size: 26px;\n        letter-spacing: 2px;\n      }\n\n      .cardhub-title__sub {\n        font-size: 12px;\n        color: #7d5b46;\n        margin-left: 10px;\n      }\n\n      .cardhub-actions {\n        display: flex;\n        gap: 10px;\n      }\n\n      .cardhub-close {\n        border: none;\n        background: rgba(43, 32, 24, 0.12);\n        color: #3b2a20;\n        width: 34px;\n        height: 34px;\n        border-radius: 999px;\n        font-size: 20px;\n        line-height: 34px;\n        text-align: center;\n        cursor: pointer;\n        transition: background-color 160ms ease, transform 120ms ease;\n      }\n\n      .cardhub-close:hover {\n        background: rgba(43, 32, 24, 0.2);\n      }\n\n      .cardhub-close:active {\n        transform: scale(0.96);\n      }\n\n      .cardhub-toolbar {\n        display: flex;\n        gap: 8px;\n        padding: 12px 20px;\n        flex-wrap: wrap;\n      }\n\n      .cardhub-search {\n        flex: 1;\n        min-width: 180px;\n        border-radius: 999px;\n        border: 1px solid rgba(86, 59, 44, 0.2);\n        padding: 6px 12px;\n        background: #fffaf4;\n      }\n\n      .cardhub-button {\n        border: none;\n        padding: 6px 14px;\n        border-radius: 999px;\n        background: #d46b3d;\n        color: #fff;\n        cursor: pointer;\n        font-size: 12px;\n        transition: background-color 160ms ease, transform 120ms ease, box-shadow 160ms ease;\n      }\n\n      .cardhub-button:hover {\n        background: #c55f36;\n        box-shadow: 0 6px 14px rgba(43, 32, 24, 0.18);\n      }\n\n      .cardhub-button:active {\n        transform: translateY(1px);\n      }\n\n      .cardhub-button.is-ghost {\n        background: transparent;\n        color: #6a3f2a;\n        border: 1px solid rgba(106, 63, 42, 0.4);\n      }\n\n      .cardhub-button.is-ghost:hover {\n        background: rgba(106, 63, 42, 0.08);\n        border-color: rgba(106, 63, 42, 0.6);\n        box-shadow: none;\n      }\n\n      .cardhub-import-input {\n        display: none;\n      }\n\n      .cardhub-body {\n        display: grid;\n        grid-template-columns: minmax(160px, 220px) 1fr;\n        gap: 0;\n        flex: 1;\n        min-height: 0;\n      }\n\n      .cardhub-sidebar {\n        padding: 20px;\n        border-right: 1px solid rgba(86, 59, 44, 0.15);\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n      }\n\n      .cardhub-chip-row {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 8px;\n      }\n\n      .cardhub-divider {\n        height: 1px;\n        width: 100%;\n        background: rgba(86, 59, 44, 0.15);\n        margin: 8px 0;\n      }\n\n      .cardhub-section-title {\n        font-size: 12px;\n        color: #7d5b46;\n        text-transform: uppercase;\n        letter-spacing: 1px;\n      }\n\n      .cardhub-chip {\n        text-align: left;\n        border: none;\n        background: rgba(255, 255, 255, 0.6);\n        border-radius: 12px;\n        padding: 8px 10px;\n        cursor: pointer;\n        font-size: 12px;\n        transition: background-color 160ms ease, color 160ms ease, transform 120ms ease;\n      }\n\n      .cardhub-chip.is-active {\n        background: #2b2018;\n        color: #fff5ea;\n      }\n\n      .cardhub-chip:not(.is-active):hover {\n        background: rgba(255, 255, 255, 0.9);\n        transform: translateY(-1px);\n      }\n\n      .cardhub-placeholder {\n        font-size: 12px;\n        color: #9a7a63;\n      }\n\n      .cardhub-tag-filter {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 8px;\n      }\n\n      .cardhub-tag-filter__chip {\n        border: 1px solid rgba(106, 63, 42, 0.25);\n        background: rgba(255, 255, 255, 0.7);\n        border-radius: 999px;\n        padding: 6px 10px;\n        font-size: 12px;\n        color: #6a3f2a;\n        cursor: pointer;\n        transition: background-color 160ms ease, color 160ms ease, border-color 160ms ease, transform 120ms ease;\n      }\n\n      .cardhub-tag-filter__chip.is-active {\n        background: #2b2018;\n        color: #fff5ea;\n        border-color: transparent;\n      }\n\n      .cardhub-tag-filter__chip:not(.is-active):hover {\n        border-color: rgba(106, 63, 42, 0.45);\n        background: rgba(255, 255, 255, 0.9);\n        transform: translateY(-1px);\n      }\n\n      .cardhub-chip--clear {\n        margin-top: 8px;\n      }\n\n      .cardhub-content {\n        padding: 20px;\n        overflow: auto;\n        flex: 1;\n        min-height: 0;\n      }\n\n      .cardhub-grid-wrap {\n        display: grid;\n        gap: 12px;\n      }\n\n      .cardhub-pagination {\n        display: flex;\n        align-items: center;\n        justify-content: flex-end;\n        gap: 10px;\n        flex-wrap: wrap;\n      }\n\n      .cardhub-pagination__status {\n        font-size: 12px;\n        color: #7d5b46;\n      }\n\n      .cardhub-pagination__actions {\n        display: flex;\n        gap: 8px;\n        align-items: center;\n        margin-right: auto;\n      }\n\n      .cardhub-pagination__button {\n        border: 1px solid rgba(106, 63, 42, 0.35);\n        background: rgba(255, 255, 255, 0.85);\n        color: #6a3f2a;\n        border-radius: 999px;\n        padding: 4px 10px;\n        font-size: 11px;\n        cursor: pointer;\n        transition: background-color 160ms ease, border-color 160ms ease, transform 120ms ease;\n      }\n\n      .cardhub-pagination__button:disabled {\n        opacity: 0.4;\n        cursor: default;\n      }\n\n      .cardhub-pagination__button:not(:disabled):hover {\n        background: rgba(255, 255, 255, 1);\n        border-color: rgba(106, 63, 42, 0.6);\n        transform: translateY(-1px);\n      }\n\n      .cardhub-pagination__button:not(:disabled):active {\n        transform: translateY(0);\n      }\n\n      .cardhub-loading,\n      .cardhub-empty {\n        padding: 40px 0;\n        text-align: center;\n        color: #7d5b46;\n      }\n\n      .cardhub-grid {\n        display: grid;\n        gap: 14px;\n        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n        justify-items: center;\n      }\n\n      .cardhub-card {\n        background: rgba(255, 255, 255, 0.78);\n        border-radius: 18px;\n        padding: 14px;\n        display: grid;\n        grid-template-columns: auto 1fr;\n        gap: 12px;\n        align-items: center;\n        border: 1px solid rgba(86, 59, 44, 0.15);\n        cursor: pointer;\n        transition: transform 140ms ease, box-shadow 180ms ease, border-color 180ms ease;\n        width: 100%;\n        max-width: 260px;\n      }\n\n      .cardhub-card:hover {\n        transform: translateY(-2px);\n        border-color: rgba(86, 59, 44, 0.25);\n        box-shadow: 0 12px 26px rgba(43, 32, 24, 0.16);\n      }\n\n      .cardhub-card:active {\n        transform: translateY(0);\n      }\n\n      .cardhub-card__avatar {\n        width: 42px;\n        height: 42px;\n        border-radius: 12px;\n        background: linear-gradient(135deg, #f4d7c4, #d36a3b);\n        background-size: cover;\n        background-position: center;\n        color: #4a2a1f;\n        display: grid;\n        place-items: center;\n        font-weight: 700;\n      }\n\n      .cardhub-card__avatar.has-avatar span {\n        display: none;\n      }\n\n      .cardhub-card__name {\n        font-size: 14px;\n        font-weight: 600;\n      }\n\n      .cardhub-card__meta {\n        display: flex;\n        gap: 8px;\n        font-size: 11px;\n        color: #7d5b46;\n      }\n\n      .cardhub-card__tags {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 6px;\n        margin-top: 8px;\n        align-items: center;\n      }\n\n      .cardhub-tag {\n        border: 1px solid rgba(106, 63, 42, 0.3);\n        background: #fff6ea;\n        border-radius: 999px;\n        padding: 4px 8px;\n        font-size: 11px;\n        color: #6a3f2a;\n        cursor: pointer;\n        transition: background-color 160ms ease, border-color 160ms ease, transform 120ms ease;\n      }\n\n      .cardhub-tag:hover {\n        background: #fffaf4;\n        border-color: rgba(106, 63, 42, 0.5);\n        transform: translateY(-1px);\n      }\n\n      .cardhub-tag__remove {\n        margin-left: 4px;\n        font-weight: 700;\n      }\n\n      .cardhub-tag.is-add {\n        background: transparent;\n        border-style: dashed;\n      }\n\n      .cardhub-tag-input {\n        border: 1px dashed rgba(106, 63, 42, 0.5);\n        background: #fffaf4;\n        border-radius: 999px;\n        padding: 4px 10px;\n        font-size: 11px;\n        min-width: 80px;\n        color: #6a3f2a;\n        outline: none;\n        height: 24px;\n        line-height: 16px;\n      }\n\n      .cardhub-tag-input:focus {\n        border-color: rgba(106, 63, 42, 0.85);\n      }\n\n      .cardhub-card__action {\n        grid-column: span 2;\n        margin-top: 10px;\n        border: none;\n        background: #2b2018;\n        color: #fff5ea;\n        padding: 6px 12px;\n        border-radius: 12px;\n        font-size: 12px;\n        cursor: pointer;\n        transition: transform 120ms ease, box-shadow 160ms ease, background-color 160ms ease;\n      }\n\n      .cardhub-card__actions {\n        grid-column: span 2;\n        display: grid;\n        grid-template-columns: 1fr 1fr;\n        gap: 8px;\n        margin-top: 10px;\n      }\n\n      .cardhub-card__action.is-secondary {\n        background: #d9c6b6;\n        color: #3b2a20;\n      }\n\n      .cardhub-card__action:hover {\n        transform: translateY(-1px);\n        box-shadow: 0 6px 14px rgba(43, 32, 24, 0.15);\n      }\n\n      .cardhub-card__action:active {\n        transform: translateY(0);\n      }\n\n      .cardhub-preview {\n        position: fixed;\n        inset: 0;\n        background: rgba(24, 16, 10, 0.45);\n        backdrop-filter: blur(6px);\n        display: grid;\n        place-items: center;\n        z-index: 100000;\n      }\n\n      .cardhub-preview__panel {\n        width: min(520px, 92vw);\n        background: #fff6ea;\n        border-radius: 26px;\n        box-shadow: 0 26px 70px rgba(0, 0, 0, 0.25);\n        padding: 20px;\n        position: relative;\n        display: grid;\n        gap: 14px;\n      }\n\n      .cardhub-preview__close {\n        position: absolute;\n        top: 14px;\n        right: 14px;\n        border: none;\n        width: 30px;\n        height: 30px;\n        border-radius: 999px;\n        background: rgba(43, 32, 24, 0.15);\n        color: #3b2a20;\n        font-size: 18px;\n        cursor: pointer;\n        transition: background-color 160ms ease, transform 120ms ease;\n      }\n\n      .cardhub-preview__close:hover {\n        background: rgba(43, 32, 24, 0.25);\n      }\n\n      .cardhub-preview__close:active {\n        transform: scale(0.96);\n      }\n\n      .cardhub-preview__avatar {\n        width: 100%;\n        height: 260px;\n        border-radius: 18px;\n        background: #ead7c4;\n        display: grid;\n        place-items: center;\n        overflow: hidden;\n      }\n\n      .cardhub-preview__avatar img {\n        width: 100%;\n        height: 100%;\n        object-fit: contain;\n      }\n\n      .cardhub-preview__info {\n        display: grid;\n        gap: 6px;\n      }\n\n      .cardhub-preview__name {\n        font-size: 20px;\n        font-weight: 700;\n      }\n\n      .cardhub-preview__meta {\n        display: flex;\n        gap: 10px;\n        font-size: 12px;\n        color: #7d5b46;\n      }\n\n      .cardhub-preview__tags {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 8px;\n      }\n\n      .cardhub-preview__tag {\n        padding: 6px 10px;\n        border-radius: 999px;\n        border: 1px solid rgba(106, 63, 42, 0.3);\n        background: #fffaf4;\n        font-size: 12px;\n        color: #6a3f2a;\n      }\n\n      .cardhub-preview__actions {\n        display: grid;\n        grid-template-columns: 1fr 1fr;\n        gap: 10px;\n      }\n\n      .cardhub-manage {\n        position: fixed;\n        inset: 0;\n        background: rgba(24, 16, 10, 0.45);\n        backdrop-filter: blur(6px);\n        display: grid;\n        place-items: center;\n        z-index: 100001;\n      }\n\n      .cardhub-manage__panel {\n        width: min(760px, 94vw);\n        max-height: 88vh;\n        background: #fff6ea;\n        border-radius: 26px;\n        box-shadow: 0 26px 70px rgba(0, 0, 0, 0.25);\n        padding: 22px;\n        position: relative;\n        display: grid;\n        gap: 16px;\n        overflow: auto;\n      }\n\n      .cardhub-manage__top {\n        display: grid;\n        grid-template-columns: 1fr auto;\n        gap: 16px;\n        align-items: start;\n      }\n\n      .cardhub-manage__media {\n        width: 220px;\n        aspect-ratio: 3 / 4;\n        height: auto;\n        border-radius: 18px;\n        background: #ead7c4;\n        display: grid;\n        place-items: center;\n        overflow: hidden;\n      }\n\n      .cardhub-manage__media img {\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n      }\n\n      .cardhub-manage__summary {\n        display: grid;\n        gap: 6px;\n      }\n\n      .cardhub-manage__overview {\n        display: grid;\n        gap: 10px;\n        margin-top: 10px;\n        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));\n      }\n\n      .cardhub-manage__overview-card {\n        background: rgba(255, 255, 255, 0.7);\n        border: 1px solid rgba(106, 63, 42, 0.2);\n        border-radius: 14px;\n        padding: 10px 12px;\n        display: grid;\n        gap: 4px;\n      }\n\n      .cardhub-manage__overview-label {\n        font-size: 10px;\n        color: #7d5b46;\n        text-transform: uppercase;\n        letter-spacing: 1px;\n      }\n\n      .cardhub-manage__overview-value {\n        font-size: 13px;\n        font-weight: 600;\n        color: #3b2a20;\n      }\n\n      .cardhub-manage__overview-hint {\n        font-size: 11px;\n        color: #7d5b46;\n      }\n\n      .cardhub-manage__section {\n        display: grid;\n        gap: 8px;\n      }\n\n      .cardhub-manage__details {\n        display: grid;\n        gap: 12px;\n        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));\n      }\n\n      .cardhub-manage__detail {\n        background: #fffaf4;\n        border: 1px solid rgba(106, 63, 42, 0.2);\n        border-radius: 16px;\n        padding: 12px 14px;\n        display: grid;\n        gap: 6px;\n      }\n\n      .cardhub-manage__detail-label {\n        font-size: 11px;\n        color: #7d5b46;\n        text-transform: uppercase;\n        letter-spacing: 1px;\n      }\n\n      .cardhub-manage__detail-content {\n        font-size: 12px;\n        line-height: 1.5;\n        color: #3b2a20;\n        white-space: pre-wrap;\n      }\n\n      .cardhub-manage__label {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        gap: 8px;\n        font-size: 12px;\n        color: #7d5b46;\n        text-transform: uppercase;\n        letter-spacing: 1px;\n      }\n\n      .cardhub-manage__btn {\n        border: none;\n        border-radius: 12px;\n        padding: 6px 12px;\n        font-size: 12px;\n        cursor: pointer;\n        text-transform: none;\n        transition: background-color 160ms ease, transform 120ms ease, box-shadow 160ms ease;\n      }\n\n      .cardhub-manage__btn.is-primary {\n        background: #2b2018;\n        color: #fff5ea;\n      }\n\n      .cardhub-manage__btn.is-secondary {\n        background: #d9c6b6;\n        color: #3b2a20;\n      }\n\n      .cardhub-manage__jump-row {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 8px;\n        align-items: center;\n      }\n\n      .cardhub-manage__btn:hover {\n        transform: translateY(-1px);\n        box-shadow: 0 6px 14px rgba(43, 32, 24, 0.15);\n      }\n\n      .cardhub-manage__btn.is-primary:hover {\n        background: #241a14;\n      }\n\n      .cardhub-manage__btn.is-secondary:hover {\n        background: #d1bca8;\n      }\n\n      .cardhub-manage__btn:active {\n        transform: translateY(0);\n      }\n\n      .cardhub-manage__content {\n        background: #fffaf4;\n        border: 1px solid rgba(106, 63, 42, 0.2);\n        border-radius: 16px;\n        padding: 12px 14px;\n        font-size: 12px;\n        line-height: 1.5;\n        color: #3b2a20;\n        white-space: pre-wrap;\n      }\n\n      .cardhub-manage__opening {\n        padding: 6px 0;\n        border-bottom: 1px dashed rgba(106, 63, 42, 0.2);\n      }\n\n      .cardhub-manage__opening:last-child {\n        border-bottom: none;\n      }\n\n      .cardhub-manage__chat {\n        display: grid;\n        gap: 10px;\n      }\n\n      .cardhub-manage__chat-row {\n        display: grid;\n        grid-template-columns: minmax(140px, 220px) 1fr;\n        gap: 12px;\n        font-size: 12px;\n        color: #3b2a20;\n        align-items: start;\n        padding: 6px 8px;\n        border-radius: 10px;\n        cursor: pointer;\n      }\n\n      .cardhub-manage__chat-row:hover {\n        background: rgba(106, 63, 42, 0.08);\n      }\n\n      .cardhub-manage__chat-main {\n        display: grid;\n        gap: 4px;\n      }\n\n      .cardhub-manage__chat-name {\n        flex: 0 0 auto;\n        font-weight: 600;\n        color: #6a3f2a;\n        word-break: break-word;\n      }\n\n      .cardhub-manage__chat-label {\n        font-size: 11px;\n        color: #9a7a63;\n        word-break: break-word;\n      }\n\n      .cardhub-manage__chat-tags {\n        display: flex;\n        flex-wrap: wrap;\n        gap: 4px;\n      }\n\n      .cardhub-manage__chat-tag {\n        padding: 2px 6px;\n        border-radius: 999px;\n        border: 1px solid rgba(106, 63, 42, 0.2);\n        background: rgba(255, 255, 255, 0.75);\n        font-size: 10px;\n        color: #6a3f2a;\n      }\n\n      .cardhub-manage__chat-text {\n        color: #3b2a20;\n        line-height: 1.5;\n        display: -webkit-box;\n        -webkit-line-clamp: 2;\n        -webkit-box-orient: vertical;\n        overflow: hidden;\n      }\n\n      .cardhub-manage__empty {\n        font-size: 12px;\n        color: #9a7a63;\n      }\n\n      .cardhub-manage__actions {\n        display: grid;\n        grid-template-columns: 1fr 1fr;\n        gap: 10px;\n      }\n\n      .cardhub-confirm {\n        position: absolute;\n        inset: 0;\n        background: rgba(24, 16, 10, 0.55);\n        backdrop-filter: blur(6px);\n        display: grid;\n        place-items: center;\n        z-index: 100002;\n      }\n\n      .cardhub-confirm__panel {\n        width: min(460px, 92vw);\n        background: #fff6ea;\n        border-radius: 22px;\n        box-shadow: 0 26px 70px rgba(0, 0, 0, 0.25);\n        padding: 18px 20px;\n        display: grid;\n        gap: 12px;\n      }\n\n      .cardhub-confirm__title {\n        font-size: 16px;\n        font-weight: 600;\n        color: #2b2018;\n      }\n\n      .cardhub-confirm__message {\n        font-size: 13px;\n        line-height: 1.5;\n        color: #4a2a1f;\n        white-space: pre-wrap;\n      }\n\n      .cardhub-confirm__actions {\n        display: flex;\n        gap: 10px;\n        justify-content: flex-end;\n        flex-wrap: wrap;\n      }\n\n      .cardhub-confirm__button {\n        border: none;\n        border-radius: 999px;\n        padding: 8px 14px;\n        font-size: 12px;\n        cursor: pointer;\n        transition: transform 120ms ease, box-shadow 160ms ease, background-color 160ms ease, border-color 160ms ease;\n      }\n\n      .cardhub-confirm__button.is-confirm {\n        background: #d46b3d;\n        color: #fff;\n      }\n\n      .cardhub-confirm__button.is-cancel {\n        background: transparent;\n        color: #6a3f2a;\n        border: 1px solid rgba(106, 63, 42, 0.4);\n      }\n\n      .cardhub-confirm__button.is-danger {\n        background: #b6452a;\n        color: #fff;\n      }\n\n      .cardhub-confirm__button:hover {\n        transform: translateY(-1px);\n        box-shadow: 0 6px 14px rgba(43, 32, 24, 0.18);\n      }\n\n      .cardhub-confirm__button:active {\n        transform: translateY(0);\n      }\n\n      .cardhub-button:focus-visible,\n      .cardhub-chip:focus-visible,\n      .cardhub-tag-filter__chip:focus-visible,\n      .cardhub-tag:focus-visible,\n      .cardhub-card__action:focus-visible,\n      .cardhub-pagination__button:focus-visible,\n      .cardhub-manage__btn:focus-visible,\n      .cardhub-close:focus-visible,\n      .cardhub-preview__close:focus-visible,\n      .cardhub-confirm__button:focus-visible {\n        outline: 2px solid rgba(212, 107, 61, 0.6);\n        outline-offset: 2px;\n      }\n      @media (max-width: 720px) {\n        .cardhub-root {\n          position: absolute !important;\n          inset: 0 !important;\n          z-index: 99999 !important;\n          display: none;\n          align-items: center !important;\n          justify-content: center !important;\n          padding: 16px !important;\n          box-sizing: border-box !important;\n          overflow-y: auto !important;\n        }\n\n        .cardhub-root.open {\n          display: flex !important;\n        }\n\n        .cardhub-backdrop {\n          position: absolute !important;\n          inset: 0 !important;\n          z-index: 99998 !important;\n          background: rgba(0, 0, 0, 0.4) !important;\n          backdrop-filter: blur(8px) !important;\n        }\n\n        .cardhub-panel {\n          position: relative !important;\n          transform: none !important;\n          width: 100% !important;\n          height: 100% !important;\n          max-height: 100% !important;\n          max-width: none !important;\n          margin: 0 !important;\n          border-radius: 20px !important;\n          box-shadow: 0 16px 64px rgba(0, 0, 0, 0.35) !important;\n          display: flex !important;\n          flex-direction: column !important;\n          z-index: 100000 !important;\n          overflow: hidden !important;\n          border: 1px solid rgba(255, 255, 255, 0.2) !important;\n        }\n\n        .cardhub-header {\n          flex-shrink: 0;\n          padding: 14px 16px;\n          border-bottom: 1px solid rgba(86, 59, 44, 0.12);\n        }\n\n        .cardhub-title__main {\n          font-size: 20px;\n        }\n\n        .cardhub-title__sub {\n          font-size: 11px;\n        }\n\n        .cardhub-close {\n          width: 28px;\n          height: 28px;\n          font-size: 16px;\n          line-height: 28px;\n        }\n\n        .cardhub-toolbar {\n          flex-shrink: 0;\n          display: flex;\n          flex-wrap: wrap;\n          gap: 8px;\n          padding: 10px 14px;\n        }\n\n        .cardhub-search {\n          width: 100%;\n          font-size: 13px;\n          padding: 8px 12px;\n        }\n\n        .cardhub-button {\n          flex: 1;\n          min-width: 0;\n          font-size: 11px;\n          padding: 6px 10px;\n        }\n\n        .cardhub-body {\n          display: flex;\n          flex-direction: column;\n          flex: 1;\n          min-height: 0;\n          overflow: auto;\n        }\n\n        .cardhub-sidebar {\n          flex-shrink: 0;\n          border-right: none;\n          border-bottom: 1px solid rgba(86, 59, 44, 0.12);\n          padding: 10px 14px;\n          max-height: none;\n          overflow: visible;\n        }\n\n        .cardhub-section-title {\n          font-size: 10px;\n          margin-bottom: 6px;\n        }\n\n        .cardhub-divider {\n          margin: 6px 0;\n        }\n\n        .cardhub-chip-row,\n        .cardhub-tag-filter {\n          display: flex;\n          flex-wrap: wrap;\n          overflow: visible;\n          gap: 6px;\n          padding-bottom: 4px;\n        }\n\n        .cardhub-chip-row::-webkit-scrollbar,\n        .cardhub-tag-filter::-webkit-scrollbar {\n          height: 4px;\n        }\n\n        .cardhub-chip-row::-webkit-scrollbar-thumb,\n        .cardhub-tag-filter::-webkit-scrollbar-thumb {\n          background: rgba(106, 63, 42, 0.15);\n          border-radius: 999px;\n        }\n\n        .cardhub-chip {\n          font-size: 11px;\n          padding: 5px 10px;\n          white-space: nowrap;\n          flex-shrink: 0;\n        }\n\n        .cardhub-tag-filter__chip {\n          font-size: 10px;\n          padding: 4px 8px;\n          white-space: nowrap;\n          flex-shrink: 0;\n        }\n\n        .cardhub-content {\n          flex: 1;\n          min-height: 0;\n          overflow: visible;\n          padding: 12px;\n        }\n\n        .cardhub-pagination {\n          align-items: flex-start;\n        }\n\n        .cardhub-pagination__actions {\n          width: 100%;\n        }\n\n        .cardhub-pagination__button {\n          flex: 1;\n          text-align: center;\n        }\n\n        .cardhub-grid {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));\n          gap: 10px;\n          justify-content: center;\n          justify-items: center;\n        }\n\n        .cardhub-card {\n          display: flex;\n          flex-direction: row;\n          align-items: center;\n          gap: 10px;\n          padding: 10px;\n          border-radius: 14px;\n          min-width: 0;\n          width: 100%;\n          max-width: none;\n        }\n\n        .cardhub-card__avatar {\n          width: 40px;\n          height: 40px;\n          flex-shrink: 0;\n          border-radius: 10px;\n        }\n\n        .cardhub-card__info {\n          flex: 1;\n          min-width: 0;\n        }\n\n        .cardhub-card__name {\n          font-size: 13px;\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n\n        .cardhub-card__meta {\n          font-size: 10px;\n          gap: 6px;\n        }\n\n        .cardhub-card__tags {\n          margin-top: 4px;\n          gap: 4px;\n        }\n\n        .cardhub-tag {\n          font-size: 9px;\n          padding: 3px 6px;\n        }\n\n        .cardhub-card__actions {\n          display: flex;\n          flex-direction: column;\n          gap: 4px;\n          flex-shrink: 0;\n        }\n\n        .cardhub-card__action {\n          padding: 5px 10px;\n          font-size: 10px;\n          border-radius: 8px;\n        }\n\n        .cardhub-preview,\n        .cardhub-manage {\n          position: absolute !important;\n          inset: 0 !important;\n          display: flex !important;\n          align-items: center !important;\n          justify-content: center !important;\n          padding: 16px !important;\n          box-sizing: border-box !important;\n          overflow-y: auto !important;\n        }\n\n        .cardhub-preview__panel,\n        .cardhub-manage__panel {\n          width: calc(100vw - 32px) !important;\n          max-width: 360px !important;\n          max-height: calc(100vh - 32px) !important;\n          max-height: calc(100dvh - 32px) !important;\n          border-radius: 18px !important;\n          padding: 16px !important;\n          overflow: auto !important;\n        }\n\n        .cardhub-preview__avatar {\n          height: 180px;\n          border-radius: 14px;\n        }\n\n        .cardhub-preview__name {\n          font-size: 16px;\n        }\n\n        .cardhub-preview__meta {\n          font-size: 11px;\n        }\n\n        .cardhub-preview__tag {\n          font-size: 10px;\n          padding: 4px 8px;\n        }\n\n        .cardhub-preview__actions {\n          gap: 8px;\n        }\n\n        .cardhub-manage__top {\n          grid-template-columns: 1fr;\n          gap: 12px;\n        }\n\n        .cardhub-manage__media {\n          width: 120px;\n          margin: 0 auto;\n        }\n\n        .cardhub-manage__overview {\n          grid-template-columns: 1fr;\n        }\n\n        .cardhub-manage__overview-value {\n          font-size: 12px;\n        }\n\n        .cardhub-manage__overview-hint {\n          font-size: 10px;\n        }\n\n        .cardhub-manage__label {\n          flex-direction: column;\n          align-items: flex-start;\n          gap: 6px;\n          font-size: 10px;\n        }\n\n        .cardhub-manage__details {\n          grid-template-columns: 1fr;\n        }\n\n        .cardhub-manage__detail-label {\n          font-size: 10px;\n        }\n\n        .cardhub-manage__detail-content {\n          font-size: 11px;\n        }\n\n        .cardhub-manage__btn {\n          width: 100%;\n          text-align: center;\n          font-size: 10px;\n        }\n\n        .cardhub-manage__jump-row {\n          width: 100%;\n        }\n\n        .cardhub-manage__content {\n          font-size: 11px;\n          padding: 10px;\n        }\n\n        .cardhub-manage__chat-row {\n          grid-template-columns: 1fr;\n          gap: 3px;\n          font-size: 11px;\n        }\n\n        .cardhub-manage__chat-label {\n          font-size: 10px;\n        }\n\n        .cardhub-manage__chat-tag {\n          font-size: 9px;\n        }\n\n        .cardhub-manage__chat-text {\n          -webkit-line-clamp: 2;\n        }\n\n        .cardhub-manage__actions {\n          grid-template-columns: 1fr 1fr;\n          gap: 8px;\n        }\n      }\n    ').appendTo('head'),Rn=$('<div>').attr('script_id',getScriptId()).addClass('cardhub-mount').appendTo('body'),Fn=(0,a.createApp)(Pn),Fn.mount(Rn[0]),(0,a.watch)(()=>v.open,()=>{},{immediate:!0}))}function Jn(){return{open:(n='manual')=>{Yn(),x(!0,n)},close:()=>{x(!1)},toggle:(n='manual')=>{Yn(),x(!v.open,n)},refresh:async()=>{Yn(),await async function(){y(!0);try{w(await r()),k(b())}finally{y(!1)}}()},destroy:()=>{Fn&&Fn.unmount(),Rn&&Rn.remove(),Un&&Un.remove(),Fn=null,Rn=null,Un=null}}}function qn(){const e=Jn(),t=n(e);e.refresh(),$(window).on('pagehide',()=>{t(),e.destroy()})}$(()=>{errorCatched(qn)()})})();
//# sourceMappingURL=index.js.map</script><style>.char-layout[data-v-0da01a64]{display:flex;flex-direction:column;gap:12px}.section-head[data-v-0da01a64]{font-size:.95rem;border-bottom:3px solid var(--c-celadon);display:inline-block;margin-bottom:8px;font-weight:bold}.title-grid[data-v-0da01a64]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:8px;margin-bottom:12px}.title-box[data-v-0da01a64]{border:1.5px solid var(--c-granite);padding:7px;background:#fff;box-shadow:2px 2px 0 var(--c-ash-grey)}.title-name[data-v-0da01a64]{background:var(--c-granite);color:var(--c-celadon);display:inline-block;padding:2px 4px;font-size:.72rem;font-weight:bold;margin-bottom:3px}.title-effect[data-v-0da01a64]{font-size:.78rem;margin-bottom:3px}.title-quote[data-v-0da01a64]{font-size:.7rem;color:var(--c-grey-olive);font-style:italic}.attire-list[data-v-0da01a64]{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:7px}.attire-item[data-v-0da01a64]{border:1px solid var(--c-grey-olive);padding:6px;font-size:.82rem;background:#fff}.attire-slot[data-v-0da01a64]{color:var(--c-grey-olive);font-size:.72rem;display:block}@media (max-width:600px){.title-grid[data-v-0da01a64],.attire-list[data-v-0da01a64]{grid-template-columns:1fr}}
.dependency-strip[data-v-d656b568]{display:flex;align-items:center;justify-content:center;gap:8px;padding:6px 10px;background:#fff;border-bottom:2px dashed var(--c-granite)}.dependency-label[data-v-d656b568],.dependency-value[data-v-d656b568]{font-weight:bold;font-size:.9rem}.dependency-track[data-v-d656b568]{flex:1;max-width:360px;height:10px;border:1.5px solid var(--c-granite);background:var(--c-mint-cream);position:relative;overflow:hidden}.dependency-fill[data-v-d656b568]{position:absolute;left:0;top:0;bottom:0;background:var(--c-celadon);border-right:1.5px solid var(--c-granite);transition:width .25s ease}.dependency-controls[data-v-d656b568]{display:flex;gap:4px}.dependency-button[data-v-d656b568]{width:24px;height:22px;padding:0;border:1.5px solid var(--c-granite);background:var(--c-mint-cream);color:var(--c-granite);font-family:inherit;font-weight:bold;line-height:1;cursor:pointer;box-shadow:2px 2px 0px rgba(60,73,63,.16)}.dependency-button[data-v-d656b568]:active:not(:disabled){transform:translate(1px,1px);box-shadow:1px 1px 0px rgba(60,73,63,.16)}.dependency-button[data-v-d656b568]:disabled{opacity:.5;cursor:not-allowed;box-shadow:none}.dependency-button[data-v-d656b568]:focus-visible{outline:2px dashed var(--c-granite);outline-offset:2px}
.inventory-grid[data-v-4b907352]{display:flex;flex-direction:column;gap:8px}.item-row[data-v-4b907352]{display:flex;align-items:center;border:1.5px solid var(--c-granite);padding:8px;background:#fff;transition:transform .2s}.item-row[data-v-4b907352]:hover{transform:translateX(5px);background:var(--c-mint-cream)}.item-icon[data-v-4b907352]{width:28px;height:28px;background:var(--c-celadon);border:1.5px solid var(--c-granite);display:flex;align-items:center;justify-content:center;margin-right:10px;font-weight:bold;font-size:.7rem}.item-detail[data-v-4b907352]{flex:1}.item-name[data-v-4b907352]{font-weight:bold;display:block}.item-desc[data-v-4b907352]{font-size:.76rem;color:var(--c-grey-olive)}.item-count[data-v-4b907352]{background:var(--c-granite);color:#fff;padding:2px 5px;font-size:.72rem;border-radius:3px}.empty-state[data-v-4b907352]{text-align:center;color:var(--c-grey-olive);padding:18px;font-style:italic;font-size:.85rem}
.tabs[data-v-9a65186e]{display:flex;background-color:var(--c-grey-olive);border-bottom:3px solid var(--c-granite)}.tab-button[data-v-9a65186e]{flex:1;padding:8px;border:none;background:rgba(0,0,0,0);color:var(--c-mint-cream);font-size:.92rem;font-weight:bold;font-family:var(--font-archive);cursor:pointer;transition:all .2s;text-transform:uppercase;border-right:1.5px solid var(--c-granite)}.tab-button[data-v-9a65186e]:last-child{border-right:none}.tab-button[data-v-9a65186e]:hover{background-color:var(--c-ash-grey);color:var(--c-granite)}.tab-button.active[data-v-9a65186e]{background-color:var(--c-mint-cream);color:var(--c-granite);position:relative;top:1px;padding-bottom:10px}
.world-section[data-v-682d2527]{border-bottom:3px solid var(--c-granite);padding:10px;background-color:var(--c-mint-cream)}.meta-row[data-v-682d2527]{display:flex;justify-content:space-between;margin-bottom:6px;font-weight:bold;font-size:.9rem;border-bottom:1.5px dashed var(--c-grey-olive);padding-bottom:6px;flex-wrap:wrap;gap:6px}.event-list[data-v-682d2527]{display:flex;gap:8px;overflow-x:auto}.event-badge[data-v-682d2527]{background:#fff;border:1.5px solid var(--c-granite);padding:6px 8px;min-width:130px;flex:1;position:relative}.event-badge[data-v-682d2527]::before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;background-color:var(--c-celadon)}.event-title[data-v-682d2527]{display:block;font-weight:bold;margin-bottom:2px;padding-left:6px}.event-desc[data-v-682d2527]{display:block;font-size:.75rem;color:var(--c-grey-olive);padding-left:6px}@media (max-width:600px){.meta-row[data-v-682d2527]{flex-direction:column;gap:5px}.event-list[data-v-682d2527]{flex-direction:column}.event-badge[data-v-682d2527]{min-width:auto}}
.card[data-v-433deeca]{width:100%;max-width:720px;background-color:var(--c-mint-cream);border:3px solid var(--c-granite);box-shadow:5px 5px 0px rgba(60,73,63,.16);display:flex;flex-direction:column;font-family:var(--font-archive);color:var(--c-granite);font-size:13px;line-height:1.35;margin:0 auto}.content-area[data-v-433deeca]{padding:12px;min-height:0}.tab-pane[data-v-433deeca]{display:none;animation:fadeEffect-433deeca .4s}.tab-pane.active[data-v-433deeca]{display:block}@keyframes fadeEffect-433deeca{from{opacity:0;transform:translateY(5px)}to{opacity:1;transform:translateY(0)}}
*{box-sizing:border-box;margin:0;padding:0}:root{--c-granite:#3c493f;--c-grey-olive:#7e8d85;--c-ash-grey:#b3bfb8;--c-mint-cream:#f0f7f4;--c-celadon:#a2e3c4;--font-archive:'Courier New','Microsoft YaHei',monospace}

.cardhub-root[data-v-fe13b558]{position:fixed;inset:0;z-index:9999;font-family:"ZCOOL XiaoWei","STSong","Songti SC","SimSun",serif;color:#1b1b1b;display:none;align-items:center;justify-content:center}.cardhub-root.open[data-v-fe13b558]{display:flex;align-items:center;justify-content:center}.cardhub-backdrop[data-v-fe13b558]{position:absolute;inset:0;background:rgba(0,0,0,0.4);backdrop-filter:blur(6px);opacity:0;transition:opacity 180ms ease}.cardhub-root.open .cardhub-backdrop[data-v-fe13b558]{opacity:1}.cardhub-panel[data-v-fe13b558]{position:relative;width:min(980px,94%);max-height:92%;background:linear-gradient(160deg,#fff9f0,#f3e4d4);border-radius:28px;box-shadow:0 30px 90px rgba(0,0,0,0.28);display:flex;flex-direction:column;overflow:hidden;z-index:1;opacity:0;transform:translateY(8px) scale(0.985);transition:opacity 180ms ease,transform 180ms ease}.cardhub-root.open .cardhub-panel[data-v-fe13b558]{opacity:1;transform:translateY(0) scale(1)}.cardhub-header[data-v-fe13b558]{display:flex;align-items:center;justify-content:space-between;padding:20px 24px;border-bottom:1px solid rgba(86,59,44,0.15)}.cardhub-title__main[data-v-fe13b558]{font-size:26px;letter-spacing:2px}.cardhub-title__sub[data-v-fe13b558]{font-size:12px;color:#7d5b46;margin-left:10px}.cardhub-actions[data-v-fe13b558]{display:flex;gap:10px}.cardhub-close[data-v-fe13b558]{border:none;background:rgba(43,32,24,0.12);color:#3b2a20;width:34px;height:34px;border-radius:999px;font-size:20px;line-height:34px;text-align:center;cursor:pointer;transition:background-color 160ms ease,transform 120ms ease}.cardhub-close[data-v-fe13b558]:hover{background:rgba(43,32,24,0.2)}.cardhub-close[data-v-fe13b558]:active{transform:scale(0.96)}.cardhub-toolbar[data-v-fe13b558]{display:flex;gap:8px;padding:12px 20px;flex-wrap:wrap}.cardhub-search[data-v-fe13b558]{flex:1;min-width:180px;border-radius:999px;border:1px solid rgba(86,59,44,0.2);padding:6px 12px;background:#fffaf4}.cardhub-button[data-v-fe13b558]{border:none;padding:6px 14px;border-radius:999px;background:#d46b3d;color:#fff;cursor:pointer;font-size:12px;transition:background-color 160ms ease,transform 120ms ease,box-shadow 160ms ease}.cardhub-button[data-v-fe13b558]:hover{background:#c55f36;box-shadow:0 6px 14px rgba(43,32,24,0.18)}.cardhub-button[data-v-fe13b558]:active{transform:translateY(1px)}.cardhub-button.is-ghost[data-v-fe13b558]{background:transparent;color:#6a3f2a;border:1px solid rgba(106,63,42,0.4)}.cardhub-button.is-ghost[data-v-fe13b558]:hover{background:rgba(106,63,42,0.08);border-color:rgba(106,63,42,0.6);box-shadow:none}.cardhub-import-input[data-v-fe13b558]{display:none}.cardhub-body[data-v-fe13b558]{display:grid;grid-template-columns:minmax(160px,220px) 1fr;gap:0;flex:1;min-height:0}.cardhub-sidebar[data-v-fe13b558]{padding:20px;border-right:1px solid rgba(86,59,44,0.15);display:flex;flex-direction:column;gap:12px}.cardhub-chip-row[data-v-fe13b558]{display:flex;flex-wrap:wrap;gap:8px}.cardhub-divider[data-v-fe13b558]{height:1px;width:100%;background:rgba(86,59,44,0.15);margin:8px 0}.cardhub-section-title[data-v-fe13b558]{font-size:12px;color:#7d5b46;text-transform:uppercase;letter-spacing:1px}.cardhub-chip[data-v-fe13b558]{text-align:left;border:none;background:rgba(255,255,255,0.6);border-radius:12px;padding:8px 10px;cursor:pointer;font-size:12px;transition:background-color 160ms ease,color 160ms ease,transform 120ms ease}.cardhub-chip.is-active[data-v-fe13b558]{background:#2b2018;color:#fff5ea}.cardhub-chip[data-v-fe13b558]:not(.is-active):hover{background:rgba(255,255,255,0.9);transform:translateY(-1px)}.cardhub-placeholder[data-v-fe13b558]{font-size:12px;color:#9a7a63}.cardhub-tag-filter[data-v-fe13b558]{display:flex;flex-wrap:wrap;gap:8px}.cardhub-tag-filter__chip[data-v-fe13b558]{border:1px solid rgba(106,63,42,0.25);background:rgba(255,255,255,0.7);border-radius:999px;padding:6px 10px;font-size:12px;color:#6a3f2a;cursor:pointer;transition:background-color 160ms ease,color 160ms ease,border-color 160ms ease,transform 120ms ease}.cardhub-tag-filter__chip.is-active[data-v-fe13b558]{background:#2b2018;color:#fff5ea;border-color:transparent}.cardhub-tag-filter__chip[data-v-fe13b558]:not(.is-active):hover{border-color:rgba(106,63,42,0.45);background:rgba(255,255,255,0.9);transform:translateY(-1px)}.cardhub-chip--clear[data-v-fe13b558]{margin-top:8px}.cardhub-content[data-v-fe13b558]{padding:20px;overflow:auto;flex:1;min-height:0}.cardhub-grid-wrap[data-v-fe13b558]{display:grid;gap:12px}.cardhub-pagination[data-v-fe13b558]{display:flex;align-items:center;justify-content:flex-end;gap:10px;flex-wrap:wrap}.cardhub-pagination__status[data-v-fe13b558]{font-size:12px;color:#7d5b46}.cardhub-pagination__actions[data-v-fe13b558]{display:flex;gap:8px;align-items:center;margin-right:auto}.cardhub-pagination__button[data-v-fe13b558]{border:1px solid rgba(106,63,42,0.35);background:rgba(255,255,255,0.85);color:#6a3f2a;border-radius:999px;padding:4px 10px;font-size:11px;cursor:pointer;transition:background-color 160ms ease,border-color 160ms ease,transform 120ms ease}.cardhub-pagination__button[data-v-fe13b558]:disabled{opacity:0.4;cursor:default}.cardhub-pagination__button[data-v-fe13b558]:not(:disabled):hover{background:rgba(255,255,255,1);border-color:rgba(106,63,42,0.6);transform:translateY(-1px)}.cardhub-pagination__button[data-v-fe13b558]:not(:disabled):active{transform:translateY(0)}.cardhub-loading[data-v-fe13b558],.cardhub-empty[data-v-fe13b558]{padding:40px 0;text-align:center;color:#7d5b46}.cardhub-grid[data-v-fe13b558]{display:grid;gap:14px;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));justify-items:center}.cardhub-card[data-v-fe13b558]{background:rgba(255,255,255,0.78);border-radius:18px;padding:14px;display:grid;grid-template-columns:auto 1fr;gap:12px;align-items:center;border:1px solid rgba(86,59,44,0.15);cursor:pointer;transition:transform 140ms ease,box-shadow 180ms ease,border-color 180ms ease;width:100%;max-width:260px}.cardhub-card[data-v-fe13b558]:hover{transform:translateY(-2px);border-color:rgba(86,59,44,0.25);box-shadow:0 12px 26px rgba(43,32,24,0.16)}.cardhub-card[data-v-fe13b558]:active{transform:translateY(0)}.cardhub-card__avatar[data-v-fe13b558]{width:42px;height:42px;border-radius:12px;background:linear-gradient(135deg,#f4d7c4,#d36a3b);background-size:cover;background-position:center;color:#4a2a1f;display:grid;place-items:center;font-weight:700}.cardhub-card__avatar.has-avatar span[data-v-fe13b558]{display:none}.cardhub-card__name[data-v-fe13b558]{font-size:14px;font-weight:600}.cardhub-card__meta[data-v-fe13b558]{display:flex;gap:8px;font-size:11px;color:#7d5b46}.cardhub-card__tags[data-v-fe13b558]{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px;align-items:center}.cardhub-tag[data-v-fe13b558]{border:1px solid rgba(106,63,42,0.3);background:#fff6ea;border-radius:999px;padding:4px 8px;font-size:11px;color:#6a3f2a;cursor:pointer;transition:background-color 160ms ease,border-color 160ms ease,transform 120ms ease}.cardhub-tag[data-v-fe13b558]:hover{background:#fffaf4;border-color:rgba(106,63,42,0.5);transform:translateY(-1px)}.cardhub-tag__remove[data-v-fe13b558]{margin-left:4px;font-weight:700}.cardhub-tag.is-add[data-v-fe13b558]{background:transparent;border-style:dashed}.cardhub-tag-input[data-v-fe13b558]{border:1px dashed rgba(106,63,42,0.5);background:#fffaf4;border-radius:999px;padding:4px 10px;font-size:11px;min-width:80px;color:#6a3f2a;outline:none;height:24px;line-height:16px}.cardhub-tag-input[data-v-fe13b558]:focus{border-color:rgba(106,63,42,0.85)}.cardhub-card__action[data-v-fe13b558]{grid-column:span 2;margin-top:10px;border:none;background:#2b2018;color:#fff5ea;padding:6px 12px;border-radius:12px;font-size:12px;cursor:pointer;transition:transform 120ms ease,box-shadow 160ms ease,background-color 160ms ease}.cardhub-card__actions[data-v-fe13b558]{grid-column:span 2;display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:10px}.cardhub-card__action.is-secondary[data-v-fe13b558]{background:#d9c6b6;color:#3b2a20}.cardhub-card__action[data-v-fe13b558]:hover{transform:translateY(-1px);box-shadow:0 6px 14px rgba(43,32,24,0.15)}.cardhub-card__action[data-v-fe13b558]:active{transform:translateY(0)}.cardhub-preview[data-v-fe13b558]{position:fixed;inset:0;background:rgba(24,16,10,0.45);backdrop-filter:blur(6px);display:grid;place-items:center;z-index:100000}.cardhub-preview__panel[data-v-fe13b558]{width:min(520px,92vw);background:#fff6ea;border-radius:26px;box-shadow:0 26px 70px rgba(0,0,0,0.25);padding:20px;position:relative;display:grid;gap:14px}.cardhub-preview__close[data-v-fe13b558]{position:absolute;top:14px;right:14px;border:none;width:30px;height:30px;border-radius:999px;background:rgba(43,32,24,0.15);color:#3b2a20;font-size:18px;cursor:pointer;transition:background-color 160ms ease,transform 120ms ease}.cardhub-preview__close[data-v-fe13b558]:hover{background:rgba(43,32,24,0.25)}.cardhub-preview__close[data-v-fe13b558]:active{transform:scale(0.96)}.cardhub-preview__avatar[data-v-fe13b558]{width:100%;height:260px;border-radius:18px;background:#ead7c4;display:grid;place-items:center;overflow:hidden}.cardhub-preview__avatar img[data-v-fe13b558]{width:100%;height:100%;object-fit:contain}.cardhub-preview__info[data-v-fe13b558]{display:grid;gap:6px}.cardhub-preview__name[data-v-fe13b558]{font-size:20px;font-weight:700}.cardhub-preview__meta[data-v-fe13b558]{display:flex;gap:10px;font-size:12px;color:#7d5b46}.cardhub-preview__tags[data-v-fe13b558]{display:flex;flex-wrap:wrap;gap:8px}.cardhub-preview__tag[data-v-fe13b558]{padding:6px 10px;border-radius:999px;border:1px solid rgba(106,63,42,0.3);background:#fffaf4;font-size:12px;color:#6a3f2a}.cardhub-preview__actions[data-v-fe13b558]{display:grid;grid-template-columns:1fr 1fr;gap:10px}.cardhub-manage[data-v-fe13b558]{position:fixed;inset:0;background:rgba(24,16,10,0.45);backdrop-filter:blur(6px);display:grid;place-items:center;z-index:100001}.cardhub-manage__panel[data-v-fe13b558]{width:min(760px,94vw);max-height:88vh;background:#fff6ea;border-radius:26px;box-shadow:0 26px 70px rgba(0,0,0,0.25);padding:22px;position:relative;display:grid;gap:16px;overflow:auto}.cardhub-manage__top[data-v-fe13b558]{display:grid;grid-template-columns:1fr auto;gap:16px;align-items:start}.cardhub-manage__media[data-v-fe13b558]{width:220px;aspect-ratio:3/4;height:auto;border-radius:18px;background:#ead7c4;display:grid;place-items:center;overflow:hidden}.cardhub-manage__media img[data-v-fe13b558]{width:100%;height:100%;object-fit:cover}.cardhub-manage__summary[data-v-fe13b558]{display:grid;gap:6px}.cardhub-manage__overview[data-v-fe13b558]{display:grid;gap:10px;margin-top:10px;grid-template-columns:repeat(auto-fit,minmax(160px,1fr))}.cardhub-manage__overview-card[data-v-fe13b558]{background:rgba(255,255,255,0.7);border:1px solid rgba(106,63,42,0.2);border-radius:14px;padding:10px 12px;display:grid;gap:4px}.cardhub-manage__overview-label[data-v-fe13b558]{font-size:10px;color:#7d5b46;text-transform:uppercase;letter-spacing:1px}.cardhub-manage__overview-value[data-v-fe13b558]{font-size:13px;font-weight:600;color:#3b2a20}.cardhub-manage__overview-hint[data-v-fe13b558]{font-size:11px;color:#7d5b46}.cardhub-manage__section[data-v-fe13b558]{display:grid;gap:8px}.cardhub-manage__details[data-v-fe13b558]{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}.cardhub-manage__detail[data-v-fe13b558]{background:#fffaf4;border:1px solid rgba(106,63,42,0.2);border-radius:16px;padding:12px 14px;display:grid;gap:6px}.cardhub-manage__detail-label[data-v-fe13b558]{font-size:11px;color:#7d5b46;text-transform:uppercase;letter-spacing:1px}.cardhub-manage__detail-content[data-v-fe13b558]{font-size:12px;line-height:1.5;color:#3b2a20;white-space:pre-wrap}.cardhub-manage__label[data-v-fe13b558]{display:flex;align-items:center;justify-content:space-between;gap:8px;font-size:12px;color:#7d5b46;text-transform:uppercase;letter-spacing:1px}.cardhub-manage__btn[data-v-fe13b558]{border:none;border-radius:12px;padding:6px 12px;font-size:12px;cursor:pointer;text-transform:none;transition:background-color 160ms ease,transform 120ms ease,box-shadow 160ms ease}.cardhub-manage__btn.is-primary[data-v-fe13b558]{background:#2b2018;color:#fff5ea}.cardhub-manage__btn.is-secondary[data-v-fe13b558]{background:#d9c6b6;color:#3b2a20}.cardhub-manage__jump-row[data-v-fe13b558]{display:flex;flex-wrap:wrap;gap:8px;align-items:center}.cardhub-manage__btn[data-v-fe13b558]:hover{transform:translateY(-1px);box-shadow:0 6px 14px rgba(43,32,24,0.15)}.cardhub-manage__btn.is-primary[data-v-fe13b558]:hover{background:#241a14}.cardhub-manage__btn.is-secondary[data-v-fe13b558]:hover{background:#d1bca8}.cardhub-manage__btn[data-v-fe13b558]:active{transform:translateY(0)}.cardhub-manage__content[data-v-fe13b558]{background:#fffaf4;border:1px solid rgba(106,63,42,0.2);border-radius:16px;padding:12px 14px;font-size:12px;line-height:1.5;color:#3b2a20;white-space:pre-wrap}.cardhub-manage__opening[data-v-fe13b558]{padding:6px 0;border-bottom:1px dashed rgba(106,63,42,0.2)}.cardhub-manage__opening[data-v-fe13b558]:last-child{border-bottom:none}.cardhub-manage__chat[data-v-fe13b558]{display:grid;gap:10px}.cardhub-manage__chat-row[data-v-fe13b558]{display:grid;grid-template-columns:minmax(140px,220px) 1fr;gap:12px;font-size:12px;color:#3b2a20;align-items:start;padding:6px 8px;border-radius:10px;cursor:pointer}.cardhub-manage__chat-row[data-v-fe13b558]:hover{background:rgba(106,63,42,0.08)}.cardhub-manage__chat-main[data-v-fe13b558]{display:grid;gap:4px}.cardhub-manage__chat-name[data-v-fe13b558]{flex:0 0 auto;font-weight:600;color:#6a3f2a;word-break:break-word}.cardhub-manage__chat-label[data-v-fe13b558]{font-size:11px;color:#9a7a63;word-break:break-word}.cardhub-manage__chat-tags[data-v-fe13b558]{display:flex;flex-wrap:wrap;gap:4px}.cardhub-manage__chat-tag[data-v-fe13b558]{padding:2px 6px;border-radius:999px;border:1px solid rgba(106,63,42,0.2);background:rgba(255,255,255,0.75);font-size:10px;color:#6a3f2a}.cardhub-manage__chat-text[data-v-fe13b558]{color:#3b2a20;line-height:1.5;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.cardhub-manage__empty[data-v-fe13b558]{font-size:12px;color:#9a7a63}.cardhub-manage__actions[data-v-fe13b558]{display:grid;grid-template-columns:1fr 1fr;gap:10px}.cardhub-confirm[data-v-fe13b558]{position:absolute;inset:0;background:rgba(24,16,10,0.55);backdrop-filter:blur(6px);display:grid;place-items:center;z-index:100002}.cardhub-confirm__panel[data-v-fe13b558]{width:min(460px,92vw);background:#fff6ea;border-radius:22px;box-shadow:0 26px 70px rgba(0,0,0,0.25);padding:18px 20px;display:grid;gap:12px}.cardhub-confirm__title[data-v-fe13b558]{font-size:16px;font-weight:600;color:#2b2018}.cardhub-confirm__message[data-v-fe13b558]{font-size:13px;line-height:1.5;color:#4a2a1f;white-space:pre-wrap}.cardhub-confirm__actions[data-v-fe13b558]{display:flex;gap:10px;justify-content:flex-end;flex-wrap:wrap}.cardhub-confirm__button[data-v-fe13b558]{border:none;border-radius:999px;padding:8px 14px;font-size:12px;cursor:pointer;transition:transform 120ms ease,box-shadow 160ms ease,background-color 160ms ease,border-color 160ms ease}.cardhub-confirm__button.is-confirm[data-v-fe13b558]{background:#d46b3d;color:#fff}.cardhub-confirm__button.is-cancel[data-v-fe13b558]{background:transparent;color:#6a3f2a;border:1px solid rgba(106,63,42,0.4)}.cardhub-confirm__button.is-danger[data-v-fe13b558]{background:#b6452a;color:#fff}.cardhub-confirm__button[data-v-fe13b558]:hover{transform:translateY(-1px);box-shadow:0 6px 14px rgba(43,32,24,0.18)}.cardhub-confirm__button[data-v-fe13b558]:active{transform:translateY(0)}.cardhub-button[data-v-fe13b558]:focus-visible,.cardhub-chip[data-v-fe13b558]:focus-visible,.cardhub-tag-filter__chip[data-v-fe13b558]:focus-visible,.cardhub-tag[data-v-fe13b558]:focus-visible,.cardhub-card__action[data-v-fe13b558]:focus-visible,.cardhub-pagination__button[data-v-fe13b558]:focus-visible,.cardhub-manage__btn[data-v-fe13b558]:focus-visible,.cardhub-close[data-v-fe13b558]:focus-visible,.cardhub-preview__close[data-v-fe13b558]:focus-visible,.cardhub-confirm__button[data-v-fe13b558]:focus-visible{outline:2px solid rgba(212,107,61,0.6);outline-offset:2px}@media (max-width:720px){.cardhub-root[data-v-fe13b558]{position:absolute !important;inset:0 !important;z-index:99999 !important;display:none;align-items:center !important;justify-content:center !important;padding:16px !important;box-sizing:border-box !important;overflow-y:auto !important}.cardhub-root.open[data-v-fe13b558]{display:flex !important}.cardhub-backdrop[data-v-fe13b558]{position:absolute !important;inset:0 !important;z-index:99998 !important;background:rgba(0,0,0,0.4) !important;backdrop-filter:blur(8px) !important}.cardhub-panel[data-v-fe13b558]{position:relative !important;width:100% !important;height:100% !important;max-height:100% !important;max-width:none !important;margin:0 !important;border-radius:24px !important;box-shadow:0 12px 48px rgba(0,0,0,0.3),0 2px 8px rgba(0,0,0,0.1) !important;display:flex !important;flex-direction:column !important;z-index:99999 !important;overflow:hidden !important;border:1px solid rgba(255,255,255,0.15) !important}.cardhub-header[data-v-fe13b558]{flex-shrink:0;padding:14px 16px;border-bottom:1px solid rgba(86,59,44,0.12)}.cardhub-title__main[data-v-fe13b558]{font-size:20px}.cardhub-title__sub[data-v-fe13b558]{font-size:11px}.cardhub-close[data-v-fe13b558]{width:28px;height:28px;font-size:16px;line-height:28px}.cardhub-toolbar[data-v-fe13b558]{flex-shrink:0;display:flex;flex-wrap:wrap;gap:8px;padding:10px 14px}.cardhub-search[data-v-fe13b558]{width:100%;font-size:13px;padding:8px 12px}.cardhub-button[data-v-fe13b558]{flex:1;min-width:0;font-size:11px;padding:6px 10px}.cardhub-body[data-v-fe13b558]{display:flex;flex-direction:column;flex:1;min-height:0;overflow:auto}.cardhub-sidebar[data-v-fe13b558]{flex-shrink:0;border-right:none;border-bottom:1px solid rgba(86,59,44,0.12);padding:10px 14px;max-height:none;overflow:visible}.cardhub-section-title[data-v-fe13b558]{font-size:10px;margin-bottom:6px}.cardhub-divider[data-v-fe13b558]{margin:6px 0}.cardhub-chip-row[data-v-fe13b558],.cardhub-tag-filter[data-v-fe13b558]{display:flex;flex-wrap:wrap;overflow:visible;gap:6px;padding-bottom:4px}.cardhub-chip-row[data-v-fe13b558]::-webkit-scrollbar,.cardhub-tag-filter[data-v-fe13b558]::-webkit-scrollbar{height:4px}.cardhub-chip-row[data-v-fe13b558]::-webkit-scrollbar-thumb,.cardhub-tag-filter[data-v-fe13b558]::-webkit-scrollbar-thumb{background:rgba(106,63,42,0.15);border-radius:999px}.cardhub-chip[data-v-fe13b558]{font-size:11px;padding:5px 10px;white-space:nowrap;flex-shrink:0}.cardhub-tag-filter__chip[data-v-fe13b558]{font-size:10px;padding:4px 8px;white-space:nowrap;flex-shrink:0}.cardhub-content[data-v-fe13b558]{flex:1;min-height:0;overflow:visible;padding:12px}.cardhub-pagination[data-v-fe13b558]{align-items:flex-start}.cardhub-pagination__actions[data-v-fe13b558]{width:100%}.cardhub-pagination__button[data-v-fe13b558]{flex:1;text-align:center}.cardhub-grid[data-v-fe13b558]{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:10px;justify-content:center;justify-items:center}.cardhub-card[data-v-fe13b558]{display:flex;flex-direction:row;align-items:center;gap:10px;padding:10px;border-radius:14px;min-width:0;width:100%;max-width:none}.cardhub-card__avatar[data-v-fe13b558]{width:40px;height:40px;flex-shrink:0;border-radius:10px}.cardhub-card__info[data-v-fe13b558]{flex:1;min-width:0}.cardhub-card__name[data-v-fe13b558]{font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.cardhub-card__meta[data-v-fe13b558]{font-size:10px;gap:6px}.cardhub-card__tags[data-v-fe13b558]{margin-top:4px;gap:4px}.cardhub-tag[data-v-fe13b558]{font-size:9px;padding:3px 6px}.cardhub-card__actions[data-v-fe13b558]{display:flex;flex-direction:column;gap:4px;flex-shrink:0}.cardhub-card__action[data-v-fe13b558]{padding:5px 10px;font-size:10px;border-radius:8px}.cardhub-preview[data-v-fe13b558],.cardhub-manage[data-v-fe13b558]{position:absolute !important;inset:0 !important;display:flex !important;align-items:center !important;justify-content:center !important;padding:16px !important;box-sizing:border-box !important;overflow-y:auto !important}.cardhub-preview__panel[data-v-fe13b558],.cardhub-manage__panel[data-v-fe13b558]{width:calc(100vw - 32px) !important;max-width:360px !important;max-height:calc(100vh - 32px) !important;max-height:calc(100dvh - 32px) !important;border-radius:18px !important;padding:16px !important;overflow:auto !important}.cardhub-preview__avatar[data-v-fe13b558]{height:180px;border-radius:14px}.cardhub-preview__name[data-v-fe13b558]{font-size:16px}.cardhub-preview__meta[data-v-fe13b558]{font-size:11px}.cardhub-preview__tag[data-v-fe13b558]{font-size:10px;padding:4px 8px}.cardhub-preview__actions[data-v-fe13b558]{gap:8px}.cardhub-manage__top[data-v-fe13b558]{grid-template-columns:1fr;gap:12px}.cardhub-manage__media[data-v-fe13b558]{width:120px;margin:0 auto}.cardhub-manage__overview[data-v-fe13b558]{grid-template-columns:1fr}.cardhub-manage__overview-value[data-v-fe13b558]{font-size:12px}.cardhub-manage__overview-hint[data-v-fe13b558]{font-size:10px}.cardhub-manage__label[data-v-fe13b558]{flex-direction:column;align-items:flex-start;gap:6px;font-size:10px}.cardhub-manage__details[data-v-fe13b558]{grid-template-columns:1fr}.cardhub-manage__detail-label[data-v-fe13b558]{font-size:10px}.cardhub-manage__detail-content[data-v-fe13b558]{font-size:11px}.cardhub-manage__btn[data-v-fe13b558]{width:100%;text-align:center;font-size:10px}.cardhub-manage__jump-row[data-v-fe13b558]{width:100%}.cardhub-manage__content[data-v-fe13b558]{font-size:11px;padding:10px}.cardhub-manage__chat-row[data-v-fe13b558]{grid-template-columns:1fr;gap:3px;font-size:11px}.cardhub-manage__chat-label[data-v-fe13b558]{font-size:10px}.cardhub-manage__chat-tag[data-v-fe13b558]{font-size:9px}.cardhub-manage__chat-text[data-v-fe13b558]{-webkit-line-clamp:2}.cardhub-manage__actions[data-v-fe13b558]{grid-template-columns:1fr 1fr;gap:8px}}


/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>