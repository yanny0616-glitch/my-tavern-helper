import'https://testingcf.jsdelivr.net/npm/compare-versions/+esm';import'https://testingcf.jsdelivr.net/npm/zod/v4/core/+esm';import{default as e}from'https://testingcf.jsdelivr.net/npm/diacritics/+esm';var t={41(e,t,n){var r=n(207);r.__esModule&&(r=r.default),'string'==typeof r&&(r=[[e.id,r,'']]),r.locals&&(e.exports=r.locals);(0,n(424).A)('3f840fe9',r,!1,{ssrId:!0})},132(e,t,n){n.r(t),n.d(t,{default:()=>i});var r=n(492),a=n.n(r),o=n(748),s=n.n(o)()(a());s.push([e.id,'.StreamingMessage--mark{background-color:color-mix(in srgb,var(--SmartThemeQuoteColor) 70%,transparent);color:var(--SmartThemeBodyColor)}','',{version:3,sources:['webpack://./示例/流式楼层界面示例/高亮.vue'],names:[],mappings:'AACA,wBACE,+EAAA,CACA,gCAAA',sourcesContent:['\n.StreamingMessage--mark {\n  background-color: color-mix(in srgb, var(--SmartThemeQuoteColor) 70%, transparent);\n  color: var(--SmartThemeBodyColor);\n}\n'],sourceRoot:''}]);const i=s},207(e,t,n){n.r(t),n.d(t,{default:()=>i});var r=n(492),a=n.n(r),o=n(748),s=n.n(o)()(a());s.push([e.id,'.StreamingMessage__segments[data-v-48ddcd76]{display:flex;flex-direction:column;gap:.25rem}.StreamingMessage__segment[data-v-48ddcd76]{position:relative}.StreamingMessage__segment.is-hidden[data-v-48ddcd76]{cursor:pointer}.StreamingMessage__segmentContent.is-blurred[data-v-48ddcd76]{filter:blur(6px)}.StreamingMessage__segmentHint[data-v-48ddcd76]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.28);color:var(--SmartThemeBodyColor);font-size:.9em;-webkit-user-select:none;user-select:none;pointer-events:none}','',{version:3,sources:['webpack://./示例/流式楼层界面示例/分段.vue'],names:[],mappings:'AACA,6CACE,YAAA,CACA,qBAAA,CACA,UAAA,CAGF,4CACE,iBAAA,CAGF,sDACE,cAAA,CAGF,8DACE,gBAAA,CAGF,gDACE,iBAAA,CACA,OAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,0BAAA,CACA,gCAAA,CACA,cAAA,CACA,wBAAA,CAAA,gBAAA,CACA,mBAAA',sourcesContent:['\n.StreamingMessage__segments {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n\n.StreamingMessage__segment {\n  position: relative;\n}\n\n.StreamingMessage__segment.is-hidden {\n  cursor: pointer;\n}\n\n.StreamingMessage__segmentContent.is-blurred {\n  filter: blur(6px);\n}\n\n.StreamingMessage__segmentHint {\n  position: absolute;\n  inset: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(0, 0, 0, 0.28);\n  color: var(--SmartThemeBodyColor);\n  font-size: 0.9em;\n  user-select: none;\n  pointer-events: none;\n}\n'],sourceRoot:''}]);const i=s},404(e,t,n){n.r(t),n.d(t,{default:()=>i});var r=n(492),a=n.n(r),o=n(748),s=n.n(o)()(a());s.push([e.id,'.roleplay_options_back[data-v-010a817f]{background:linear-gradient(160deg,rgba(45,45,45,0.75),rgba(35,35,35,0.85));border-radius:14px;box-shadow:0 10px 28px rgba(0,0,0,.15),0 3px 10px rgba(0,0,0,.12);padding:16px 18px;display:flex;flex-direction:column;gap:10px;border:1px solid hsla(0,0%,100%,.06);max-width:100%;margin:20px 0}.roleplay_options_title[data-v-010a817f]{font-size:.94em;font-weight:600;color:#f0f0f0;padding-right:12px;letter-spacing:.02em;text-align:left;margin-bottom:4px}.roleplay_options_content[data-v-010a817f]{font-size:.94em;line-height:1.55;color:#c6c6c6;font-weight:normal;transition:color .25s ease;text-align:left;flex:1;letter-spacing:.015em;overflow-wrap:anywhere}.roleplay_options_content:not(:empty):not(.short-content)~.roleplay_options_title[data-v-010a817f]{width:100%;margin-bottom:8px;border-bottom:1px solid hsla(0,0%,100%,.08);padding-bottom:6px}.roleplay_options_content.short-content[data-v-010a817f]{flex:1}.roleplay_options_hr[data-v-010a817f]{display:none}.roleplay_options_item[data-v-010a817f]{position:relative;background:rgba(50,50,50,.65);border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,.1);padding:14px 16px;cursor:pointer;border:1px solid hsla(0,0%,100%,.04);transition:all .25s cubic-bezier(0.25,0.8,0.25,1);overflow:hidden;display:flex;flex-wrap:wrap;align-items:flex-start;z-index:1;margin:2px 0;color:#d8d8d8;font-weight:400;line-height:1.5}.roleplay_options_item[data-v-010a817f]::after{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,rgba(90,90,90,0.06) 0%,transparent 70%);opacity:0;transition:opacity .3s ease;z-index:-1}.roleplay_options_item[data-v-010a817f]:before{content:"";position:absolute;top:0;left:0;width:3px;height:100%;background:linear-gradient(to bottom,rgba(160,160,160,0.6),rgba(180,180,180,0.3));transform:scaleY(0);transform-origin:top;transition:transform .3s cubic-bezier(0.4,0,0.2,1)}.roleplay_options_item[data-v-010a817f]:hover{transform:translateY(-2px);box-shadow:0 6px 16px rgba(0,0,0,.15);background:rgba(58,58,58,.75);border-color:rgba(200,200,200,.12)}.roleplay_options_item[data-v-010a817f]:hover::after{opacity:1}.roleplay_options_item:hover .roleplay_options_content[data-v-010a817f]{color:#e2e2e2}.roleplay_options_item[data-v-010a817f]:active{transform:translateY(-1px);box-shadow:0 3px 8px rgba(0,0,0,.12)}.roleplay_options_item[data-v-010a817f]:hover:before{transform:scaleY(1)}@media (max-width:768px){.roleplay_options_back[data-v-010a817f]{padding:14px;gap:8px}.roleplay_options_item[data-v-010a817f]{padding:12px 14px}.roleplay_options_title[data-v-010a817f]{font-size:.9em;padding-right:10px}.roleplay_options_content[data-v-010a817f]{font-size:.9em;line-height:1.5}}@media (prefers-reduced-motion:reduce){.roleplay_options_item[data-v-010a817f]{transition:none}.roleplay_options_item[data-v-010a817f]::before,.roleplay_options_item[data-v-010a817f]::after{transition:none}.roleplay_options_content[data-v-010a817f],.roleplay_options_title[data-v-010a817f]{transition:none}}','',{version:3,sources:['webpack://./示例/前端界面示例/选择框.vue'],names:[],mappings:'AAEE,wCACE,0EAAA,CACA,kBAAA,CACA,iEACE,CAEF,iBAAA,CACA,YAAA,CACA,qBAAA,CACA,QAAA,CACA,oCAAA,CACA,cAAA,CACA,aAAA,CAGF,yCACE,eAAA,CACA,eAAA,CACA,aAAA,CACA,kBAAA,CACA,oBAAA,CACA,eAAA,CACA,iBAAA,CAGF,2CACE,eAAA,CACA,gBAAA,CACA,aAAA,CACA,kBAAA,CACA,0BAAA,CACA,eAAA,CACA,MAAA,CACA,qBAAA,CACA,sBAAA,CAGA,mGACE,UAAA,CACA,iBAAA,CACA,2CAAA,CACA,kBAAA,CAIF,yDACE,MAAA,CAIJ,sCACE,YAAA,CAGF,wCACE,iBAAA,CACA,6BAAA,CACA,kBAAA,CACA,oCAAA,CACA,iBAAA,CACA,cAAA,CACA,oCAAA,CACA,iDAAA,CACA,eAAA,CACA,YAAA,CACA,cAAA,CACA,sBAAA,CACA,SAAA,CACA,YAAA,CACA,aAAA,CACA,eAAA,CACA,eAAA,CAEA,+CACE,UAAA,CACA,iBAAA,CACA,KAAA,CACA,MAAA,CACA,UAAA,CACA,WAAA,CACA,yEAAA,CACA,SAAA,CACA,2BAAA,CACA,UAAA,CAGF,+CACE,UAAA,CACA,iBAAA,CACA,KAAA,CACA,MAAA,CACA,SAAA,CACA,WAAA,CACA,iFAAA,CACA,mBAAA,CACA,oBAAA,CACA,kDAAA,CAGF,8CACE,0BAAA,CACA,qCAAA,CACA,6BAAA,CACA,kCAAA,CAEA,qDACE,SAAA,CAGF,wEACE,aAAA,CAIJ,+CACE,0BAAA,CACA,oCAAA,CAGF,qDACE,mBAAA,CAKN,yBAEI,wCACE,YAAA,CACA,OAAA,CAGF,wCACE,iBAAA,CAGF,yCACE,cAAA,CACA,kBAAA,CAGF,2CACE,cAAA,CACA,eAAA,CAAA,CAKN,uCAEI,wCACE,eAAA,CAEA,+FAEE,eAAA,CAIJ,oFAEE,eAAA,CAAA',sourcesContent:['\n.roleplay_options {\n  &_back {\n    background: linear-gradient(160deg, rgba(45, 45, 45, 0.75), rgba(35, 35, 35, 0.85));\n    border-radius: 14px;\n    box-shadow:\n      0 10px 28px rgba(0, 0, 0, 0.15),\n      0 3px 10px rgba(0, 0, 0, 0.12);\n    padding: 16px 18px;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    border: 1px solid rgba(255, 255, 255, 0.06);\n    max-width: 100%;\n    margin: 20px 0;\n  }\n\n  &_title {\n    font-size: 0.94em;\n    font-weight: 600;\n    color: #f0f0f0;\n    padding-right: 12px;\n    letter-spacing: 0.02em;\n    text-align: left;\n    margin-bottom: 4px;\n  }\n\n  &_content {\n    font-size: 0.94em;\n    line-height: 1.55;\n    color: #c6c6c6;\n    font-weight: normal;\n    transition: color 0.25s ease;\n    text-align: left;\n    flex: 1;\n    letter-spacing: 0.015em;\n    overflow-wrap: anywhere;\n\n    /* Long content will trigger this rule */\n    &:not(:empty):not(.short-content) ~ .roleplay_options_title {\n      width: 100%;\n      margin-bottom: 8px;\n      border-bottom: 1px solid rgba(255, 255, 255, 0.08);\n      padding-bottom: 6px;\n    }\n\n    /* JavaScript helper to add this class for single-line content */\n    &.short-content {\n      flex: 1;\n    }\n  }\n\n  &_hr {\n    display: none;\n  }\n\n  &_item {\n    position: relative;\n    background: rgba(50, 50, 50, 0.65);\n    border-radius: 10px;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n    padding: 14px 16px;\n    cursor: pointer;\n    border: 1px solid rgba(255, 255, 255, 0.04);\n    transition: all 0.25s cubic-bezier(0.25, 0.8, 0.25, 1);\n    overflow: hidden;\n    display: flex;\n    flex-wrap: wrap;\n    align-items: flex-start;\n    z-index: 1;\n    margin: 2px 0;\n    color: #d8d8d8;\n    font-weight: 400;\n    line-height: 1.5;\n\n    &::after {\n      content: \'\';\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: linear-gradient(135deg, rgba(90, 90, 90, 0.06) 0%, transparent 70%);\n      opacity: 0;\n      transition: opacity 0.3s ease;\n      z-index: -1;\n    }\n\n    &:before {\n      content: \'\';\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 3px;\n      height: 100%;\n      background: linear-gradient(to bottom, rgba(160, 160, 160, 0.6), rgba(180, 180, 180, 0.3));\n      transform: scaleY(0);\n      transform-origin: top;\n      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    }\n\n    &:hover {\n      transform: translateY(-2px);\n      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);\n      background: rgba(58, 58, 58, 0.75);\n      border-color: rgba(200, 200, 200, 0.12);\n\n      &::after {\n        opacity: 1;\n      }\n\n      .roleplay_options_content {\n        color: #e2e2e2;\n      }\n    }\n\n    &:active {\n      transform: translateY(-1px);\n      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.12);\n    }\n\n    &:hover:before {\n      transform: scaleY(1);\n    }\n  }\n}\n\n@media (max-width: 768px) {\n  .roleplay_options {\n    &_back {\n      padding: 14px;\n      gap: 8px;\n    }\n\n    &_item {\n      padding: 12px 14px;\n    }\n\n    &_title {\n      font-size: 0.9em;\n      padding-right: 10px;\n    }\n\n    &_content {\n      font-size: 0.9em;\n      line-height: 1.5;\n    }\n  }\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .roleplay_options {\n    &_item {\n      transition: none;\n\n      &::before,\n      &::after {\n        transition: none;\n      }\n    }\n\n    &_content,\n    &_title {\n      transition: none;\n    }\n  }\n}\n'],sourceRoot:''}]);const i=s},424(e,t,n){function r(e,t){for(var n=[],r={},a=0;a<t.length;a++){var o=t[a],s=o[0],i={id:e+':'+a,css:o[1],media:o[2],sourceMap:o[3]};r[s]?r[s].parts.push(i):n.push(r[s]={id:s,parts:[i]})}return n}n.d(t,{A:()=>g});var a='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!a)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var o={},s=a&&(document.head||document.getElementsByTagName('head')[0]),i=null,l=0,A=!1,c=function(){},d=null,p='data-vue-ssr-id',m='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function g(e,t,n,a){A=n,d=a||{};var s=r(e,t);return h(s),function(t){for(var n=[],a=0;a<s.length;a++){var i=s[a];(l=o[i.id]).refs--,n.push(l)}t?h(s=r(e,t)):s=[];for(a=0;a<n.length;a++){var l;if(0===(l=n[a]).refs){for(var A=0;A<l.parts.length;A++)l.parts[A]();delete o[l.id]}}}}function h(e){for(var t=0;t<e.length;t++){var n=e[t],r=o[n.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](n.parts[a]);for(;a<n.parts.length;a++)r.parts.push(C(n.parts[a]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{var s=[];for(a=0;a<n.parts.length;a++)s.push(C(n.parts[a]));o[n.id]={id:n.id,refs:1,parts:s}}}}function u(){var e=document.createElement('style');return e.type='text/css',s.appendChild(e),e}function C(e){var t,n,r=document.querySelector('style['+p+'~="'+e.id+'"]');if(r){if(A)return c;r.parentNode.removeChild(r)}if(m){var a=l++;r=i||(i=u()),t=y.bind(null,r,a,!1),n=y.bind(null,r,a,!0)}else r=u(),t=x.bind(null,r),n=function(){r.parentNode.removeChild(r)};return t(e),function(r){if(r){if(r.css===e.css&&r.media===e.media&&r.sourceMap===e.sourceMap)return;t(e=r)}else n()}}var f,v=(f=[],function(e,t){return f[e]=t,f.filter(Boolean).join('\n')});function y(e,t,n,r){var a=n?'':r.css;if(e.styleSheet)e.styleSheet.cssText=v(t,a);else{var o=document.createTextNode(a),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(o,s[t]):e.appendChild(o)}}function x(e,t){var n=t.css,r=t.media,a=t.sourceMap;if(r&&e.setAttribute('media',r),d.ssrId&&e.setAttribute(p,t.id),a&&(n+='\n/*# sourceURL='+a.sources[0]+' */',n+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+' */'),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},455(e,t){t.A=(e,t)=>{const n=e.__vccOpts||e;for(const[e,r]of t)n[e]=r;return n}},462(e,t,n){var r=n(132);r.__esModule&&(r=r.default),'string'==typeof r&&(r=[[e.id,r,'']]),r.locals&&(e.exports=r.locals);(0,n(424).A)('27209306',r,!1,{ssrId:!0})},492(e){e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if('function'==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),a='sourceMappingURL=data:application/json;charset=utf-8;base64,'.concat(r),o='/*# '.concat(a,' */');return[t].concat([o]).join('\n')}return[t].join('\n')}},668(e,t,n){var r=n(986);r.__esModule&&(r=r.default),'string'==typeof r&&(r=[[e.id,r,'']]),r.locals&&(e.exports=r.locals);(0,n(424).A)('6a1f3875',r,!1,{ssrId:!0})},748(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n='',r=void 0!==t[5];return t[4]&&(n+='@supports ('.concat(t[4],') {')),t[2]&&(n+='@media '.concat(t[2],' {')),r&&(n+='@layer'.concat(t[5].length>0?' '.concat(t[5]):'',' {')),n+=e(t),r&&(n+='}'),t[2]&&(n+='}'),t[4]&&(n+='}'),n}).join('')},t.i=function(e,n,r,a,o){'string'==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var i=0;i<this.length;i++){var l=this[i][0];null!=l&&(s[l]=!0)}for(var A=0;A<e.length;A++){var c=[].concat(e[A]);r&&s[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]='@layer'.concat(c[5].length>0?' '.concat(c[5]):'',' {').concat(c[1],'}')),c[5]=o),n&&(c[2]?(c[1]='@media '.concat(c[2],' {').concat(c[1],'}'),c[2]=n):c[2]=n),a&&(c[4]?(c[1]='@supports ('.concat(c[4],') {').concat(c[1],'}'),c[4]=a):c[4]=''.concat(a)),t.push(c))}},t}},770(e,t,n){var r=n(404);r.__esModule&&(r=r.default),'string'==typeof r&&(r=[[e.id,r,'']]),r.locals&&(e.exports=r.locals);(0,n(424).A)('6f4fd643',r,!1,{ssrId:!0})},986(e,t,n){n.r(t),n.d(t,{default:()=>i});var r=n(492),a=n.n(r),o=n(748),s=n.n(o)()(a());s.push([e.id,'.StreamingMessage__searchBar[data-v-20bf3a75]{margin-bottom:.5rem;padding:.35rem;border-radius:.75rem;background:color-mix(in srgb,var(--SmartThemeQuoteColor) 16%,transparent);border:1px solid color-mix(in srgb,var(--SmartThemeQuoteColor) 55%,transparent);box-shadow:0 0 0 1px color-mix(in srgb,var(--SmartThemeQuoteColor) 22%,transparent),0 8px 20px rgba(0,0,0,.22)}.StreamingMessage__searchBar[data-v-20bf3a75]:focus-within{border-color:color-mix(in srgb,var(--SmartThemeQuoteColor) 85%,transparent);box-shadow:0 0 0 2px color-mix(in srgb,var(--SmartThemeQuoteColor) 55%,transparent),0 10px 26px rgba(0,0,0,.28)}.StreamingMessage__searchInner[data-v-20bf3a75]{display:flex;align-items:center;gap:.5rem}.StreamingMessage__searchPill[data-v-20bf3a75]{padding:.15rem .5rem;border-radius:999px;font-size:.85em;line-height:1.2;letter-spacing:.02em;color:var(--SmartThemeBodyColor);background:color-mix(in srgb,var(--SmartThemeQuoteColor) 38%,transparent);border:1px solid color-mix(in srgb,var(--SmartThemeQuoteColor) 65%,transparent);-webkit-user-select:none;user-select:none}.StreamingMessage__searchInput[data-v-20bf3a75]{flex:1;min-width:0;width:100%;padding:.5rem .65rem;border-radius:.6rem;background:color-mix(in srgb,var(--SmartThemeQuoteColor) 10%,transparent);border:1px solid color-mix(in srgb,var(--SmartThemeQuoteColor) 35%,transparent)}.StreamingMessage__searchInput[data-v-20bf3a75]::placeholder{color:color-mix(in srgb,var(--SmartThemeBodyColor) 65%,transparent)}.StreamingMessage__clearBtn[data-v-20bf3a75]{flex:0 0 auto;padding:.35rem .55rem;border-radius:.55rem;background:color-mix(in srgb,var(--SmartThemeQuoteColor) 22%,transparent);border:1px solid color-mix(in srgb,var(--SmartThemeQuoteColor) 55%,transparent);color:var(--SmartThemeBodyColor);cursor:pointer}.StreamingMessage__clearBtn[data-v-20bf3a75]:hover{background:color-mix(in srgb,var(--SmartThemeQuoteColor) 32%,transparent)}.StreamingMessage__clearBtn[data-v-20bf3a75]:active{transform:translateY(1px)}','',{version:3,sources:['webpack://./示例/流式楼层界面示例/搜索框.vue'],names:[],mappings:'AACA,8CACE,mBAAA,CACA,cAAA,CACA,oBAAA,CACA,yEAAA,CACA,+EAAA,CACA,8GACE,CAIJ,2DACE,2EAAA,CACA,+GACE,CAIJ,gDACE,YAAA,CACA,kBAAA,CACA,SAAA,CAGF,+CACE,oBAAA,CACA,mBAAA,CACA,eAAA,CACA,eAAA,CACA,oBAAA,CACA,gCAAA,CACA,yEAAA,CACA,+EAAA,CACA,wBAAA,CAAA,gBAAA,CAGF,gDACE,MAAA,CACA,WAAA,CACA,UAAA,CACA,oBAAA,CACA,mBAAA,CACA,yEAAA,CACA,+EAAA,CAGF,6DACE,mEAAA,CAGF,6CACE,aAAA,CACA,qBAAA,CACA,oBAAA,CACA,yEAAA,CACA,+EAAA,CACA,gCAAA,CACA,cAAA,CAGF,mDACE,yEAAA,CAGF,oDACE,yBAAA',sourcesContent:['\n.StreamingMessage__searchBar {\n  margin-bottom: 0.5rem;\n  padding: 0.35rem;\n  border-radius: 0.75rem;\n  background: color-mix(in srgb, var(--SmartThemeQuoteColor) 16%, transparent);\n  border: 1px solid color-mix(in srgb, var(--SmartThemeQuoteColor) 55%, transparent);\n  box-shadow:\n    0 0 0 1px color-mix(in srgb, var(--SmartThemeQuoteColor) 22%, transparent),\n    0 8px 20px rgba(0, 0, 0, 0.22);\n}\n\n.StreamingMessage__searchBar:focus-within {\n  border-color: color-mix(in srgb, var(--SmartThemeQuoteColor) 85%, transparent);\n  box-shadow:\n    0 0 0 2px color-mix(in srgb, var(--SmartThemeQuoteColor) 55%, transparent),\n    0 10px 26px rgba(0, 0, 0, 0.28);\n}\n\n.StreamingMessage__searchInner {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.StreamingMessage__searchPill {\n  padding: 0.15rem 0.5rem;\n  border-radius: 999px;\n  font-size: 0.85em;\n  line-height: 1.2;\n  letter-spacing: 0.02em;\n  color: var(--SmartThemeBodyColor);\n  background: color-mix(in srgb, var(--SmartThemeQuoteColor) 38%, transparent);\n  border: 1px solid color-mix(in srgb, var(--SmartThemeQuoteColor) 65%, transparent);\n  user-select: none;\n}\n\n.StreamingMessage__searchInput {\n  flex: 1;\n  min-width: 0;\n  width: 100%;\n  padding: 0.5rem 0.65rem;\n  border-radius: 0.6rem;\n  background: color-mix(in srgb, var(--SmartThemeQuoteColor) 10%, transparent);\n  border: 1px solid color-mix(in srgb, var(--SmartThemeQuoteColor) 35%, transparent);\n}\n\n.StreamingMessage__searchInput::placeholder {\n  color: color-mix(in srgb, var(--SmartThemeBodyColor) 65%, transparent);\n}\n\n.StreamingMessage__clearBtn {\n  flex: 0 0 auto;\n  padding: 0.35rem 0.55rem;\n  border-radius: 0.55rem;\n  background: color-mix(in srgb, var(--SmartThemeQuoteColor) 22%, transparent);\n  border: 1px solid color-mix(in srgb, var(--SmartThemeQuoteColor) 55%, transparent);\n  color: var(--SmartThemeBodyColor);\n  cursor: pointer;\n}\n\n.StreamingMessage__clearBtn:hover {\n  background: color-mix(in srgb, var(--SmartThemeQuoteColor) 32%, transparent);\n}\n\n.StreamingMessage__clearBtn:active {\n  transform: translateY(1px);\n}\n'],sourceRoot:''}]);const i=s}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={id:e,exports:{}};return t[e](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};function a(e='head'){const t=$('<div>').attr('script_id',getScriptId()).append($('head > style',document).clone()).appendTo(e);return{destroy:()=>t.remove()}}function o(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(e){const t=16*Math.random()|0;return('x'===e?t:3&t|8).toString(16)})}const s=Vue;function i(e,t={}){const{host:n='iframe',filter:r,prefix:i=o()}=t,l=new Map;let A=!1;const c=e=>{const t=Number($('#chat > .mes').first().attr('mesid')),n=getLastMessageId();return!_.inRange(e,t,n+1)&&(l.get(e)?.destroy(),!0)},d=()=>{l.keys().forEach(e=>c(e))},p=async(t,o)=>{if(A)return;if(c(t))return;const d=o??getChatMessages(t)[0].message??'';if(r&&!r(t,d))return void l.get(t)?.destroy();const p=$(`.mes[mesid='${t}']`),m=p.find('.mes_text').addClass('hidden!');p.find('.TH-streaming').addClass('hidden!');let g=p.find(`#${i}-${t}`);if(g.length>0){const e=l.get(t);if(e)return e.data.message=d,void(e.data.during_streaming=Boolean(o))}l.get(t)?.destroy(),g.remove();let h=p.find('.mes_streaming');0===h.length&&(h=$('<div class="mes_streaming">').css({'font-weight':'500','line-height':'calc(var(--mainFontSize) + .5rem)','max-width':'100%','overflow-wrap':'anywhere',padding:'calc(var(--mainFontSize) * 0.8) 0 0 0'}).insertAfter(m)),g=('iframe'===n?$('<iframe>').attr({script_id:getScriptId(),frameborder:0,srcdoc:'<head> <link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"> <script src="https://testingcf.jsdelivr.net/gh/n0vi028/JS-Slash-Runner/lib/tailwindcss.min.js"><\/script> <script src="https://testingcf.jsdelivr.net/npm/jquery"><\/script> <script src="https://testingcf.jsdelivr.net/npm/jquery-ui/dist/jquery-ui.min.js"><\/script> <link rel="stylesheet" href="https://testingcf.jsdelivr.net/npm/jquery-ui/themes/base/theme.min.css"/> <script src="https://testingcf.jsdelivr.net/npm/jquery-ui-touch-punch"><\/script> <script src="https://testingcf.jsdelivr.net/npm/lodash"><\/script> <script src="https://testingcf.jsdelivr.net/gh/n0vi028/JS-Slash-Runner/src/iframe/adjust_iframe_height.js"><\/script> <style>*,::after,::before{box-sizing:border-box}body,html{margin:0!important;padding:0;overflow:hidden!important;max-width:100%!important}</style> </head> '}).addClass('w-full'):$('<div>').attr('script_id',getScriptId())).attr('id',`${i}-${t}`).appendTo(h);const u=(0,s.reactive)({prefix:i,host_id:`${i}-${t}`,message_id:t,message:d,during_streaming:Boolean(o)}),C=e().provide('streaming_message_context',u);'iframe'===n?g.on('load',function(){a(this.contentDocument.head),C.mount(this.contentDocument.body)}):C.mount(g[0]);const f=new MutationObserver(()=>{const e=$('#chat').find('#curEditTextarea');e.parent().is(m)?(m.removeClass('hidden!'),g.addClass('hidden!')):0===e.length&&(m.addClass('hidden!'),g.removeClass('hidden!'))});f.observe(m[0],{childList:!0}),l.set(t,{app:C,data:u,destroy:()=>{const e=p.find('.TH-streaming');e.length>0?e.removeClass('hidden!'):m.removeClass('hidden!'),C.unmount(),g.remove(),0===h.children().length&&h.remove(),f.disconnect(),l.delete(t)}})},m=async()=>{A||(d(),await Promise.all(_.range(Number($('#chat > .mes').first().attr('mesid')),getLastMessageId()+1).map(async e=>await p(e))))},g=[],h=(e,t)=>{g.push(eventOn(e,errorCatched(t)).stop)};return h('chatLoaded',()=>m()),h(tavern_events.CHARACTER_MESSAGE_RENDERED,e=>{d(),p(e)}),[tavern_events.MESSAGE_EDITED,tavern_events.MESSAGE_DELETED].forEach(e=>h(e,e=>{d(),l.get(e)?.destroy(),p(e)})),h(tavern_events.MESSAGE_DELETED,()=>setTimeout(errorCatched(m),1e3)),h(tavern_events.STREAM_TOKEN_RECEIVED,e=>{p(Number($('#chat').children('.mes.last_mes').attr('mesid')),e)}),'div'===n&&g.push(a().destroy),m(),{unmount:()=>{const e=$('#chat').find('.TH-streaming');e.length>0?e.removeClass('hidden!'):$('chat').find('.mes_text').removeClass('hidden!'),l.forEach(({destroy:e})=>e()),g.forEach(e=>e()),A=!0}}}const l={class:'roleplay_options'},A={class:'roleplay_options_back'},c=['onClick'],d={class:'roleplay_options_title'},p={class:'roleplay_options_content'},m=(0,s.defineComponent)({__name:'选择框',props:{message:{}},setup(e){const t=e,n=(0,s.ref)([...(t.message.match(/<roleplay_options>(.*?)<\/roleplay_options>/s)?.[1]??'').matchAll(/(.+?)[:：]\s*(.+)/gm)].map(e=>({title:e[1],content:e[2].replace(/^\$\{(.+)\}$/,'$1').replace(/^「(.+)」$/,'$1')})));return(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',l,[(0,s.createElementVNode)('div',A,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(n),e=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:e.title,class:'roleplay_options_item',tabindex:'1',onClick:t=>async function(e){await createChatMessages([{role:'user',message:e.content}]),triggerSlash('/trigger')}(e)},[(0,s.createElementVNode)('span',d,[(0,s.createElementVNode)('strong',null,(0,s.toDisplayString)(e.title),1)]),t[0]||(t[0]=(0,s.createElementVNode)('hr',{class:'roleplay_options_hr'},null,-1)),(0,s.createElementVNode)('span',p,(0,s.toDisplayString)(e.content),1)],8,c))),128))])]))}});r(770);var g=r(455);const h=(0,g.A)(m,[['__scopeId','data-v-010a817f']]);const u=e=>e.replace(/[-\\^$*+?.()|[\]{}]/g,'\\$&'),C=e=>{let t;if(e.query instanceof RegExp)return new RegExp(String.raw`(${e.query.source})`,'g'+(e.caseSensitive?'':'i'));const n=(e=>{if('partial'===e)return e=>u(e);const t=String.raw`[.,\s/(\[{<:;'"!?|（『「。、／\u3000]`,n=String.raw`[.,\s/)\]}>:;'"!?|）』」。、／\u3000]`;return e=>String.raw`(?<=^|${t})${u(e)}(?=$|${n})`})(e.matchMode);if(e.splitBySpace){const r=e.query.trim().replace(/\s+/g,' ');t=String.raw`(${r.split(/\s/).map(n).join('|')})`}else t=String.raw`(${n(e.query)})`;return new RegExp(String.raw`${t}`,'g'+(e.caseSensitive?'':'i'))},f=(t,n,r=!1)=>{if(!n.query||n.query instanceof String&&!n.query.trim())return t;let a=t,o=n.query,i=!1;n.diacriticsSensitive||(a=e.remove(a),o=n.query instanceof RegExp?new RegExp(e.remove(n.query.source)):e.remove(n.query),i=a!==t);const l=C({query:o,splitBySpace:n.splitBySpace,caseSensitive:n.caseSensitive,matchMode:n.matchMode}),A=a.split(l),c=i?((e,t)=>{const n=[];return t.forEach(t=>{const r=n.join('').length,a=r+t.length;n.push(e.slice(r,a))}),n})(t,A):A;return r?A.map((e,t)=>{if(l.test(e)){const e=n.highlightClass?` class="${n.highlightClass}"`:'',r=n.highlightStyle?` style="${n.highlightStyle}"`:'';return`<${n.highlightTag}${e}${r}>${c[t]}</${n.highlightTag}>`}return c[t]}).join(''):A.map((e,t)=>l.test(e)?(0,s.h)(n.highlightTag,{class:n.highlightClass,style:n.highlightStyle},c[t]):c[t])},v=e=>'string'==typeof e?[]:e.filter(e=>'string'!=typeof e).map(e=>'string'==typeof e?e:e.children);var y=(0,s.defineComponent)({name:'VueWordHighlighter',props:{query:{type:[String,RegExp],required:!0,default:''},caseSensitive:{type:Boolean,default:!1},diacriticsSensitive:{type:Boolean,default:!1},splitBySpace:{type:Boolean,default:!1},matchMode:{type:String,default:'partial'},highlightClass:{type:[Object,String,Array],default:''},highlightStyle:{type:[Object,String,Array],default:''},highlightTag:{type:String,default:'mark'},wrapperTag:{type:String,default:'span'},wrapperClass:{type:[Object,String,Array],default:''},textToHighlight:{type:String,default:''},htmlToHighlight:{type:String,default:''}},emits:['matches'],setup:(e,t)=>()=>{if(e.htmlToHighlight){0;const t='(<(?:"[^"]*"[\'"]*|\'[^\']*\'[\'"]*|[^\'">])+>)',n=e.htmlToHighlight.split(new RegExp(t,'gs')),r=n.map((r,a)=>new RegExp(t).test(r)||a>0&&n[a-1].startsWith('<script')?r:f(r,{query:e.query,splitBySpace:e.splitBySpace,caseSensitive:e.caseSensitive,diacriticsSensitive:e.diacriticsSensitive,matchMode:e.matchMode,highlightTag:e.highlightTag,highlightClass:e.highlightClass,highlightStyle:e.highlightStyle},!0)).join('');return(0,s.h)(e.wrapperTag,{class:e.wrapperClass,innerHTML:r})}if(e.textToHighlight){const n=f(e.textToHighlight,{query:e.query,splitBySpace:e.splitBySpace,caseSensitive:e.caseSensitive,diacriticsSensitive:e.diacriticsSensitive,matchMode:e.matchMode,highlightTag:e.highlightTag,highlightClass:e.highlightClass,highlightStyle:e.highlightStyle});return t.emit('matches',v(n)),(0,s.h)(e.wrapperTag,{class:e.wrapperClass},n)}if(t.slots&&t.slots.default){const n=r=>{if(r.type===s.Comment)return r;if('string'==typeof r.children){const n=f(r.children,{query:e.query,splitBySpace:e.splitBySpace,caseSensitive:e.caseSensitive,diacriticsSensitive:e.diacriticsSensitive,matchMode:e.matchMode,highlightTag:e.highlightTag,highlightClass:e.highlightClass,highlightStyle:e.highlightStyle}),a=v(n);return t.emit('matches',a),0===a.length?r:'string'==typeof r.type?(0,s.h)(r.type,{...r.props},[(0,s.h)(e.wrapperTag,{class:e.wrapperClass},n)]):(0,s.h)(e.wrapperTag,{class:e.wrapperClass},n)}return(0,s.h)(r.type,{...r.props},Array.isArray(r.children)?r.children.map(e=>n(e)):[])},r=t.slots.default();return Array.isArray(r)?r.map(e=>n(e)):r}}});const x=(0,s.defineComponent)({__name:'高亮',props:{query:{},html:{}},setup:e=>(t,n)=>((0,s.openBlock)(),(0,s.createBlock)((0,s.unref)(y),{query:e.query,'highlight-class':'StreamingMessage--mark','html-to-highlight':e.html},{default:(0,s.withCtx)(()=>[(0,s.renderSlot)(t.$slots,'default')]),_:3},8,['query','html-to-highlight']))});r(462);const b=x,S={class:'StreamingMessage__segments'},E=['onClick'],B={key:0,class:'StreamingMessage__segmentHint'},w=(0,s.defineComponent)({__name:'分段',props:{query:{},html:{}},setup(e){const t=e,n=(0,s.ref)(new Set),r=e=>n.value.has(e),a=(0,s.computed)(()=>(e=>{const t=[],n=e.split(/\r?\n/);for(let e=0;e<n.length;e++){const r=n[e]?.trim();r&&t.push({key:e,html:r})}return t})(t.html));return(t,o)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',S,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)((0,s.unref)(a),t=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{key:t.key,class:(0,s.normalizeClass)(['StreamingMessage__segment',{'is-hidden':!r(t.key)}]),onClick:(0,s.withModifiers)(e=>{return r=t.key,void(n.value.has(r)||n.value.add(r));var r},['stop'])},[(0,s.createElementVNode)('div',{class:(0,s.normalizeClass)(['StreamingMessage__segmentContent',{'is-blurred':!r(t.key)}])},[(0,s.createVNode)(b,{query:e.query,html:t.html},null,8,['query','html'])],2),r(t.key)?(0,s.createCommentVNode)('v-if',!0):((0,s.openBlock)(),(0,s.createElementBlock)('div',B,'点击显示'))],10,E))),128))]))}});r(41);const k=(0,g.A)(w,[['__scopeId','data-v-48ddcd76']]),M={class:'StreamingMessage__searchInner'},T=(0,s.defineComponent)({__name:'搜索框',props:{modelValue:{required:!0},modelModifiers:{}},emits:['update:modelValue'],setup(e){const t=(0,s.useModel)(e,'modelValue'),n=()=>{t.value=''};return(e,r)=>((0,s.openBlock)(),(0,s.createElementBlock)('div',{class:'StreamingMessage__searchBar',onClick:r[2]||(r[2]=(0,s.withModifiers)(()=>{},['stop']))},[(0,s.createElementVNode)('div',M,[r[3]||(r[3]=(0,s.createElementVNode)('div',{class:'StreamingMessage__searchPill','aria-hidden':'true'},'高亮',-1)),(0,s.withDirectives)((0,s.createElementVNode)('input',{'onUpdate:modelValue':r[0]||(r[0]=e=>t.value=e),type:'text',class:'text_pole StreamingMessage__searchInput',placeholder:'输入关键词以高亮本楼层内容',onClick:r[1]||(r[1]=(0,s.withModifiers)(()=>{},['stop'])),onKeydown:(0,s.withKeys)(n,['esc'])},null,544),[[s.vModelText,t.value]]),t.value?((0,s.openBlock)(),(0,s.createElementBlock)('button',{key:0,type:'button',class:'StreamingMessage__clearBtn',onClick:(0,s.withModifiers)(n,['stop'])},'清除')):(0,s.createCommentVNode)('v-if',!0)])]))}});r(668);const q=(0,g.A)(T,[['__scopeId','data-v-20bf3a75']]),j=(0,s.defineComponent)({__name:'App',setup(e){const t=(0,s.readonly)((0,s.inject)('streaming_message_context')),n=(0,s.ref)(''),r=(0,s.computed)(()=>t.message.lastIndexOf('<roleplay_options>')),a=(0,s.computed)(()=>formatAsDisplayedMessage(t.message.slice(0,-1===r.value?void 0:r.value).trim(),{message_id:t.message_id})),o=(0,s.computed)(()=>t.message.lastIndexOf('</roleplay_options>')),i=(0,s.computed)(()=>-1===o.value?null:formatAsDisplayedMessage(t.message.slice(o.value+19).trim(),{message_id:t.message_id})),l=(0,s.computed)(()=>-1!==r.value&&-1===o.value?formatAsDisplayedMessage(t.message.slice(r.value).trim(),{message_id:t.message_id}):null);return(0,s.watch)(()=>t.during_streaming,()=>{t.during_streaming||toastr.success(`第 ${t.message_id} 楼流式传输已完成`)}),(0,s.onMounted)(()=>{toastr.success(`成功挂载第 ${t.message_id} 条消息的流式楼层界面`)}),(e,o)=>((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,[(0,s.createVNode)(q,{modelValue:(0,s.unref)(n),'onUpdate:modelValue':o[0]||(o[0]=e=>(0,s.isRef)(n)?n.value=e:null)},null,8,['modelValue']),(0,s.unref)(a)?((0,s.openBlock)(),(0,s.createBlock)(k,{key:0,query:(0,s.unref)(n),html:(0,s.unref)(a)},null,8,['query','html'])):(0,s.createCommentVNode)('v-if',!0),-1!==(0,s.unref)(r)?((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,{key:1},[(0,s.unref)(l)?((0,s.openBlock)(),(0,s.createBlock)(k,{key:0,query:(0,s.unref)(n),html:(0,s.unref)(l)},null,8,['query','html'])):((0,s.openBlock)(),(0,s.createBlock)(b,{key:1,query:(0,s.unref)(n)},{default:(0,s.withCtx)(()=>[(0,s.createVNode)(h,{message:(0,s.unref)(t).message},null,8,['message'])]),_:1},8,['query']))],64)):(0,s.createCommentVNode)('v-if',!0),(0,s.unref)(i)?((0,s.openBlock)(),(0,s.createBlock)(k,{key:2,query:(0,s.unref)(n),html:(0,s.unref)(i)},null,8,['query','html'])):(0,s.createCommentVNode)('v-if',!0)],64))}});$(()=>{const{unmount:e}=i(()=>(0,s.createApp)(j),{host:'div'});$(window).on('pagehide',()=>e())});
//# sourceMappingURL=index.js.map